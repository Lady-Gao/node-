(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-26118db6"],{8369:function(e,t,a){"use strict";var i=a("cebc");t.a={data:function(){return{table:{size:10,total:0,current:1,flag:!1,loading:!1,data:[]}}},methods:{tableLoading:function(e,t,a,r){var l=this;a?(this.table.flag=!0,this.table.current=1):this.table.flag=!1,this.table.loading=!0;var o=Object(i.a)({current:this.table.current,size:this.table.size},t);this.$http(r?{url:e,data:o}:{url:e,params:o}).then(function(e){var t=e.data;e.flag&&0!=t.length?(l.table.data=t.records,l.table.total=t.total,l.table.current=t.current):(l.table.data=[],l.table.total=0),l.table.loading=!1}).catch(function(e){l.table.loading=!1})},tableFilterColor:function(e){return this.$filter.plateCodeColor(e.plateColor)},tableFilterIcType:function(e){return this.$filter.icType(e.state)},tableFilterIcResult:function(e){return this.$filter.icResult(e.readerresult)},tableFilterTiredAlarm:function(e){return this.$filter.tiredAlarmType(e.alarm)},tableFilterTiredAdas:function(e){return this.$filter.tiredAdasType(e.alarm)},tableFilterOrderTypeS:function(e){return this.$filter.orderTypeS(e.sendFlag)},tableFilterFormat:function(e){return this.$filter.format(e.orderTime||e.gpsTime)},tableFilterFormats:function(e){return this.$filter.format(e.backTime)},tableBusLineType:function(e){return this.$filter.lineType(e.lineType)},tableFilterAcc:function(e){return this.$filter.accStatus(e.accStatus)},tableSplitMobile:function(e){return e.mobileCode?e.mobileCode.slice(1,e.mobileCode.length):""},tableConfirm:function(e){return this.$filter.isConfirm(e.isnotarize)},tableUpkeep:function(e){return this.$filter.isConfirm(e.type)},tableRenewal:function(e){return this.$filter.renewal(e.state)},tableReMot:function(e){return this.$filter.reMot(e.state)},tableOil:function(e){return this.$filter.fixNumber(e.total,2)},tableSex:function(e){return this.$filter.sex(e.sex)},plateCodeF:function(e){return e.plateCode?e.plateCode:"--"},plateCodeAndColor:function(e){return e.plateCode+"("+this.$filter.plateCodeColor(e.plateColor)+")"},driverStuas:function(e){return this.$filter.alarmStatus(e.fatigueDrive)},overStuas:function(e){return this.$filter.alarmStatus(e.tOversSpeed)},overHStuas:function(e){return this.$filter.alarmStatus(e.tOverSpeedH)},filterAlStuas:function(e){return this.$filter.alarmStatus(e.overSpeed)},filteralarmStuas:function(e){return this.$filter.alarmStatus(e.overSpeedH)},filterLStuas:function(e){return this.$filter.alarmStatus(e.forbid)},applyFlag:function(e){return this.$filter.applyFlag(e.applyFlag)},SEtime:function(e){return this.$filter.SEtime(e.StartTime,e.EndTime)},channelType:function(e){return this.$filter.channelType(e.Channel)},FileSize:function(e){return this.$filter.FileSize(e.fileSize||e.FileSize||0)},AlarmFilter:function(e){return this.$filter.AlarmFilter(e.Alarm)},MediaTypeFilter:function(e){return this.$filter.MediaTypeFilter(e.MediaType)},StreamTypeFilter:function(e){return this.$filter.StreamTypeFilter(e.StreamType)},StorageTypeFilter:function(e){return this.$filter.StorageTypeFilter(e.StorageType)},statusType:function(e){return this.$filter.statusType(e.Status)},fileSource:function(e){return this.$filter.fileSource(e.fileSource)}}}},af2c:function(e,t,a){"use strict";a.r(t),a("7f7f"),a("96cf");var i=a("3b8d"),r=a("cebc"),l=a("8369"),o=a("b0ad"),s=(a("ac6a"),{props:{options:{type:[Object],default:function(){return{}}}},inject:["store"],data:function(){return{loading:!1,label:"",common:{enterpriseId:"",fleetId:"",plateList:[],editTimes:null},addForm:{enterpriseName:"",fleetName:"",amount:"",total:"",driverName:"",stationName:"",addOilTime:"",address:"",plateCode:"",vehicleId:""},rules:{plateCode:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur"}],amount:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{pattern:/^[0-9]*$/,message:this.$t("filter.type2")}],driverName:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{pattern:/^[a-zA-Z\u4e00-\u9fa5 ]{1,20}$/,message:this.$t("filter.type5")}],total:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{pattern:/^[0-9]*$/,message:this.$t("filter.type2")}],addOilTime:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"}],address:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"}],stationName:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"}]},pickerOption:{disabledDate:function(e){return e.getTime()>Date.now()}}}},created:function(){var e=this;this.$service.mapParams(this.addForm,this.options),this.options.edit&&(this.addForm.plateCode=this.options.vehicleId,this.$store.dispatch("findVehicleByPlateCode",{plateCode:this.options.plateCode}).then(function(t){e.common.enterpriseId=t.data&&t.data.enterpriseId,e.common.fleetId=t.data&&t.data.fleetId,e.addForm.enterpriseName=t.data&&t.data.enterpriseName,e.addForm.fleetName=t.data&&t.data.fleetName}),this.common.editTimes=0)},methods:{cancelDialog:function(){this.$emit("update:visible",!1)},confirm:function(){var e=this,t="";this.$refs.accident.validate(function(a){if(!a)return!1;e.loading=!0;var i=e.addForm;e.options.edit?(t="saveOilLog",i.id=e.options.id,i.vehicleId=e.options.vehicleId,i.plateCode=e.options.plateCode):(t="saveOilLog",i.enterpriseId=e.common.enterpriseId,i.vehicleId=e.addForm.vehicleId),e.$store.dispatch(t,i).then(function(t){t.flag?(e.$emit("update:visible",!1),e.$emit("update:refresh",!0),e.$message.success({message:e.options.edit?"修改成功":"新增成功"}),e.loading=!1):e.$message.error({message:e.$t("error."+data.errorCode)})})})}},watch:{"common.enterpriseId":function(e){0==this.common.editTimes?this.common.editTimes++:(this.addForm.fleetName="",this.addForm.vehicleId="")},"common.fleetId":function(e){var t=this;this.common.plateList=[],this.addForm.vehicleId="",this.$http({url:"/vehicle/queryVehicleByFleetId",params:{fleetIds:e}}).then(function(e){e.flag&&e.data&&e.data.forEach(function(e){t.common.plateList.push({label:e.plateCode,value:e.id})})})},"addForm.plateCode":function(e){var t=this;e&&this.common.plateList.forEach(function(a){a.value==e&&(t.addForm.plateCode=a.label,t.addForm.vehicleId=a.value)})}}}),n=(a("e6dd"),a("2877")),d=Object(n.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"accident",staticClass:"refueAdd",attrs:{model:e.addForm,rules:e.rules}},[e.options.edit?e._e():a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-position":"top",label:"所属公司/机构"}},[a("cv-dropdown-tree",{staticClass:"itemW",attrs:{data:e.store.company_tree,"is-default":!1,label:e.label},on:{"update:label":function(t){e.label=t}},model:{value:e.common.enterpriseId,callback:function(t){e.$set(e.common,"enterpriseId",t)},expression:"common.enterpriseId"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车组选择"}},[a("cv-dropdown-tree",{staticClass:"itemW",attrs:{url:"/enterprise/findFleetTreeList","is-initial":!1,"auto-params":{enterpriseId:e.label.enterpriseId,pId:e.label.id,type:e.label.type}},model:{value:e.common.fleetId,callback:function(t){e.$set(e.common,"fleetId",t)},expression:"common.fleetId"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"80",label:"车牌号码",prop:"plateCode"}},[a("el-select",{staticClass:"itemW",attrs:{disabled:e.options.edit,filterable:"",clearable:"",placeholder:"请选择车辆"},model:{value:e.addForm.plateCode,callback:function(t){e.$set(e.addForm,"plateCode","string"==typeof t?t.trim():t)},expression:"addForm.plateCode"}},e._l(e.common.plateList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"司机名称",prop:"driverName"}},[a("el-input",{staticClass:"itemW",attrs:{clearable:""},model:{value:e.addForm.driverName,callback:function(t){e.$set(e.addForm,"driverName","string"==typeof t?t.trim():t)},expression:"addForm.driverName"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"80",label:"加油金额(元)",prop:"amount"}},[a("el-input",{staticClass:"itemW",attrs:{clearable:""},model:{value:e.addForm.amount,callback:function(t){e.$set(e.addForm,"amount","string"==typeof t?t.trim():t)},expression:"addForm.amount"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"加油时间",prop:"addOilTime"}},[a("el-date-picker",{staticClass:"itemW",attrs:{type:"datetime",editable:!1,clearable:!1,"picker-options":e.pickerOption,"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.addForm.addOilTime,callback:function(t){e.$set(e.addForm,"addOilTime",t)},expression:"addForm.addOilTime"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"加油量",prop:"total","label-width":"80"}},[a("el-input",{staticClass:"itemW",attrs:{clearable:""},model:{value:e.addForm.total,callback:function(t){e.$set(e.addForm,"total","string"==typeof t?t.trim():t)},expression:"addForm.total"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"80",label:"加油地点",prop:"address"}},[a("el-input",{staticClass:"itemW",attrs:{clearable:""},model:{value:e.addForm.address,callback:function(t){e.$set(e.addForm,"address","string"==typeof t?t.trim():t)},expression:"addForm.address"}})],1)],1)],1),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":"80",label:"加油站名称",prop:"stationName"}},[a("el-input",{staticClass:"itemW",attrs:{clearable:""},model:{value:e.addForm.stationName,callback:function(t){e.$set(e.addForm,"stationName","string"==typeof t?t.trim():t)},expression:"addForm.stationName"}})],1)],1),a("el-col",{attrs:{span:12}})],1),a("el-form-item",{staticStyle:{"text-align":"right",width:"100%"}},[a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.confirm}},[e._v("确定")]),a("el-button",{on:{click:e.cancelDialog}},[e._v("取消")])],1)],1)},[],!1,null,null,null).exports,c={data:function(){return{searchParams:{plateCode:"",stationName:"",address:"",driverName:"",addOilTime:""},common:{plateList:[]},pickerOption:{disabledDate:function(e){return e.getTime()>Date.now()}}}},methods:{cancelDialog:function(){this.$emit("update:visible",!1)},confirm:function(){var e=this.searchParams;e.startDate=this.searchParams.addOilTime[0]||"",e.endDate=this.searchParams.addOilTime[1]||"",delete e.addOilTime,this.$emit("update:searchTable",e),this.$emit("update:visible",!1)}}},m=Object(n.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{attrs:{"label-width":"110px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"车牌号码"}},[a("el-input",{staticStyle:{width:"220px"},model:{value:e.searchParams.plateCode,callback:function(t){e.$set(e.searchParams,"plateCode","string"==typeof t?t.trim():t)},expression:"searchParams.plateCode"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"加油时间"}},[a("el-date-picker",{staticStyle:{width:"245px"},attrs:{clearable:!1,editable:!1,type:"daterange",placeholder:"选择时间范围","picker-options":e.pickerOption,"default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.searchParams.addOilTime,callback:function(t){e.$set(e.searchParams,"addOilTime",t)},expression:"searchParams.addOilTime"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"加油地点"}},[a("el-input",{staticStyle:{width:"220px"},model:{value:e.searchParams.address,callback:function(t){e.$set(e.searchParams,"address","string"==typeof t?t.trim():t)},expression:"searchParams.address"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"司机"}},[a("el-input",{model:{value:e.searchParams.driverName,callback:function(t){e.$set(e.searchParams,"driverName","string"==typeof t?t.trim():t)},expression:"searchParams.driverName"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"加油站"}},[a("el-input",{staticStyle:{width:"220px"},model:{value:e.searchParams.stationName,callback:function(t){e.$set(e.searchParams,"stationName","string"==typeof t?t.trim():t)},expression:"searchParams.stationName"}})],1)],1),a("el-col",{attrs:{span:12}})],1),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")]),a("el-button",{on:{click:e.cancelDialog}},[e._v("取消")])],1)],1)},[],!1,null,null,null).exports,u=a("2f62"),p={components:{add:d,search:m},mixins:[l.a,o.a],data:function(){return{dialog:{flag:!1,options:{}},refresh:!1,searchOils:{},searchOil:{plateCode:"",stationName:"",address:"",driverName:"",addOilTime:"",startDate:"",endDate:""},outPutParams:{},store:{company_tree:[]}}},computed:{_table:function(){return this.$refs.accidentTable}},provide:function(){return{store:this.store}},methods:Object(r.a)({},Object(u.b)(["queryCompanyInfoList"]),{add:function(){this.dialog.title="添加",this.dialog.name="add",this.dialog.size="dialog-middle",this.dialog.flag=!0,this.dialog.options={}},search:function(){this.dialog.title="搜索",this.dialog.name="search",this.dialog.size="dialog-middle",this.dialog.flag=!0},load:function(e){var t=0<arguments.length&&void 0!==e&&e;this.tableLoading("/oilLogController/findOilLogList",this.searchOil,t)},edit:function(e){this.dialog.title="修改",this.dialog.name="add",this.dialog.size="dialog-middle",this.dialog.options=e,this.dialog.options.edit=!0,this.dialog.flag=!0},del:function(e){var t=this;this.confirmPrompt().then(function(){Object(i.a)(regeneratorRuntime.mark(function a(){var i,r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$store.dispatch("singleDelete",{id:e.id});case 2:i=a.sent,i.data,r=i.flag,i.errorCode,r?(t.$message.success({message:"删除成功"}),t._table.tableInitial()):t.$message.error({message:"删除失败"});case 7:case"end":return a.stop()}},a)}))()})},outPut:function(){var e=this.$service.winParams(this.$COMMON.baseUrl+"/oilLogController/exportOilLogList",this.searchOil);window.location.href=e},plateCodeAndColor:function(e){return e.plateCode+"("+this.$filter.plateCodeColor(e.plateColor)+")"}}),watch:{"dialog.flag":function(e){e||(this.dialog.name="")},refresh:function(e){e&&(this._table.tableInitial(),this.refresh=!1)},searchOils:function(e){this.$service.mapParams(this.searchOil,this.searchOils),this._table.tableInitial()}},mounted:function(){var e=this;this.queryCompanyInfoList().then(function(t){var a=t.data,i=t.flag;e.store.company_tree=i?a:[]})}},f=Object(n.a)(p,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"accidentManage"},[a("cv-operation",[a("el-form-item",[a("cv-tool",{staticClass:"cv-tool",attrs:{name:e.$route.name,data:e.$store.getters.manageMenus,"is-remove":!1,"is-modify":!1},on:{export:e.outPut,add:e.add,search:e.search}})],1)],1),a("cv-content",[a("cv-grid",{ref:"accidentTable",attrs:{params:e.searchOil,url:"/oilLogController/findOilLogList"}},[a("el-table-column",{attrs:{label:e.$t("common.vehicle.plateCode"),prop:"plateCode",formatter:e.plateCodeAndColor}}),a("el-table-column",{attrs:{label:e.$t("加油量(L)"),prop:"total"}}),a("el-table-column",{attrs:{label:e.$t("加油金额"),prop:"amount"}}),a("el-table-column",{attrs:{label:e.$t("司机"),prop:"driverName"}}),a("el-table-column",{attrs:{label:e.$t("加油站"),prop:"stationName"}}),a("el-table-column",{attrs:{label:e.$t("加油时间"),prop:"addOilTime"}}),a("el-table-column",{attrs:{label:e.$t("加油地点"),prop:"address"}}),a("el-table-column",{attrs:{label:e.$t("dm.company"),prop:"enterpriseName"}}),a("el-table-column",{attrs:{label:e.$t("action.operation")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cv-table-tool",{attrs:{name:e.$route.name,data:e.$store.getters.manageMenus,"is-modify":!0},on:{modify:function(a){return e.edit(t.row)},remove:function(a){return e.del(t.row)}}})]}}])})],1)],1),a("el-dialog",{attrs:{visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[a(e.dialog.name,{tag:"component",attrs:{options:e.dialog.options,visible:e.dialog.flag,refresh:e.refresh,searchTable:e.searchOils},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)},"update:refresh":function(t){e.refresh=t},"update:searchTable":function(t){e.searchOils=t},"update:search-table":function(t){e.searchOils=t}}})],1)],1)},[],!1,null,null,null).exports;f.install=function(e){e.component(f.name,f)},t.default=f},b0ad:function(e,t,a){"use strict";(function(e){a("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var a=this,i=e||this.$t("action.confirmIsRemove");return new Promise(function(e,r){a.$confirm(i,a.$t("action.tip"),{confirmButtonText:a.$t("action.confirm"),cancelButtonText:a.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,a){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=a||this.$message.error({message:this.$t("请选择时间范围在"+a+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,a){var i=e.length,r=t.length;return r<i?{name:"add",data:this.$service.isUnique(e,t,a)}:i<r?{name:"remove",data:this.$service.isUnique(t,e,a)}:i==r?{name:"equal",data:this.$service.isUnique(e,t,a)}:void 0},showTooltip:function(e,t){var a=e.target,i=this.$refs[t];i.referenceElm=a,i.$refs.popper.style.display="none",i.doDestroy(),i.setExpectedState(!0),i.handleShowPopper()},mouseenterShowTip:function(e,t,a){var i=e.target;if(i.scrollWidth>i.offsetWidth||a)return this.showTooltip(e,t),a?a.startTime+"~"+a.endTime:i.innerText},mouseenterShowToolTip:function(e,t,a){var i=e.target;return this.showTooltip(e,t),!a&&i.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,a){var i=this,r=0<arguments.length&&void 0!==t?t:"Baidu",l=1<arguments.length?a:void 0;return e[r]?e[r]._preloader?e[r]._preloader:Promise.resolve(e[r]):(e[r]={},e[r]._preloader=new Promise(function(t,a){var o=document.createElement("script");o.src=l,e.document.body.appendChild(o),i.$service.isIe()&&i.$service.IE_VERSION<11?o.onreadystatechange=function(){"loaded"!=o.readyState&&"complete"!=o.readyState||(t(e[r]),e[r]._preloader=null)}:o.onload=function(){t(e[r]),e[r]._preloader=null}}),e[r]._preloader)}}}}).call(this,a("c8ba"))},d736:function(e,t,a){},e6dd:function(e,t,a){"use strict";var i=a("d736");a.n(i).a}}]);