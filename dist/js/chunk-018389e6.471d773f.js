(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-018389e6"],{"07b9":function(e,t,a){"use strict";a("96cf");var n=a("3b8d"),r={name:"tankTable",props:{configId:{},refresh:{},configType:{},remark:{default:function(){return!0}}},mixins:[a("b0ad").a],computed:{_table:function(){return this.$refs.tankTable}},methods:{del:function(e){var t=this;this.confirmPrompt().then(function(){Object(n.a)(regeneratorRuntime.mark(function a(){var n,r;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$store.dispatch("deleteOilMassConfigDetail",{id:e});case 2:n=a.sent,n.data,r=n.flag,n.errorCode,r?(t.$message.success({message:"删除成功"}),t._table.tableInitial()):t.$message.error({message:"删除失败"});case 7:case"end":return a.stop()}},a)}))()})}},watch:{"configId.configId":function(e,t){e&&this._table.tableInitial(!0)},refresh:function(e){e&&(this._table.tableInitial(!0),this.$emit("update:refresh",!1))}}},i=a("2877"),s=Object(i.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("cv-grid",{ref:"tankTable",attrs:{params:e.configId,url:"/oilMassConfig/queryOilMassConfigDetail"}},[a("el-table-column",{attrs:{type:"index",width:"60"}}),1==e.configType?a("el-table-column",{attrs:{label:e.$t("oil.percentage"),prop:"percentage"}}):e._e(),2==e.configType?a("el-table-column",{attrs:{label:e.$t("oil.maxHeight"),prop:"height"}}):e._e(),a("el-table-column",{attrs:{label:e.$t("oil.percentageOilmass"),prop:"percentageOilmass"}}),e.remark?a("el-table-column",{attrs:{label:e.$t("dD.bei"),prop:"remark"}}):e._e(),a("el-table-column",{attrs:{label:e.$t("action.operation")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cv-span",{attrs:{type:"danger"},nativeOn:{click:function(a){return e.del(t.row.id)}}},[e._v("删除")])]}}])})],1)},[],!1,null,null,null);t.a=s.exports},"20f9":function(e,t,a){"use strict";var n=a("477c");a.n(n).a},3512:function(e,t,a){"use strict";var n=a("d8d2");a.n(n).a},"477c":function(e,t,a){},b0ad:function(e,t,a){"use strict";(function(e){a("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var a=this,n=e||this.$t("action.confirmIsRemove");return new Promise(function(e,r){a.$confirm(n,a.$t("action.tip"),{confirmButtonText:a.$t("action.confirm"),cancelButtonText:a.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,a){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=a||this.$message.error({message:this.$t("请选择时间范围在"+a+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,a){var n=e.length,r=t.length;return r<n?{name:"add",data:this.$service.isUnique(e,t,a)}:n<r?{name:"remove",data:this.$service.isUnique(t,e,a)}:n==r?{name:"equal",data:this.$service.isUnique(e,t,a)}:void 0},showTooltip:function(e,t){var a=e.target,n=this.$refs[t];n.referenceElm=a,n.$refs.popper.style.display="none",n.doDestroy(),n.setExpectedState(!0),n.handleShowPopper()},mouseenterShowTip:function(e,t,a){var n=e.target;if(n.scrollWidth>n.offsetWidth||a)return this.showTooltip(e,t),a?a.startTime+"~"+a.endTime:n.innerText},mouseenterShowToolTip:function(e,t,a){var n=e.target;return this.showTooltip(e,t),!a&&n.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,a){var n=this,r=0<arguments.length&&void 0!==t?t:"Baidu",i=1<arguments.length?a:void 0;return e[r]?e[r]._preloader?e[r]._preloader:Promise.resolve(e[r]):(e[r]={},e[r]._preloader=new Promise(function(t,a){var s=document.createElement("script");s.src=i,e.document.body.appendChild(s),n.$service.isIe()&&n.$service.IE_VERSION<11?s.onreadystatechange=function(){"loaded"!=s.readyState&&"complete"!=s.readyState||(t(e[r]),e[r]._preloader=null)}:s.onload=function(){t(e[r]),e[r]._preloader=null}}),e[r]._preloader)}}}}).call(this,a("c8ba"))},d8d2:function(e,t,a){},e004:function(e,t,a){"use strict";a.r(t),a("7f7f");var n,r=a("cebc"),i=a("07b9"),s={props:{options:{type:[Object],default:function(){return{tankname:"",tankage:"",remark:""}}}},inject:["store"],data:function(){return{rules:{enterpriseId:[{required:!0,message:"请选择公司",trigger:"blur,change"}],tankname:[{required:!0,message:"请输入油箱名称",trigger:"blur,change"}],tankType:[{required:!0,message:"请输入油箱类型",trigger:"blur,change"}],tankheight:[{required:!0,message:"请输入油箱最大高度",trigger:"blur,change"}],avgSpeed:[{required:!0,message:"请输入极限速度",trigger:"blur,change"}],addThreshold:[{required:!0,message:"请输入极限油耗",trigger:"blur,change"}],tankage:[{required:!0,message:"请输入油箱容量",trigger:"blur,change"},{pattern:/^[0-9]+$/,message:this.$t("filter.type2"),trigger:"blur,change"}]},label:"",ruleForm:{enterpriseName:this.options.enterpriseName?this.options.enterpriseName:"",tankname:this.options.name?this.options.name:"",tankage:this.options.tankage?this.options.tankage:0,remark:this.options.remark?this.options.remark:"",tankType:this.options.type?this.options.type+"":"1",tankheight:this.options.maxHeight?this.options.maxHeight:"",addThreshold:this.options.addThreshold?this.options.addThreshold:"",avgSpeed:this.options.avgSpeed?this.options.avgSpeed:"",enterpriseId:this.options.enterpriseId?this.options.enterpriseId:""},typeList:[{label:"普通油箱",value:"1"},{label:"雷达波油箱",value:"2"}]}},methods:{cancelDialog:function(){this.$emit("update:visible",!1)},confirm:function(){var e=this;this.$refs.tankRules.validate(function(t){if(!t)return!1;var a={name:e.ruleForm.tankname,remark:e.ruleForm.remark,enterpriseId:e.ruleForm.enterpriseId||e.options.enterpriseId,type:e.ruleForm.tankType,avgSpeed:e.ruleForm.avgSpeed,addThreshold:e.ruleForm.addThreshold};1==e.ruleForm.tankType?a.tankage=e.ruleForm.tankage:a.maxHeight=e.ruleForm.tankheight,e.options.edit?(a.id=e.options.id,e.$store.dispatch("updateOilMassConfig",a).then(function(t){t.flag?(e.$message.success({message:"更新成功"}),e.$emit("update:type","edit")):e.$message.error({message:"更新失败"}),e.$emit("update:visible",!1)})):e.$store.dispatch("insertOilMassConfig",a).then(function(t){t.flag?(e.$message.success({message:"新增成功"}),e.$emit("update:type","add")):e.$message.error({message:e.$t("error."+t.errorCode)}),e.$emit("update:visible",!1)})})}}},o=a("2877"),l=Object(o.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"tankRules",attrs:{model:e.ruleForm,rules:e.rules}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"公司选择",prop:"enterpriseName"}},[a("cv-dropdown-tree",{staticStyle:{width:"98%"},attrs:{url:"/enterprise/getEnterpriseTreeList",disabled:!!e.options.id,text:e.ruleForm.enterpriseName,"is-default":!1,label:e.label},on:{"update:text":function(t){return e.$set(e.ruleForm,"enterpriseName",t)},"update:label":function(t){e.label=t}},model:{value:e.ruleForm.enterpriseId,callback:function(t){e.$set(e.ruleForm,"enterpriseId",t)},expression:"ruleForm.enterpriseId"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"油箱品牌",prop:"tankname"}},[a("el-input",{staticStyle:{width:"98%"},model:{value:e.ruleForm.tankname,callback:function(t){e.$set(e.ruleForm,"tankname","string"==typeof t?t.trim():t)},expression:"ruleForm.tankname"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"油箱类型",prop:"tankType"}},[a("el-select",{staticStyle:{width:"98%"},attrs:{disabled:e.options.edit},model:{value:e.ruleForm.tankType,callback:function(t){e.$set(e.ruleForm,"tankType",t)},expression:"ruleForm.tankType"}},e._l(e.typeList,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),a("el-col",{attrs:{span:12}},[1==e.ruleForm.tankType?a("el-form-item",{attrs:{label:"油箱容量",prop:"tankage"}},[a("el-input",{staticStyle:{width:"98%"},model:{value:e.ruleForm.tankage,callback:function(t){e.$set(e.ruleForm,"tankage","string"==typeof t?t.trim():t)},expression:"ruleForm.tankage"}})],1):e._e(),2==e.ruleForm.tankType?a("el-form-item",{attrs:{label:"高度(mm)",prop:"tankheight"}},[a("el-input",{staticStyle:{width:"98%"},model:{value:e.ruleForm.tankheight,callback:function(t){e.$set(e.ruleForm,"tankheight","string"==typeof t?t.trim():t)},expression:"ruleForm.tankheight"}})],1):e._e()],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"极限速度(km/h)",prop:"avgSpeed"}},[a("el-input",{staticStyle:{width:"98%"},attrs:{maxlength:"4",placeholder:"在加油时设置的极限速度"},model:{value:e.ruleForm.avgSpeed,callback:function(t){e.$set(e.ruleForm,"avgSpeed","string"==typeof t?t.trim():t)},expression:"ruleForm.avgSpeed"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"极限油耗(分/L)",prop:"addThreshold"}},[a("el-input",{staticStyle:{width:"98%"},attrs:{maxlength:"3",placeholder:"任意时刻，每分钟油耗极限值"},model:{value:e.ruleForm.addThreshold,callback:function(t){e.$set(e.ruleForm,"addThreshold","string"==typeof t?t.trim():t)},expression:"ruleForm.addThreshold"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"备注说明"}},[a("el-input",{staticStyle:{width:"98%"},attrs:{type:"textarea"},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark","string"==typeof t?t.trim():t)},expression:"ruleForm.remark"}})],1)],1)],1),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")]),a("el-button",{on:{click:e.cancelDialog}},[e._v("取消")])],1)],1)},[],!1,null,null,null).exports,c={components:{},mixins:[""],data:function(){return{}},methods:{cancelDialog:function(){this.$emit("update:visible",!1)},confirm:function(){this.$emit("confirm",{type:this.type,result:this.options})}}},u=Object(o.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",[a("el-form-item",{attrs:{label:"油箱名称"}},[a("el-input")],1),a("el-form-item",{attrs:{label:"油箱容量"}},[a("el-input")],1),a("el-form-item",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")]),a("el-button",{on:{click:e.cancelDialog}},[e._v("取消")])],1)],1)},[],!1,null,null,null).exports,d=(a("96cf"),a("3b8d")),p=a("b0ad"),m={props:{type:"",enterpriseId:{type:[String]}},components:{},mixins:[p.a],data:function(){return{tankParams:{list:[],total:"",size:10,current:1},keyForSearch:"",currentIndex:null}},methods:{keySearch:function(){this.getTankData({enterpriseId:this.enterpriseId,oilMassName:this.keyForSearch})},add:function(){this.$emit("update:add",!0)},handleCurrentChange:function(e){this.tankParams.current=e,this.getTankData({enterpriseId:this.enterpriseId,current:e})},tankCheck:function(e,t){this.currentIndex=t,this.$emit("update:checkTank",e)},getTankData:(n=Object(d.a)(regeneratorRuntime.mark(function e(){var t,a,n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:{},e.next=3,this.$store.dispatch("queryOilMassConfig",t);case 3:a=e.sent,n=a.data,a.flag&&n?(this.tankParams.list=n.records,this.tankParams.total=n.total-0,this.tankParams.size=n.size-0):(this.tankParams.list=[],this.tankParams.total=0,this.tankParams.size=10);case 7:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),del:function(e){var t=this;event.stopPropagation(),event.preventDefault&&event.preventDefault(),this.confirmPrompt().then(function(){Object(d.a)(regeneratorRuntime.mark(function a(){var n,r,i;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$store.dispatch("deleteOilMassConfig",{id:e});case 2:n=a.sent,n.data,r=n.flag,i=n.errorCode,r?(t.$message.success({message:"删除成功"}),t.tankParams.current=1,t.getTankData({enterpriseId:t.enterpriseId,current:1})):t.$message.error({message:t.$t("error."+i)});case 7:case"end":return a.stop()}},a)}))()})},edit:function(e){event.preventDefault&&event.preventDefault(),event.stopImmediatePropagation&&event.stopImmediatePropagation(),e.edit=!0,this.$emit("update:editdata",e),this.$emit("update:edit",!0)}},mounted:function(){this.getTankData()},watch:{type:function(e){if(this.currentIndex=null,e){"add"==e&&(this.tankParams.current=1);var t={current:this.tankParams.current,enterpriseId:this.enterpriseId};this.getTankData(t),this.$emit("update:type","")}},enterpriseId:function(e){this.getTankData({enterpriseId:e,current:1})}}},h=(a("3512"),Object(o.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tank-list"},[a("div",{staticClass:"header"},[e._v("\n        油箱列表\n        "),a("cv-icon",{attrs:{name:"jia"},nativeOn:{click:function(t){return e.add(t)}}})],1),a("div",{staticClass:"search"},[a("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.keySearch(t)}},model:{value:e.keyForSearch,callback:function(t){e.keyForSearch=t},expression:"keyForSearch"}})],1),a("div",{staticClass:"listContent"},[a("ul",{ref:"ulItem"},e._l(e.tankParams.list,function(t,n){return a("li",{key:t.id,class:n==e.currentIndex?"bgColor":"",attrs:{value:t.id,ee:n},on:{click:function(a){return e.tankCheck(t,n)}}},[a("div",{staticClass:"nameStyle",staticStyle:{"margin-right":"15px"},attrs:{title:8<t.name.length?t.name:""}},[e._v(e._s(t.name))]),1==t.type?a("div",{staticClass:"nameStyle"},[e._v(e._s(t.tankage)+"(L)")]):e._e(),2==t.type?a("div",{staticClass:"nameStyle"},[e._v(e._s(t.maxHeight)+"(mm)")]):e._e(),a("cv-span",{staticClass:"buttons",staticStyle:{"margin-left":"10px"},attrs:{type:"success"},nativeOn:{click:function(a){return e.edit(t)}}},[e._v("修改")]),a("cv-span",{staticClass:"buttons",attrs:{type:"danger"},nativeOn:{click:function(a){return e.del(t.id)}}},[e._v("删除")])],1)}),0)]),a("el-pagination",{staticStyle:{position:"absolute",bottom:"10px"},attrs:{small:"",layout:"prev, pager, next",total:Number(e.tankParams.total),"current-page":e.tankParams.current,size:e.tankParams.size},on:{"update:currentPage":function(t){return e.$set(e.tankParams,"current",t)},"update:current-page":function(t){return e.$set(e.tankParams,"current",t)},"current-change":e.handleCurrentChange}})],1)},[],!1,null,null,null).exports),f=a("2f62"),g={components:{tankTable:i.a,tankAddmodify:l,tankSearch:u,tankList:h},mixins:[""],provide:function(){return{store:this.store}},data:function(){return{label:"",store:{company_tree:[]},dialog:{flag:!1,title:"添加",size:"dialog-middle",name:"tankSearch",options:{}},type:!1,add:!1,edit:!1,editdata:{},checkTank:{},common:{enterpriseId:"",enterpriseName:""},searchP:{configId:""}}},computed:Object(r.a)({},Object(f.c)(["user"])),methods:Object(r.a)({},Object(f.b)(["queryCompanyInfoList"]),{calibration:function(){if(this.checkTank.id){var e={id:this.checkTank.id,name:this.checkTank.name,type:this.checkTank.type};1==this.checkTank.type?e.level=this.checkTank.tankage:e.maxHeight=this.checkTank.maxHeight,this.$router.push({path:"/index/tankManage-child",query:e})}else this.$message.warning({message:"请选择油箱"})}}),watch:{add:function(e){e&&(this.dialog.flag=!0,this.dialog.name="tankAddmodify",this.dialog.title="新增",this.add=!1,this.dialog.options={})},edit:function(e){e&&(this.dialog.flag=!0,this.dialog.title="修改",this.dialog.name="tankAddmodify",this.edit=!1,this.dialog.options=this.editdata)},"dialog.flag":function(e){e||(this.dialog.name="",this.editdata={})},checkTank:function(e){this.searchP.configId=e.id},type:function(e){"add"==e&&this.$refs.tankList.getTankData()}},mounted:function(){var e=this;this.queryCompanyInfoList().then(function(t){var a=t.data,n=t.flag;e.store.company_tree=n?a:[]})}},k=(a("20f9"),Object(o.a)(g,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tank"},[a("cv-operation",[a("el-form-item",[a("cv-tool",{attrs:{name:e.$route.name,data:e.$store.getters.manageMenus,"is-modify":!1,"is-remove":!1,"is-export":!1,"is-search":!1,"is-add":!1},on:{calibrate:e.calibration}})],1)],1),a("cv-content",[a("div",{attrs:{slot:"aside"},slot:"aside"},[a("cv-dropdown-tree",{staticStyle:{width:"300px"},attrs:{url:"/enterprise/getEnterpriseTreeList","is-default":!1,label:e.label,text:e.common.enterpriseName},on:{"update:label":function(t){e.label=t},"update:text":function(t){return e.$set(e.common,"enterpriseName",t)}},model:{value:e.common.enterpriseId,callback:function(t){e.$set(e.common,"enterpriseId",t)},expression:"common.enterpriseId"}}),a("tank-list",{ref:"tabkList",staticClass:"listPosition",attrs:{type:e.type,enterpriseId:e.common.enterpriseId,add:e.add,edit:e.edit,editdata:e.editdata,checkTank:e.checkTank},on:{"update:type":function(t){e.type=t},"update:add":function(t){e.add=t},"update:edit":function(t){e.edit=t},"update:editdata":function(t){e.editdata=t},"update:checkTank":function(t){e.checkTank=t},"update:check-tank":function(t){e.checkTank=t}}})],1),a("tank-table",{ref:"list",staticClass:"tablePosition",attrs:{configId:e.searchP,configType:e.checkTank.type},on:{"update:configId":function(t){e.searchP=t},"update:config-id":function(t){e.searchP=t}}})],1),a("el-dialog",{attrs:{visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[a(e.dialog.name,{tag:"component",attrs:{options:e.dialog.options,visible:e.dialog.flag,type:e.type},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)},"update:type":function(t){e.type=t}}})],1)],1)},[],!1,null,null,null).exports);t.default=k}}]);