(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2cce09e3"],{"2ebd":function(e,t,a){},"8ebd":function(e,t,a){"use strict";a("7f7f");var i=a("bd86"),r=(a("ac6a"),a("cebc")),n=a("2f62"),o={name:"CvAreaDrawmap",props:{title:{},model:{},rules:{},visible:{type:Boolean,default:!1},routerType:{type:String,default:"line"},type:{type:String,default:"add"},className:{type:String,default:"routermanage-dropdown-width"}},data:function(){return{isShow:!0,routerOptions:null,saveLoad:!1,dropFlag:!0}},computed:Object(r.a)({},Object(n.c)(["mapName"]),{_formMethods:function(){return this.$refs.form},_mapMethods:function(){return this.$refs.map.mapMethods}}),watch:{model:function(e){var t=this;if("add"!==this.type)var a=setTimeout(function(i){clearTimeout(a),a=null,t.detailLngLatPoints(e.list)},100)},type:function(e){"add"==e&&this._mapMethods.setCity("上海市")},visible:function(e){e&&(this.dropFlag=!0)}},methods:{returnPage:function(){this.resetRouter(),this.saveLoad=!1,this.$emit("update:model",{}),this.$emit("update:visible",!1),this.$emit("return-page"),this.dropFlag=!1},createRouter:function(){var e=this;this.dropFlag=!1,this.resetRouter(!1);var t=this.routerType.charAt(0).toUpperCase()+this.routerType.substring(1);this._mapMethods["onclick"+t](function(t){e.dropFlag=!0,e.routerOptions=t.overlay})},resetRouter:function(e){var t=!(0<arguments.length&&void 0!==e)||e;this._mapMethods.clearOverlays(),this.routerOptions=null,t&&this._formMethods.resetFields()},saveRouter:function(){var e=this,t=this;this._formMethods.validate(function(a){if(!e.routerOptions)return e.$message.error("您未在地图上创建区域！");a&&(e.saveLoad=!0,e.$emit("save",Object(r.a)({},e.model,{type:e.type,list:e.getPolygonOptions(e.routerOptions),successCallback:function(){t.saveLoad=!1,t.$emit("update:model",{}),t.resetRouter(),t.dropFlag=!1},errorCallback:function(){t.saveLoad=!1,t.dropFlag=!1}})))})},getPolygonOptions:function(e){switch(this.routerType){case"polygon":var t=this._mapMethods.getPolygonOptions(e).points;return this._getPolygonOptions(t);case"rectangle":var a=this._mapMethods.getPolygonOptions(e).points;return this._getRectangleOptions(a);case"line":var i=this._mapMethods.getLineOptions(e).points;return this._getLineOptions(i);case"circle":var r=this._mapMethods.getCircleOptions(e).points;return this._getCircleOptions(r)}},_getPolygonOptions:function(e,t,a){var r=1<arguments.length&&void 0!==t?t:["mapLongitude","mapLatitude"],n=2<arguments.length&&void 0!==a?a:["lng","lat"],o=[];return e.forEach(function(e){var t;o.push((t={},Object(i.a)(t,r[0],e[n[0]]),Object(i.a)(t,r[1],e[n[1]]),t))}),o},_getRectangleOptions:function(e,t,a){var i=1<arguments.length&&void 0!==t?t:["mapLongitude","mapLatitude"],r=2<arguments.length&&void 0!==a?a:["lng","lat"],n=[],o=[],s=[],l={},c={};return e.forEach(function(e){o.push(e[r[0]]),s.push(e[r[1]])}),l[i[0]]=Math.max.apply(Math,o),l[i[1]]=Math.max.apply(Math,s),c[i[0]]=Math.min.apply(Math,o),c[i[1]]=Math.min.apply(Math,s),n.push(l,c),n},_getLineOptions:function(e,t,a){var r=1<arguments.length&&void 0!==t?t:["mapLongitude","mapLatitude"],n=2<arguments.length&&void 0!==a?a:["lng","lat"],o=[];return e.forEach(function(e){var t;o.push((t={},Object(i.a)(t,r[0],e[n[0]]),Object(i.a)(t,r[1],e[n[1]]),t))}),o},_getCircleOptions:function(e,t,a){var r,n=1<arguments.length&&void 0!==t?t:["mapLongitude","mapLatitude"],o=2<arguments.length&&void 0!==a?a:["lng","lat"],s=[];return s.push((r={},Object(i.a)(r,n[0],e.center[o[0]]),Object(i.a)(r,n[1],e.center[o[1]]),r)),s},detailLngLatPoints:function(e){if(this.$service.isArray(e)&&0<e.length){var t=null;switch(this.routerType){case"polygon":t=this._getPolygonOptions(e,["lng","lat"],["mapLongitude","mapLatitude"]);break;case"rectangle":t=this._getRectangleOptions(e,["lng","lat"],["mapLongitude","mapLatitude"]);break;case"line":t=e}this.routerOptions=this._mapMethods["mapAdd"+this.routerType](t,{}),this._mapMethods.getBestView(this.routerOptions.points)}},mapReady:function(){"modify"==this.type&&this.detailLngLatPoints(this.model.list)}}},s=(a("eb84"),a("2877")),l=Object(s.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"routermanage-map-operation"},[a(e.mapName,{ref:"map",tag:"component",staticClass:"routermanage-map",attrs:{mapLoaded:e.mapReady}}),a("cv-dropdown",{staticClass:"routermanage-operation",attrs:{"class-name":e.className,visible:e.dropFlag,placement:"top-end"}},[a("el-button",{attrs:{type:"success",icon:"el-icon-edit",circle:""},on:{click:function(t){e.dropFlag=!e.dropFlag}}}),a("div",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("h2",{staticClass:"cv-mapoperation-title"},[e._v("\n                "+e._s(e.title)+"\n                "),a("cv-icon",{staticStyle:{float:"right"},attrs:{name:"remove"},on:{click:e.returnPage}})],1),a("el-form",{ref:"form",staticClass:"cv-mapoperation-form",attrs:{"label-width":"120px",model:e.model,rules:e.rules}},[e._t("default"),a("div",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.createRouter}},[e._v("创建")]),a("el-button",{on:{click:e.resetRouter}},[e._v("重置")]),a("el-button",{attrs:{loading:e.saveLoad},on:{click:e.saveRouter}},[e._v("保存")])],1)],2)],1)],1)],1)},[],!1,null,null,null).exports;l.install=function(e){e.component(l.name,l)},t.a=l},b0ad:function(e,t,a){"use strict";(function(e){a("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var a=this,i=e||this.$t("action.confirmIsRemove");return new Promise(function(e,r){a.$confirm(i,a.$t("action.tip"),{confirmButtonText:a.$t("action.confirm"),cancelButtonText:a.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,a){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=a||this.$message.error({message:this.$t("请选择时间范围在"+a+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,a){var i=e.length,r=t.length;return r<i?{name:"add",data:this.$service.isUnique(e,t,a)}:i<r?{name:"remove",data:this.$service.isUnique(t,e,a)}:i==r?{name:"equal",data:this.$service.isUnique(e,t,a)}:void 0},showTooltip:function(e,t){var a=e.target,i=this.$refs[t];i.referenceElm=a,i.$refs.popper.style.display="none",i.doDestroy(),i.setExpectedState(!0),i.handleShowPopper()},mouseenterShowTip:function(e,t,a){var i=e.target;if(i.scrollWidth>i.offsetWidth||a)return this.showTooltip(e,t),a?a.startTime+"~"+a.endTime:i.innerText},mouseenterShowToolTip:function(e,t,a){var i=e.target;return this.showTooltip(e,t),!a&&i.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,a){var i=this,r=0<arguments.length&&void 0!==t?t:"Baidu",n=1<arguments.length?a:void 0;return e[r]?e[r]._preloader?e[r]._preloader:Promise.resolve(e[r]):(e[r]={},e[r]._preloader=new Promise(function(t,a){var o=document.createElement("script");o.src=n,e.document.body.appendChild(o),i.$service.isIe()&&i.$service.IE_VERSION<11?o.onreadystatechange=function(){"loaded"!=o.readyState&&"complete"!=o.readyState||(t(e[r]),e[r]._preloader=null)}:o.onload=function(){t(e[r]),e[r]._preloader=null}}),e[r]._preloader)}}}}).call(this,a("c8ba"))},cd56:function(e,t,a){"use strict";a.r(t),a("96cf");var i,r,n,o=a("3b8d"),s=a("cebc"),l=a("b0ad"),c=a("2f62"),d={mixins:[l.a],data:function(){return{dialog:{flag:!1,name:"",title:"",size:"dialog-small",options:{}},searchData:{enterpriseName:"",zoneName:""}}},computed:Object(s.a)({},Object(c.c)(["mapType"]),{_tableMethods:function(){return this.$refs.table}}),methods:{add:function(){this.$emit("add")},confirm:function(e){this.$service.mapParams(this.searchData,e),this._tableMethods.tableInitial()},load:function(){this._tableMethods.tableInitial()},searchT:function(){this._tableMethods.tableInitial()},tableModify:function(e){this.$emit("tableModify",{id:e.row.id,mapType:this.mapType})},tableRemove:(i=Object(o.a)(regeneratorRuntime.mark(function e(t){var a,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t.row,this.confirmPrompt().then(function(e){return i.$store.dispatch("deleteJurisdictionalInfo",{id:a.id})}).then(function(e){var t=e.flag,a=e.errorCode;t?(i._tableMethods.tableInitial(),i.$message.success(i.$t("action.removeSuccess"))):i.$message.error(i.$t("error."+a))});case 2:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})}},u=a("2877"),p={name:"jurisdictionalArea",components:{JurisdictionalareaMain:Object(u.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("cv-operation",[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"请输入公司名称搜索"},model:{value:e.searchData.enterpriseName,callback:function(t){e.$set(e.searchData,"enterpriseName",t)},expression:"searchData.enterpriseName"}})],1),a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入区域名称搜索",clearable:""},model:{value:e.searchData.zoneName,callback:function(t){e.$set(e.searchData,"zoneName",t)},expression:"searchData.zoneName"}})],1),a("el-form-item",[a("cv-tool",{attrs:{name:e.$route.name,data:e.$store.getters.manageMenus,"is-modify":!1,"is-remove":!1,"is-export":!1},on:{add:e.add,search:e.searchT}})],1)],1),a("cv-content",[a("cv-grid",{ref:"table",attrs:{url:"/government/queryPagerInfoList",params:e.searchData}},[a("el-table-column",{attrs:{label:"区域名称",prop:"zoneName"}}),a("el-table-column",{attrs:{label:"公司",prop:"enterpriseName"}}),a("el-table-column",{attrs:{label:"备注",prop:"remark"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cv-span",{attrs:{type:"success"},nativeOn:{click:function(a){return e.tableModify(t)}}},[e._v("修改")]),a("cv-span",{attrs:{type:"danger"},nativeOn:{click:function(a){return e.tableRemove(t)}}},[e._v("删除")])]}}])})],1)],1),a("el-dialog",{attrs:{visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[a(e.dialog.name,{tag:"component",attrs:{options:e.dialog.options,visible:e.dialog.flag},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)},confirm:e.confirm}})],1)],1)},[],!1,null,null,null).exports,CvAreadrawmap:a("8ebd").a},data:function(){return{isType:!0,visible:!1,model:{},rules:{zoneName:[{required:!0,message:"内容不能为空"}],enterpriseId:[{required:!0,message:"公司不能为空"}]},type:null,title:"新建管辖区域"}},computed:{_tableMethods:function(){return this.$refs.table}},methods:{returnMap:function(){this.switchAddOrModify("add"),this.visible=!0},switchAddOrModify:function(e){switch(e){case"add":this.type="add",this.title="新建管辖区域";break;case"modify":this.type="modify",this.title="修改管辖区域"}},routerSave:(n=Object(o.a)(regeneratorRuntime.mark(function e(t){var a,i,r,n,o,s,l,c,d,u,p,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.enterprise,i=t.list,r=t.zoneName,n=t.remark,o=t.enterpriseId,s=t.type,l=t.successCallback,c=t.errorCallback,d={list:i,zoneName:r,remark:n,mapType:this.$store.getters.mapType},e.prev=2,e.next=5,this.$store.dispatch("add"==s?"insertJurisdictionalInfo":"updateJurisdictionalInfo",Object.assign(d,"add"==s?{enterpriseId:a.id}:{id:t.id,enterpriseId:a?a.id:o}));case 5:u=e.sent,p=u.flag,u.data,m=u.errorCode,p?(this.visible=!1,l(),this._tableMethods.load(),this.$message.success("操作成功!")):(c(),this.$message.error(this.$t("error."+m))),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),c(),this.$message.error("网络异常!");case 16:case"end":return e.stop()}},e,this,[[2,12]])})),function(e){return n.apply(this,arguments)}),getModify:(r=Object(o.a)(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.switchAddOrModify("modify"),e.next=3,this.$store.dispatch("queryJurisdictionalInfo",t);case 3:a=e.sent,a.flag,i=a.data,this.visible=!0,i&&(this.model=i);case 8:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})}},m=(a("f80f"),Object(u.a)(p,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("jurisdictionalarea-main",{ref:"table",on:{add:e.returnMap,tableModify:e.getModify}}),a("cv-areadrawmap",{attrs:{"class-name":"jurisdictional-dropdownwidth",title:e.title,type:e.type,"router-type":"polygon",visible:e.visible,model:e.model,rules:e.rules},on:{"update:visible":function(t){e.visible=t},save:e.routerSave,"update:model":function(t){e.model=t}}},[a("el-form-item",{attrs:{label:"管辖区域名称:",prop:"zoneName"}},[a("el-input",{model:{value:e.model.zoneName,callback:function(t){e.$set(e.model,"zoneName","string"==typeof t?t.trim():t)},expression:"model.zoneName"}})],1),a("el-form-item",{attrs:{label:"选择公司:",prop:"enterpriseId"}},[a("cv-dropdown-tree",{attrs:{placeholder:e.$t("common.enterprise.enterpriseName"),url:"/enterprise/getEnterpriseTreeList",label:e.model.enterprise},on:{"update:label":function(t){return e.$set(e.model,"enterprise",t)}},model:{value:e.model.enterpriseId,callback:function(t){e.$set(e.model,"enterpriseId",t)},expression:"model.enterpriseId"}})],1),a("el-form-item",{attrs:{label:"备注:",prop:"remark"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.model.remark,callback:function(t){e.$set(e.model,"remark",t)},expression:"model.remark"}})],1)],1)],1)},[],!1,null,null,null).exports);t.default=m},eb84:function(e,t,a){"use strict";var i=a("efa7");a.n(i).a},efa7:function(e,t,a){},f80f:function(e,t,a){"use strict";var i=a("2ebd");a.n(i).a}}]);