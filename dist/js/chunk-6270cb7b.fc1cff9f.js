(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6270cb7b"],{2648:function(e,t,a){},"4efb":function(e,t,a){},8853:function(e,t,a){"use strict";var r=a("2648");a.n(r).a},cf49:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={props:{data:{type:Array,default:function(){return[]}},options:{},layout:{},alarmList:{}},data:function(){return{alarmIds:[],test:"",wrongArr:[],grid:{options:{current:1,total:0,size:10},table:[],loading:!1}}},methods:{selectAll:function(e){0!=e.length&&(this.options["param"+e[0].category],this.options["param"+e[0].category]=e)},blur:function blur(s,i){var reg=eval(s.row.regex);reg.test(s.row.paramValue)?this.wrongArr.splice(this.wrongArr.indexOf(i),1):this.wrongArr.push(i)}},created:function(){this.grid.table=this.data},mounted:function(){this.$refs.multipleTable.store.scheduleLayout()}}},de8e:function(e,t,a){"use strict";a.r(t),a("ac6a"),a("96cf");var r,s,n,i,o=a("3b8d"),l=a("cf49").a,c=(a("e112"),a("2877")),m={components:{TerminalSetingDetail:Object(c.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"treminal-params-detail"},[a("cv-grid",{attrs:{options:e.grid.options,isPagination:!1}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.grid.loading,expression:"grid.loading"}],ref:"multipleTable",attrs:{border:"",stripe:"",data:e.grid.table},on:{"selection-change":e.selectAll}},[a("el-table-column",{attrs:{type:"selection",width:"50","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:this.$t("terminalParamSet.paramName"),prop:"name","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:this.$t("terminalParamSet.serviceParam"),prop:"paramValue",width:"305"},scopedSlots:e._u([{key:"default",fn:function(t){return["61954"==t.row.terminalParamId?a("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"请选择"},model:{value:t.row.paramValue,callback:function(a){e.$set(t.row,"paramValue",a)},expression:"scope.row.paramValue"}},e._l(e.alarmList,function(e){return a("el-option",{key:e.value,attrs:{label:e.alarmName,value:e.num}})}),1):e._e(),"61954"!==t.row.terminalParamId?a("el-input",{staticStyle:{width:"200px"},attrs:{size:"small"},on:{blur:function(a){return e.blur(t,t.$index)}},model:{value:t.row.paramValue,callback:function(a){e.$set(t.row,"paramValue","string"==typeof a?a.trim():a)},expression:"scope.row.paramValue"}}):e._e(),-1!=e.wrongArr.indexOf(t.$index)?a("span",{ref:"span",staticStyle:{color:"red"}},[e._v(" 格式错误!")]):e._e()]}}])}),a("el-table-column",{attrs:{label:this.$t("terminalParamSet.terminalReal"),prop:"terminalParamValue","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{label:this.$t("terminalParamSet.paramDesc"),prop:"desc","show-overflow-tooltip":!0}})],1)],1)],1)},[],!1,null,null,null).exports},created:function(){var e=this;this.$http({url:"/monitor/findVehicleTreeInfoList",params:{flag:!1,carCategory:1}}).then(function(t){e.energeTree=t.data,e.treeLoading=!1}),this.$http({url:"/alarmInfo/queryAlarmType"}).then(function(t){t.flag&&(e.content.alarmList=t.data)})},data:function(){return{treeLoading:!1,energeTree:null,treeChecked:!1,header:{searchFlag:!1,updateFlag:!1,setFlag:!1,upFlag:!0,disFlag:!0,disFlag1:!0},content:{contentLoading:!1,data:[],alarmList:[],selectItem:{}},common:{vehicleId:"",trackId:"",timer:null,setTime:null,layout:!1}}},methods:{single:(i=Object(o.a)(regeneratorRuntime.mark(function e(t){var a,r,s,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.content.contentLoading=!0,e.prev=1,this.initData(t.id),e.next=5,this.$store.dispatch("terminalqueryNew",{vehicleId:t.id,carCategory:1});case 5:a=e.sent,r=a.data,s=a.flag,n=a.errorCode,s?0==r.length?(this.$message.error({message:this.$t("error.208")}),this.content.data=r):(this.content.data=r,this.header.disFlag=!1,this.header.disFlag1=!1):(this.content.data=[],this.$message.error({message:this.$t("error."+n)})),this.content.contentLoading=!1,this.common.layout=!0,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),this.content.contentLoading=!1;case 17:case"end":return e.stop()}},e,this,[[1,14]])})),function(e){return i.apply(this,arguments)}),initData:function(e){this.content.data=[],this.header.searchFlag=!1,this.header.upFlag=!0,clearTimeout(this.commonsetTime),this.common.setTime=null,this.common.vehicleId=e,this.content.selectItem=[]},search:(n=Object(o.a)(regeneratorRuntime.mark(function e(){var t,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.header.searchFlag=!0,this.header.disFlag1=!0,t={carCategory:1,vehicleId:this.common.vehicleId},e.next=5,this.$store.dispatch("terminaluploadNew",t);case 5:a=e.sent,a.flag,r=a.data,this.common.timer=(new Date).getTime(),this.common.trackId=r.id,1==r.status?this.loopTrack():0==r.status?(this.header.searchFlag=!1,this.header.disFlag1=!1,this.$message.error({message:this.$t("error.7004")})):(this.header.searchFlag=!1,this.header.disFlag1=!1,this.$message.error({message:this.$t("terminalParamSet.searchFalse")}));case 11:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),update:(s=Object(o.a)(regeneratorRuntime.mark(function e(){var t,a,r,s,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this.content.data.forEach(function(e){e.params.forEach(function(e){var a={};a.paramValue=e.terminalParamValue,a.terminalParamId=e.terminalParamId,t.push(a)})}),a={vehicleId:this.common.vehicleId,carCategory:1,params:JSON.stringify(t)},e.next=5,this.$http({url:"/terminalParam/update",data:JSON.stringify(a)});case 5:r=e.sent,r.data,s=r.flag,n=r.errorCode,s?this.$message.success({message:this.$t("action.updateSuccess")}):this.$message.error({message:this.$t("error."+n)});case 10:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)}),set:(r=Object(o.a)(regeneratorRuntime.mark(function e(){var t,a,r,s,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t=[],this.content.selectItem)this.content.selectItem[r].forEach(function(e){var a={};a.paramValue="string"==typeof e.paramValue?e.paramValue:e.paramValue.reverse().join(","),a.terminalParamId=e.terminalParamId,a.terminalParam={dataType:e.dataType},t.push(a)});if(0!=t.length){e.next=6;break}this.$message.error({message:this.$t("terminalParamSet.selectOne")}),e.next=14;break;case 6:return a={vehicleId:this.common.vehicleId,carCategory:1,params:JSON.stringify(t)},e.next=9,this.$http({url:"/terminalParam/set",data:JSON.stringify(a)});case 9:s=e.sent,s.data,n=s.flag,i=s.errorCode,n?this.$message.success({message:this.$t("action.orderSuccess")}):this.$message.error({message:this.$t("error."+i)});case 14:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)}),loopTrack:function(){var e=this,t=(new Date).getTime()-this.common.timer<12e4;this.$store.dispatch("trackSendFlagNew",this.common.trackId).then(function(a){if(a.flag)if(1==a.data.sendFlag)clearTimeout(e.common.setTime),e.common.setTime=null,setTimeout(function(t){var a={id:e.common.trackId,carCategory:1};e.$store.dispatch("queryTerminalParamsNew",a).then(function(t){t.flag?(e.content.data.forEach(function(e){e.params.forEach(function(e){e.terminalParamValue=t.data["paramId"+e.terminalParamId]})}),e.$message.success({message:e.$t("terminalParamSet.searchSuccess")}),e.header.upFlag=!1,e.header.disFlag1=!1,e.header.searchFlag=!1,e.header.updateFlag=!1,e.header.setFlag=!1):e.$message.error({message:e.$t("error."+t.errorCode)})})},2e3);else if(0!=a.data.sendFlag&&5!=a.data.sendFlag||!t)switch(a.sendFlag){case 2:e.$message.success({message:e.$t("设备不在线")});break;case 3:e.$message.success({message:e.$t("失败")});break;case 4:e.$message.success({message:e.$t("等待回应超时")});break;case 6:e.$message.success({message:e.$t("作废")})}else e.common.setTime=setTimeout(function(t){e.loopTrack()},1500)})},singleCar:function(e){this.single(e)}},watch:{},mounted:function(){this.$route.query.id&&this.single({id:this.$route.query.id})}},u=(a("8853"),Object(c.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"terminal-params-set"},[a("cv-header",[a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{size:"small",loading:e.header.searchFlag,disabled:e.header.disFlag},on:{click:e.search}},[e._v(e._s(this.$t("terminalParamSet.search")))]),a("el-button",{attrs:{size:"small",loading:e.header.updateFlag,disabled:e.header.upFlag},on:{click:e.update}},[e._v(e._s(this.$t("terminalParamSet.update")))]),a("el-button",{attrs:{size:"small",loading:e.header.setFlag,disabled:e.header.disFlag1},on:{click:e.set}},[e._v(e._s(this.$t("terminalParamSet.set")))])],1)],1),a("cv-content",{directives:[{name:"loading",rawName:"v-loading",value:e.content.contentLoading,expression:"content.contentLoading"}]},[a("cv-tabs-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],staticClass:"energe-tree",attrs:{slot:"aside","is-operation":!1,titles:["车辆选择","车辆列表"],"is-checked":!1,"tree-data":e.energeTree,"node-monitor":e.handlerMonitor},slot:"aside"}),a("el-collapse",e._l(e.content.data,function(t){return a("el-collapse-item",{key:t.categoryCode,attrs:{title:t.categoryName,name:t.categoryCode}},[a("TerminalSetingDetail",{attrs:{data:t.params,options:e.content.selectItem,layout:e.common.layout,alarmList:e.content.alarmList},on:{"update:layout":function(t){return e.$set(e.common,"layout",t)}}})],1)}),1)],1)],1)},[],!1,null,null,null).exports);t.default=u},e112:function(e,t,a){"use strict";var r=a("4efb");a.n(r).a}}]);