(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a26f563e"],{"05c0":function(e,t,n){"use strict";n("7f7f"),n("20d6"),n("ac6a");var i=n("cebc"),a=n("3f4e"),r=n("2f62"),c={name:"CvPublictreeContent",components:{CvContent:a.a},props:{model:String,vehicleMonitor:Function,loading:Boolean,noresize:{default:!1,type:Boolean}},data:function(){return{entryList:[],condition:""}},computed:Object(i.a)({},Object(r.c)(["onlineList","isAttention","socketEnterprise","socketVehicle","vehicle_data","vehicleCondition"]),{isCheck:function(){switch(this.model){case"multi":return!0;case"single":default:return!1}},_treeMethods:function(){return this.$refs.tabs},_contentMethods:function(){return this.$refs.content}}),beforeDestroy:function(){var e=this._treeMethods.getAllNodes;this.setStoreVehicleSearchCondition(this.condition),this.setStoreVehicleData(e())},mounted:function(){var e=this._treeMethods.$refs.tree.reference().ztreeApi;e()&&e().checkAllNodes(!1)},methods:Object(i.a)({},Object(r.b)(["setStoreVehicleData","setStoreVehicleSearchCondition"]),{handlerVehicleSearch:function(e){this.condition=e},vehicle_Monitor:function(e){var t=e.data;if(e.name,"function"==typeof this.vehicleMonitor)switch(this.model){case"multi":return this.vehicle_Monitor_multi(e);case"single":return this.vehicleMonitor(t[0])}},vehicle_Monitor_multi:function(e){var t=this,n=e.data;switch(e.name){case"check":this.entryList=this.entryList.concat(n);break;case"cancel":n.forEach(function(e){var n=t.entryList.findIndex(function(t){return t.id==e.id});0<=n&&t.entryList.splice(n,1)})}this.vehicleMonitor(this.entryList)}})},o=(n("45d7"),n("2877")),s=Object(o.a)(c,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("cv-content",{ref:"content",attrs:{loading:e.loading,noresize:e.noresize}},[e.model?n("cv-tabs-tree",{ref:"tabs",staticClass:"vehiclemaster-tree",attrs:{slot:"aside","vehicle-search":e.vehicleCondition,"is-checked":e.isCheck,"tree-data":e.vehicle_data,"online-monitor":e.onlineList,"vehicle-monitor":e.socketVehicle,"attention-monitor":e.isAttention,"enterprise-fleet-monitor":e.socketEnterprise,"node-monitor":e.vehicle_Monitor},on:{"vehicle-choose-search":e.handlerVehicleSearch},slot:"aside"}):e._e(),e._t("default")],2)},[],!1,null,"2dfdf41b",null).exports;s.install=function(e){e.component(s.name,s)},t.a=s},"45d7":function(e,t,n){"use strict";var i=n("6e18");n.n(i).a},"6bbe":function(e,t,n){"use strict";n.r(t),n("96cf");var i,a=n("3b8d"),r=(n("7514"),n("20d6"),n("ac6a"),n("7f7f"),{components:{CvPublictreeContent:n("05c0").a},data:function(){return{treeLoading:!1,vehicleId:"",loopTimer:5,timer:null,baseMess:[],canTime:"",currentTable:[],rememberRowNum:[],echart:{datas:[]}}},methods:{handlerRowEvent:function(e,t){this.rememberRowNum=e.map(function(e){return e.index}),this.isAddOrRemove(e)},isAddOrRemove:function(e){var t=this,n=this.$service.addRemoveUnique(e,t.echart.datas,"index");"add"===n.name?n.data.forEach(function(e){t.$store.dispatch("baseEchartData",{index:e.index,text:e.NAME,time:[e.d],v:[e.v],unit:[e.unit]}).then(function(e){t.echart.datas.push(e)})}):n.data.forEach(function(e){var n=t.echart.datas.findIndex(function(t){return t.index==e.index});t.echart.datas.splice(n,1)})},canVehicleMonitor:function(e){this.vehicleId=e.id,this.canTime="",this.timer&&this.resetInitDataOrTimer(),this.loopTableLoad()},handlerChange:function(e){var t=this,n=this.rememberRowNum.length;e.length==n&&e.forEach(function(e){var n=t.echart.datas.findIndex(function(t){return t.index==e.index}),i=t.$refs.echart.findIndex(function(t){return t.data.index==e.index}),a=t.echart.datas[n];5<a.series[0].data.length&&(a.series[0].data.shift(),a.xAxis.data.shift()),a.xAxis.data.push(e.d),a.series[0].data.push(e.v),t.$refs.echart[i].getEchart().setOption(a)})},handlerAllRowEvent:function(e){this.handlerRowEvent(e)},checkedHistoryArray:function(){var e=this.rememberRowNum.length,t=this.$refs.table&&this.$refs.table.table;setTimeout(function(){for(var n=0;n<e;n++){var i=this.currentTable[this.rememberRowNum[n]];t.toggleRowSelection(i,!0)}}.bind(this))},tableLoad:function(){var e=this,t=this,n={vehicleId:this.vehicleId};this.$store.dispatch("queryCanChart",n).then(function(n){var i=n.data;if(n.flag){if(""!=t.canTime&&t.canTime===i.canData[0].d)return!1;t.canTime=i.canData[0].d;var a=i.canData.map(function(t,n){var i=e.baseMess.find(function(e){return t.t==e.fid});return Object.assign({index:n},i,t)});e.currentTable=a,setTimeout(function(){this.checkedHistoryArray()}.bind(e))}})},loopTableLoad:function(){var e=this;this.tableLoad(),this.timer=setInterval(function(){e.tableLoad()},1e3*this.loopTimer)},resetInitDataOrTimer:function(){this.echart.datas=[],this.rememberRowNum=[],this.currentTable=[],clearInterval(this.timer),this.timer=null}},beforeMount:(i=Object(a.a)(regeneratorRuntime.mark(function e(){var t,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("queryCanType");case 2:t=e.sent,n=t.data,i=t.flag,this.baseMess=i?n:[];case 6:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),beforeDestroy:function(){this.resetInitDataOrTimer()}}),c=(n("bbdc"),n("2877")),o=Object(c.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"CANTable"},[n("cv-operation"),n("cv-publictree-content",{attrs:{model:"single","vehicle-monitor":e.canVehicleMonitor,loading:e.treeLoading}},[n("cv-grid",{ref:"table",staticClass:"tableArea",attrs:{data:e.currentTable},on:{select:e.handlerRowEvent,"selet-all":e.handlerAllRowEvent,"selection-change":e.handlerChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),n("el-table-column",{attrs:{label:"参数名称","header-align":"center",prop:"NAME"}}),n("el-table-column",{attrs:{label:"数值/状态","header-align":"center",prop:"v"}}),n("el-table-column",{attrs:{label:"单位","header-align":"center",prop:"unit"}})],1),n("div",{staticClass:"echartArea"},e._l(e.echart.datas,function(e){return n("li",{key:e.fid},[n("cv-echart",{ref:"echart",refInFor:!0,staticStyle:{height:"300px"},attrs:{data:e,name:"line"}})],1)}),0)],1)],1)},[],!1,null,"2ecde1c8",null).exports;t.default=o},"6e18":function(e,t,n){},bbdc:function(e,t,n){"use strict";var i=n("e71e");n.n(i).a},e71e:function(e,t,n){}}]);