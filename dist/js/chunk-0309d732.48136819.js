(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0309d732"],{"05c0":function(e,t,i){"use strict";i("7f7f"),i("20d6"),i("ac6a");var n=i("cebc"),a=i("3f4e"),r=i("2f62"),o={name:"CvPublictreeContent",components:{CvContent:a.a},props:{model:String,vehicleMonitor:Function,loading:Boolean,noresize:{default:!1,type:Boolean}},data:function(){return{entryList:[],condition:""}},computed:Object(n.a)({},Object(r.c)(["onlineList","isAttention","socketEnterprise","socketVehicle","vehicle_data","vehicleCondition"]),{isCheck:function(){switch(this.model){case"multi":return!0;case"single":default:return!1}},_treeMethods:function(){return this.$refs.tabs},_contentMethods:function(){return this.$refs.content}}),beforeDestroy:function(){var e=this._treeMethods.getAllNodes;this.setStoreVehicleSearchCondition(this.condition),this.setStoreVehicleData(e())},mounted:function(){var e=this._treeMethods.$refs.tree.reference().ztreeApi;e()&&e().checkAllNodes(!1)},methods:Object(n.a)({},Object(r.b)(["setStoreVehicleData","setStoreVehicleSearchCondition"]),{handlerVehicleSearch:function(e){this.condition=e},vehicle_Monitor:function(e){var t=e.data;if(e.name,"function"==typeof this.vehicleMonitor)switch(this.model){case"multi":return this.vehicle_Monitor_multi(e);case"single":return this.vehicleMonitor(t[0])}},vehicle_Monitor_multi:function(e){var t=this,i=e.data;switch(e.name){case"check":this.entryList=this.entryList.concat(i);break;case"cancel":i.forEach(function(e){var i=t.entryList.findIndex(function(t){return t.id==e.id});0<=i&&t.entryList.splice(i,1)})}this.vehicleMonitor(this.entryList)}})},s=(i("45d7"),i("2877")),c=Object(s.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cv-content",{ref:"content",attrs:{loading:e.loading,noresize:e.noresize}},[e.model?i("cv-tabs-tree",{ref:"tabs",staticClass:"vehiclemaster-tree",attrs:{slot:"aside","vehicle-search":e.vehicleCondition,"is-checked":e.isCheck,"tree-data":e.vehicle_data,"online-monitor":e.onlineList,"vehicle-monitor":e.socketVehicle,"attention-monitor":e.isAttention,"enterprise-fleet-monitor":e.socketEnterprise,"node-monitor":e.vehicle_Monitor},on:{"vehicle-choose-search":e.handlerVehicleSearch},slot:"aside"}):e._e(),e._t("default")],2)},[],!1,null,"2dfdf41b",null).exports;c.install=function(e){e.component(c.name,c)},t.a=c},"06af":function(e,t,i){"use strict";var n=i("77da");i.n(n).a},"0f40":function(e,t,i){"use strict";i.r(t),i("a481"),i("ac6a");var n=i("b0ad"),a={props:{timeRange:{},vehicleId:{},searchFlag:{type:[Boolean]}},mixins:[n.a],created:function(){for(var e=0;e<24;e++)e<=22&&this.timeLine.push({id:e,time:e<10?"0"+e:e}),23==e&&this.timeLine.push({id:e,time:[23,24]})},data:function(){return{carItems:[],runArray:{},tooltipContent:"",timeLine:[],dayArry:[],loading:!1}},methods:{workState:function(e){switch(e){case 0:return"working";case 1:return"run";case 2:return""}},splitTime:function(e,t){var i=this;return new Promise(function(n){e&&e.forEach(function(e){var i=e.startTime,n=new Date(i),a=new Date(Date.parse((t+" 00:00").replace(/-/g,"/"))),r=new Date(Date.parse((t+" 23:59").replace(/-/g,"/"))),o=(n.getTime()-a.getTime())/(r.getTime()-a.getTime())*100;o=o.toFixed(2),e.timeF=o}),i.runArray[t]=e||[],n({flag:!0})})},searchDetail:function(){this.loading=!0;this.$filter.timeStamp(this.timeRange[0]);this.$filter.timeStamp(this.timeRange[1]),this.moreDay(),this.$emit("update:searchFlag",!1)},moreDay:function(){var e=this;this.$store.dispatch("queryVehicleRunTimelineExp",{vehicleIds:this.vehicleId,startTime:this.timeRange[0],endTime:this.timeRange[1]}).then(function(t){e.dayArry=[],e.runArray=[];var i=[];t.data.forEach(function(t){i.push({time:t.date}),e.splitTime(t.dataArr,t.date)}),e.dayArry=i,e.loading=!1}).catch(function(t){e.loading=!1,e.$message.error({message:"服务异常"})})}},watch:{searchFlag:function(e){e&&this.searchDetail()}}},r=i("2877"),o={components:{vehicleRun:Object(r.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"min-height":"400px"}},[e._m(0),e._m(1),i("div",{staticClass:"outBox"},[i("ul",{staticClass:"timeLine"},e._l(e.timeLine,function(t){return i("li",{key:t.id,class:23==t.id?"last":""},[i("span",[e._v(e._s(23==t.id?t.time[0]:t.time))]),23==t.id?i("span",{staticClass:"l2"},[e._v(e._s(t.time[1]))]):e._e()])}),0),i("ul",{staticClass:"runState"},e._l(e.dayArry,function(t){return i("li",{key:t.id,staticClass:"runItem"},[i("span",{staticClass:"runDate"},[e._v(e._s(t.time))]),e._l(e.runArray[t.time],function(t){return i("i",{key:t.a,class:e.workState(t.type),style:{width:t.percent,left:t.timeF+"%"},on:{mouseenter:function(i){e.tooltipContent=e.mouseenterShowTip(i,"runtimeTip",t)},mouseleave:function(t){return e.mouseoverHideTip("runtimeTip")}}})})],2)}),0),i("el-tooltip",{ref:"runtimeTip",attrs:{content:e.tooltipContent,placement:"top",effect:"light"}})],1)])},[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"top"},[i("span",[e._v("车辆运行时间轴")]),i("span"),e._v(" 未运行 \n    "),i("span"),e._v(" 行驶中 \n    "),i("span"),e._v(" 作业中\n  ")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"c-left"},[t("span",{staticClass:"u-title"},[this._v("日期")])])}],!1,null,null,null).exports,CvPublictreeContent:i("05c0").a},data:function(){return{searchParams:{timeRange:[this.$filter.format(new Date-864e5,"yyyy-MM-dd"),this.$filter.format(new Date-864e5,"yyyy-MM-dd")]},pickerOption:{disabledDate:function(e){return e.getTime()>Date.now()-864e5}},vehicleId:"",searchDetail:!1}},methods:{search:function(){this.vehicleId?this.searchDetail=!0:this.$message.warning({message:"请选择车辆"})},handlerVehicleMonitor:function(e){this.vehicleId=e.id,this.searchDetail=!0}}},s=(i("06af"),Object(r.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vehicleSituation"},[i("cv-operation",{attrs:{position:"left"}},[i("el-form-item",{attrs:{label:"起止时间选择"}},[i("el-date-picker",{attrs:{clearable:!1,type:"daterange","range-separator":"至","picker-options":e.pickerOption,editable:!1,"value-format":"yyyy-MM-dd","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.searchParams.timeRange,callback:function(t){e.$set(e.searchParams,"timeRange",t)},expression:"searchParams.timeRange"}})],1),i("el-form-item",{staticStyle:{float:"right"}},[i("el-button",{on:{click:e.search}},[e._v("查询")])],1)],1),i("cv-publictree-content",{attrs:{model:"single","vehicle-monitor":e.handlerVehicleMonitor}},[i("vehicle-run",{attrs:{timeRange:e.searchParams.timeRange,vehicleId:e.vehicleId,searchFlag:e.searchDetail},on:{"update:searchFlag":function(t){e.searchDetail=t},"update:search-flag":function(t){e.searchDetail=t}}})],1)],1)},[],!1,null,null,null).exports);t.default=s},"45d7":function(e,t,i){"use strict";var n=i("6e18");i.n(n).a},"6e18":function(e,t,i){},"77da":function(e,t,i){},b0ad:function(e,t,i){"use strict";(function(e){i("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var i=this,n=e||this.$t("action.confirmIsRemove");return new Promise(function(e,a){i.$confirm(n,i.$t("action.tip"),{confirmButtonText:i.$t("action.confirm"),cancelButtonText:i.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,i){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=i||this.$message.error({message:this.$t("请选择时间范围在"+i+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,i){var n=e.length,a=t.length;return a<n?{name:"add",data:this.$service.isUnique(e,t,i)}:n<a?{name:"remove",data:this.$service.isUnique(t,e,i)}:n==a?{name:"equal",data:this.$service.isUnique(e,t,i)}:void 0},showTooltip:function(e,t){var i=e.target,n=this.$refs[t];n.referenceElm=i,n.$refs.popper.style.display="none",n.doDestroy(),n.setExpectedState(!0),n.handleShowPopper()},mouseenterShowTip:function(e,t,i){var n=e.target;if(n.scrollWidth>n.offsetWidth||i)return this.showTooltip(e,t),i?i.startTime+"~"+i.endTime:n.innerText},mouseenterShowToolTip:function(e,t,i){var n=e.target;return this.showTooltip(e,t),!i&&n.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,i){var n=this,a=0<arguments.length&&void 0!==t?t:"Baidu",r=1<arguments.length?i:void 0;return e[a]?e[a]._preloader?e[a]._preloader:Promise.resolve(e[a]):(e[a]={},e[a]._preloader=new Promise(function(t,i){var o=document.createElement("script");o.src=r,e.document.body.appendChild(o),n.$service.isIe()&&n.$service.IE_VERSION<11?o.onreadystatechange=function(){"loaded"!=o.readyState&&"complete"!=o.readyState||(t(e[a]),e[a]._preloader=null)}:o.onload=function(){t(e[a]),e[a]._preloader=null}}),e[a]._preloader)}}}}).call(this,i("c8ba"))}}]);