(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-8b9ca32a"],{"05c0":function(e,t,i){"use strict";i("7f7f"),i("20d6"),i("ac6a");var a=i("cebc"),n=i("3f4e"),o=i("2f62"),l={name:"CvPublictreeContent",components:{CvContent:n.a},props:{model:String,vehicleMonitor:Function,loading:Boolean,noresize:{default:!1,type:Boolean}},data:function(){return{entryList:[],condition:""}},computed:Object(a.a)({},Object(o.c)(["onlineList","isAttention","socketEnterprise","socketVehicle","vehicle_data","vehicleCondition"]),{isCheck:function(){switch(this.model){case"multi":return!0;case"single":default:return!1}},_treeMethods:function(){return this.$refs.tabs},_contentMethods:function(){return this.$refs.content}}),beforeDestroy:function(){var e=this._treeMethods.getAllNodes;this.setStoreVehicleSearchCondition(this.condition),this.setStoreVehicleData(e())},mounted:function(){var e=this._treeMethods.$refs.tree.reference().ztreeApi;e()&&e().checkAllNodes(!1)},methods:Object(a.a)({},Object(o.b)(["setStoreVehicleData","setStoreVehicleSearchCondition"]),{handlerVehicleSearch:function(e){this.condition=e},vehicle_Monitor:function(e){var t=e.data;if(e.name,"function"==typeof this.vehicleMonitor)switch(this.model){case"multi":return this.vehicle_Monitor_multi(e);case"single":return this.vehicleMonitor(t[0])}},vehicle_Monitor_multi:function(e){var t=this,i=e.data;switch(e.name){case"check":this.entryList=this.entryList.concat(i);break;case"cancel":i.forEach(function(e){var i=t.entryList.findIndex(function(t){return t.id==e.id});0<=i&&t.entryList.splice(i,1)})}this.vehicleMonitor(this.entryList)}})},r=(i("45d7"),i("2877")),s=Object(r.a)(l,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cv-content",{ref:"content",attrs:{loading:e.loading,noresize:e.noresize}},[e.model?i("cv-tabs-tree",{ref:"tabs",staticClass:"vehiclemaster-tree",attrs:{slot:"aside","vehicle-search":e.vehicleCondition,"is-checked":e.isCheck,"tree-data":e.vehicle_data,"online-monitor":e.onlineList,"vehicle-monitor":e.socketVehicle,"attention-monitor":e.isAttention,"enterprise-fleet-monitor":e.socketEnterprise,"node-monitor":e.vehicle_Monitor},on:{"vehicle-choose-search":e.handlerVehicleSearch},slot:"aside"}):e._e(),e._t("default")],2)},[],!1,null,"2dfdf41b",null).exports;s.install=function(e){e.component(s.name,s)},t.a=s},"1c7a":function(e,t,i){"use strict";i.r(t);var a={mixins:[],props:{options:{}},data:function(){return{submitFalg:!1,dialogFlag:!1,upload:{fileLen:"0",manufatureId:"1",terminalVersion:"1.0",appVersion:"1.0",dialPointName:"",timeLimit:"1",mehicleType:"",mehicleVersion:"",equipmentMode:"",protocol:""},tokens:{Accept:"application/json, text/plain",token:localStorage.getItem("token")},rules:{terminalVersion:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{pattern:/^\d[\d.]+\d$/,message:this.$t("filter.type6")}],appVersion:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{pattern:/^\d[\d\\.]+\d$/,message:this.$t("filter.type6")}],manufatureId:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{pattern:/^[0-9]+$/,message:this.$t("filter.type2")}],timeLimit:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{pattern:/^[0-9]+$/,message:this.$t("filter.type2")}]}}},methods:{save:function(){var e=this;e.$refs.uploadForm.validate(function(t){t&&(0!=e.upload.fileLen&&"0"!=e.upload.fileLen?(e.loading=!0,e.$refs.upload.submit()):e.$message.warning("请选择上传bin文件!"))})},successFile:function(e){e.flag?(this.loading=!1,this.$message.success(this.$t("action.addSuccess")),this.$emit("confirm")):(this.loading=!1,this.$message.error(this.$t("error."+e.errorCode))),this.options.flag=!1},errorFile:function(){this.loading=!1,this.$message.error(this.$t("action.addFail")),this.options.flag=!1},changeFile:function(e,t){this.upload.fileLen=t.length},init:function(){var e=this;this.$store.dispatch("queryTerminalParam",{vehicleId:this.options.vehicleId}).then(function(t){t.flag?(e.upload.equipmentMode=t.data.equipmentMode,e.upload.protocol=t.data.protocol):e.$message.error(e.$t("error."+t.errorCode))})}},watch:{"options.flag":function(e){e||(this.options.name="")}},mounted:function(){this.init()}},n=(i("c542"),i("2877")),o=Object(n.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogFlag,expression:"dialogFlag"}],staticClass:"remote-updata"},[i("el-form",{ref:"uploadForm",attrs:{inline:!0,"label-position":"right","label-width":"110px",model:e.upload,rules:e.rules}},[i("el-form-item",{attrs:{label:"上传新版本:"}},[i("el-upload",{ref:"upload",attrs:{action:e.$COMMON.baseUrl+"/upgradeLog/insertUploadBinFileInfo",data:e.upload,"auto-upload":!1,headers:e.tokens,"on-change":e.changeFile,"on-remove":e.changeFile,"on-success":e.successFile,"on-error":e.errorFile,accept:".bin"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),i("el-form-item",{attrs:{label:"制造商ID:",prop:"manufatureId"}},[i("el-input",{attrs:{size:"small",maxlength:12},model:{value:e.upload.manufatureId,callback:function(t){e.$set(e.upload,"manufatureId","string"==typeof t?t.trim():t)},expression:"upload.manufatureId"}})],1),i("el-form-item",{attrs:{label:"硬件版本:",prop:"terminalVersion"}},[i("el-input",{attrs:{size:"small",maxlength:12},model:{value:e.upload.terminalVersion,callback:function(t){e.$set(e.upload,"terminalVersion","string"==typeof t?t.trim():t)},expression:"upload.terminalVersion"}})],1),i("el-form-item",{attrs:{label:"固件版本:",prop:"appVersion"}},[i("el-input",{attrs:{size:"small",maxlength:7},model:{value:e.upload.appVersion,callback:function(t){e.$set(e.upload,"appVersion","string"==typeof t?t.trim():t)},expression:"upload.appVersion"}})],1),i("el-form-item",{attrs:{label:"拨号点名称:",prop:"dialPointName"}},[i("el-input",{attrs:{size:"small",maxlength:12},model:{value:e.upload.dialPointName,callback:function(t){e.$set(e.upload,"dialPointName","string"==typeof t?t.trim():t)},expression:"upload.dialPointName"}})],1),i("el-form-item",{attrs:{label:"超时阀值(分):",prop:"timeLimit"}},[i("el-input",{attrs:{size:"small",maxlength:12},model:{value:e.upload.timeLimit,callback:function(t){e.$set(e.upload,"timeLimit","string"==typeof t?t.trim():t)},expression:"upload.timeLimit"}})],1),i("el-form-item",{attrs:{label:"终端型号:"}},[i("label",{staticClass:"text"},[e._v(e._s(e.upload.equipmentMode))])]),i("el-form-item",{attrs:{label:"终端协议版本:"}},[i("label",{staticClass:"text"},[e._v(" "+e._s(e.upload.protocol))])])],1),i("div",{staticClass:"dialog-footer"},[i("el-button",{attrs:{type:"primary",loading:e.submitFalg},on:{click:e.save}},[e._v(e._s(e.$t("action.confirm")))]),i("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)},[],!1,null,null,null).exports,l=i("2959"),r=i("05c0"),s={components:{updata:o,setting:l.a,CvPublictreeContent:r.a},mixins:[],data:function(){return{upFlag:!0,content:{contentLoading:!1,data:[],selectItem:{}},grid:{vehicleId:""},searchFlag:!1,dialog:{title:"--",flag:!1,vehicleId:"",name:"updata",size:"dialog-full",id:"",enterpriseId:""}}},computed:{_table:function(){return this.$refs.remoteUpdata}},methods:{handlerVehicleMonitor:function(e){this.grid.vehicleId!=e.id&&(this.grid.vehicleId=e.id,this.dialog.vehicleId=e.id,this.dialog.enterpriseId=e.enterpriseId,this._table.tableInitial())},update:function(){this.dialog.flag=!0,this.dialog.title="上传",this.dialog.name="updata",this.dialog.size="dialog-large"},set:function(){this.dialog.flag=!0,this.dialog.title="升级",this.dialog.name="setting",this.dialog.size="dialog-middle"},upgradeType:function(e){return"1"==e.upgradeType?"平台主动":"终端主动"}},watch:{"grid.vehicleId":function(e){e&&(this.upFlag=!1)}}},c=(i("354b"),Object(n.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"terminal-params-set"},[i("cv-operation",[i("el-form-item",{staticStyle:{float:"right"}},[i("el-button",{attrs:{size:"small",disabled:e.upFlag},on:{click:e.update}},[e._v("上传")]),i("el-button",{attrs:{size:"small",disabled:e.upFlag},on:{click:e.set}},[e._v("升级")])],1)],1),i("cv-content",{staticStyle:{top:"50px"}},[i("cv-publictree-content",{ref:"tabs",attrs:{model:"single","vehicle-monitor":e.handlerVehicleMonitor,loading:e.content.contentLoading}},[i("cv-grid",{ref:"remoteUpdata",staticClass:"grid",attrs:{params:e.grid,url:"/upgradeLog/queryUpgradeLogInfo"}},[i("el-table-column",{attrs:{label:"固态版本",prop:"appVersion"}}),i("el-table-column",{attrs:{label:"硬件版本",prop:"terminalVersion"}}),i("el-table-column",{attrs:{label:"升级版本名称",prop:"binName"}}),i("el-table-column",{attrs:{label:"升级方式",prop:"upgradeType",formatter:e.upgradeType}}),i("el-table-column",{attrs:{label:"升级时间",prop:"upgradeDate"}})],1)],1)],1),i("el-dialog",{attrs:{visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[i(e.dialog.name,{tag:"component",attrs:{options:e.dialog},on:{confirm:e.confirm}})],1)],1)},[],!1,null,"1944aa38",null).exports);t.default=c},"354b":function(e,t,i){"use strict";var a=i("58fd");i.n(a).a},"3cf4":function(e,t,i){},"45d7":function(e,t,i){"use strict";var a=i("6e18");i.n(a).a},"58fd":function(e,t,i){},"6e18":function(e,t,i){},c542:function(e,t,i){"use strict";var a=i("3cf4");i.n(a).a}}]);