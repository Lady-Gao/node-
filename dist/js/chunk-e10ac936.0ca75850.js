(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e10ac936"],{"05c0":function(t,e,i){"use strict";i("7f7f"),i("20d6"),i("ac6a");var n=i("cebc"),a=i("3f4e"),o=i("2f62"),s={name:"CvPublictreeContent",components:{CvContent:a.a},props:{model:String,vehicleMonitor:Function,loading:Boolean,noresize:{default:!1,type:Boolean}},data:function(){return{entryList:[],condition:""}},computed:Object(n.a)({},Object(o.c)(["onlineList","isAttention","socketEnterprise","socketVehicle","vehicle_data","vehicleCondition"]),{isCheck:function(){switch(this.model){case"multi":return!0;case"single":default:return!1}},_treeMethods:function(){return this.$refs.tabs},_contentMethods:function(){return this.$refs.content}}),beforeDestroy:function(){var t=this._treeMethods.getAllNodes;this.setStoreVehicleSearchCondition(this.condition),this.setStoreVehicleData(t())},mounted:function(){var t=this._treeMethods.$refs.tree.reference().ztreeApi;t()&&t().checkAllNodes(!1)},methods:Object(n.a)({},Object(o.b)(["setStoreVehicleData","setStoreVehicleSearchCondition"]),{handlerVehicleSearch:function(t){this.condition=t},vehicle_Monitor:function(t){var e=t.data;if(t.name,"function"==typeof this.vehicleMonitor)switch(this.model){case"multi":return this.vehicle_Monitor_multi(t);case"single":return this.vehicleMonitor(e[0])}},vehicle_Monitor_multi:function(t){var e=this,i=t.data;switch(t.name){case"check":this.entryList=this.entryList.concat(i);break;case"cancel":i.forEach(function(t){var i=e.entryList.findIndex(function(e){return e.id==t.id});0<=i&&e.entryList.splice(i,1)})}this.vehicleMonitor(this.entryList)}})},r=(i("45d7"),i("2877")),c=Object(r.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("cv-content",{ref:"content",attrs:{loading:t.loading,noresize:t.noresize}},[t.model?i("cv-tabs-tree",{ref:"tabs",staticClass:"vehiclemaster-tree",attrs:{slot:"aside","vehicle-search":t.vehicleCondition,"is-checked":t.isCheck,"tree-data":t.vehicle_data,"online-monitor":t.onlineList,"vehicle-monitor":t.socketVehicle,"attention-monitor":t.isAttention,"enterprise-fleet-monitor":t.socketEnterprise,"node-monitor":t.vehicle_Monitor},on:{"vehicle-choose-search":t.handlerVehicleSearch},slot:"aside"}):t._e(),t._t("default")],2)},[],!1,null,"2dfdf41b",null).exports;c.install=function(t){t.component(c.name,c)},e.a=c},"34cb":function(t,e,i){"use strict";i.r(e),i("7f7f"),i("c5f6"),i("ac6a");var n={components:{CvPublictreeContent:i("05c0").a},data:function(){return{pickerOptions0:{disabledDate:function(t){return t.getTime()>Date.now()}},time:[this.$filter.timeStamp(this.$filter.format(new Date,"yyyy-MM-dd start")),this.$filter.timeStamp(this.$filter.format(new Date,"yyyy-MM-dd HH:mm:ss"))],vehicleId:"",plateCode:"",addPoint:null,table:[],infoTable:[]}},computed:{_mapMethods:function(){return this.$refs.infoMap}},methods:{search:function(){var t=this,e=this.getData();this.clearMap(),this.infoTable=[],this.table=[],e&&(this.getTrackPoint(e),this.$store.dispatch("queryHourData",e).then(function(e){e.flag?(t.table=e.data,208==e.errorCode&&t.$message.warning("无数据")):t.table=[],t.loading=!1}))},getData:function(){return""==this.vehicleId?(this.$message.warning("请选择车辆"),!1):this.time?{startTime:this.$filter.format(this.time[0],"yyyy-MM-dd HH:mm:ss"),endTime:this.$filter.format(this.time[1],"yyyy-MM-dd HH:mm:ss"),vehicleId:this.vehicleId}:(this.$message.warning("请选择时间"),!1)},getTrackPoint:function(t){var e=this,i=t;i.mapType=this.$store.getters.mapType,this.$store.dispatch("queryVehicleTrack",i).then(function(t){t.flag&&e.$service.isArray(t.data)&&0<t.data.length&&e.mapAddLine(t.data)})},mapAddLine:function(t){var e=[];t.forEach(function(t){"无效"!=t.longitude&&e.push({lng:t.mapLongitude,lat:t.mapLatitude})}),this.allLineOne=this._mapMethods.mapMethods.mapAddline(e,{strokeWeight:3})},mapAddPoint:function(t){var e=this;if("无效"==t.latitude&&"无效"==t.longitude)return!1;var i={plateCode:this.plateCode,vehicleStatus:1,locationDesc:t.locationDesc};this.addPoint&&this._mapMethods.mapMethods.removeOverlay(this.addPoint),this.addPoint=this._mapMethods.mapMethods.mapAddpoint({longitude:Number(t.longitude),latitude:Number(t.latitude)},this.$filter.isOnline(i,!1,this.$store.getters.mapName),{width:36,height:36}),this._mapMethods.mapMethods.addOverlay(this.addPoint),this._mapMethods.mapMethods.addEventListener(this.addPoint,"click",function(){e.openInfo(t,e.addPoint)}),this.openInfo(t,this.addPoint)},openInfo:function(t,e){var i="<div><div><span style='color: #333;font-weight: bold;'>车牌号码:</span>".concat(this.plateCode,"</div>")+"<div><span class='titleName'>所属公司:</span>".concat(t.enterpriseName,"</span></div>")+"<div><span><span class='titleName'>时间:</span>".concat(t.number,"分</span></div>")+"<div><span ><span class='titleName'>海拔:</span>".concat(t.elevation,"(m)</span></div>")+"<div><span class='titleName'>位置信息:</span><span>".concat(t.address," </span></div></div>");this.infoMarker=this._mapMethods.mapMethods.infoWindow(i,e),this._mapMethods.mapMethods.cvOpenInfoWindow(this.infoMarker,e.point)},changeTime:function(t){var e=this;t&&(this.addPoint&&(this._mapMethods.mapMethods.closeInfoWindow(this.infoMarker),this._mapMethods.mapMethods.removeOverlay(this.addPoint)),this.$store.dispatch("queryHourDataDetail",{id:t.id,mapType:this.$store.getters.mapType}).then(function(t){t.flag?e.infoTable=t.data:e.infoTable=[]}))},clearMap:function(){this.table=[],this.infoTable=[],this._mapMethods.mapMethods.clearOverlays()},handlerVehicleMonitor:function(t){this.vehicleId=t.id,this.plateCode=t.plateCode}}},a=(i("5516"),i("2877")),o=Object(a.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"location"},[i("cv-operation",{staticClass:"header",attrs:{position:"left"}},[i("el-form-item",{attrs:{label:"起始时间:"}},[i("el-date-picker",{staticClass:"picker",attrs:{"picker-options":t.pickerOptions0,clearable:!1,editable:!1,type:"datetimerange",placeholder:"选择时间范围",prop:"time"},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1),i("el-form-item",{staticStyle:{float:"right"}},[i("cv-tool",{staticClass:"cv-tool",staticStyle:{margin:"0"},attrs:{name:t.$route.name,data:t.$store.getters.monitorMenu,"is-export":!1,"is-remove":!1,"is-add":!1,"is-modify":!1},on:{search:t.search}})],1)],1),i("cv-publictree-content",{attrs:{model:"single","vehicle-monitor":t.handlerVehicleMonitor}},[i(t.$store.getters.mapName,{ref:"infoMap",tag:"component",staticClass:"locationMap",attrs:{id:"locationInfo"}}),i("cv-grid",{staticClass:"timeList",attrs:{data:t.table},on:{"row-click":t.changeTime}},[i("el-table-column",{attrs:{label:"选择时间 ","min-width":"150",align:"center",prop:"time"}})],1),i("cv-grid",{staticClass:"locationInfoList",attrs:{data:t.infoTable},on:{"row-click":t.mapAddPoint}},[i("el-table-column",{attrs:{label:"时间","min-width":"150",align:"center",prop:"number"}}),i("el-table-column",{attrs:{label:"速度(km/h)","min-width":"150",align:"center",prop:"speed"}}),i("el-table-column",{attrs:{label:"经度","min-width":"150",align:"center",prop:"longitude"}}),i("el-table-column",{attrs:{label:"纬度","min-width":"150",align:"center",prop:"latitude"}}),i("el-table-column",{attrs:{label:"海拔(m)","min-width":"150",align:"center",prop:"elevation"}})],1)],1)],1)},[],!1,null,null,null).exports;o.install=function(t){t.component(o.name,o)},e.default=o},"45d7":function(t,e,i){"use strict";var n=i("6e18");i.n(n).a},5516:function(t,e,i){"use strict";var n=i("ae7f");i.n(n).a},"6e18":function(t,e,i){},ae7f:function(t,e,i){}}]);