(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-14a7ac76"],{b0ad:function(e,t,a){"use strict";(function(e){a("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var a=this,r=e||this.$t("action.confirmIsRemove");return new Promise(function(e,i){a.$confirm(r,a.$t("action.tip"),{confirmButtonText:a.$t("action.confirm"),cancelButtonText:a.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,a){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=a||this.$message.error({message:this.$t("请选择时间范围在"+a+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,a){var r=e.length,i=t.length;return i<r?{name:"add",data:this.$service.isUnique(e,t,a)}:r<i?{name:"remove",data:this.$service.isUnique(t,e,a)}:r==i?{name:"equal",data:this.$service.isUnique(e,t,a)}:void 0},showTooltip:function(e,t){var a=e.target,r=this.$refs[t];r.referenceElm=a,r.$refs.popper.style.display="none",r.doDestroy(),r.setExpectedState(!0),r.handleShowPopper()},mouseenterShowTip:function(e,t,a){var r=e.target;if(r.scrollWidth>r.offsetWidth||a)return this.showTooltip(e,t),a?a.startTime+"~"+a.endTime:r.innerText},mouseenterShowToolTip:function(e,t,a){var r=e.target;return this.showTooltip(e,t),!a&&r.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,a){var r=this,i=0<arguments.length&&void 0!==t?t:"Baidu",o=1<arguments.length?a:void 0;return e[i]?e[i]._preloader?e[i]._preloader:Promise.resolve(e[i]):(e[i]={},e[i]._preloader=new Promise(function(t,a){var n=document.createElement("script");n.src=o,e.document.body.appendChild(n),r.$service.isIe()&&r.$service.IE_VERSION<11?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(t(e[i]),e[i]._preloader=null)}:n.onload=function(){t(e[i]),e[i]._preloader=null}}),e[i]._preloader)}}}}).call(this,a("c8ba"))},c218:function(e,t,a){"use strict";var r=a("e10f");a.n(r).a},e10f:function(e,t,a){},fb34:function(e,t,a){"use strict";a.r(t),a("96cf");var r=a("3b8d"),i=a("cebc"),o=(a("28a5"),a("2f62")),n={props:{options:{}},data:function(){return{isModify:!1,alarmList:[],orderList:[],addParams:{enterpriseName:"",enterpriseId:"",alarmId:"",orderIds:[]},rules:{enterpriseId:[{required:!0,message:"请选择公司",trigger:"blur,change"}],alarmId:[{required:!0,message:"请选择报警类型",trigger:"blur,change"}],orderIds:[{required:!0,message:"请选择指令",trigger:"blur,change"}]}}},created:function(){var e=this;this.getAlarmTypeLinkageList().then(function(t){t.flag&&(e.alarmList=t.data)}),this.getOrderConfigAutoLinkage().then(function(t){t.flag&&(e.orderList=t.data)}),this.options.edit&&(this.getAlarmAutoLinkageById({fid:this.options.id}).then(function(t){e.$service.mapParams(e.addParams,t.data),e.addParams.orderIds=t.data.orderId.split(",")}),this.isModify=!0)},methods:Object(i.a)({},Object(o.b)(["getAlarmTypeLinkageList","getOrderConfigAutoLinkage","getAlarmAutoLinkage","insertAlarmAutoLinkage","getAlarmAutoLinkageById"]),{cancelDialog:function(){this.$emit("update:visible",!1)},confirm:function(){var e=this,t={enterpriseId:this.addParams.enterpriseId,alarmId:this.addParams.alarmId,orderIds:this.addParams.orderIds.join(",")};this.options.edit&&(t.fid=this.options.id),this.$refs.commandConfig.validate(function(a){if(!a)return!1;e.insertAlarmAutoLinkage(t).then(function(t){t.flag?(e.$emit("update:visible",!1),e.$emit("update:refresh",!0),e.$message.success({message:e.options.edit?"修改成功":"新增成功"})):(e.$emit("update:visible",!1),e.$message.error({message:e.$t("error."+t.errorCode)}))})})}})},s=a("2877"),l={name:"command",components:{commandAddmodify:Object(s.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"commandConfig",attrs:{model:e.addParams,rules:e.rules}},[a("el-form-item",{attrs:{"label-position":"top",label:"公司选择",prop:"enterpriseId"}},[a("cv-dropdown-tree",{staticStyle:{width:"100%"},attrs:{disabled:e.isModify,url:"/enterprise/getEnterpriseTreeList","is-default":!1},model:{value:e.addParams.enterpriseId,callback:function(t){e.$set(e.addParams,"enterpriseId",t)},expression:"addParams.enterpriseId"}})],1),a("el-form-item",{attrs:{"label-position":"top",label:"报警选择",prop:"alarmId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择报警类型",disabled:e.isModify},model:{value:e.addParams.alarmId,callback:function(t){e.$set(e.addParams,"alarmId",t)},expression:"addParams.alarmId"}},e._l(e.alarmList,function(e){return a("el-option",{key:e.id,attrs:{label:e.alarmName,value:e.alarmId}})}),1)],1),a("el-form-item",{attrs:{"label-position":"top",label:"指令选择",prop:"orderIds"}},[a("el-checkbox-group",{staticStyle:{width:"100%"},model:{value:e.addParams.orderIds,callback:function(t){e.$set(e.addParams,"orderIds",t)},expression:"addParams.orderIds"}},e._l(e.orderList,function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.orderName))])}),1)],1),a("el-form-item",{staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")]),a("el-button",{on:{click:e.cancelDialog}},[e._v("取消")])],1)],1)},[],!1,null,null,null).exports},mixins:[a("b0ad").a],computed:{_table:function(){return this.$refs.commandTable}},data:function(){return{common:{enterpriseId:"",enterpriseName:""},dialog:{flag:!1,size:"dialog-tiny",options:{}},refresh:!1,searchPs:{},searchP:{},outPutParams:{}}},methods:Object(i.a)({},Object(o.b)(["deleteAlarmAutoLinkage"]),{add:function(){this.dialog.title="添加",this.dialog.name="commandAddmodify",this.dialog.options={},this.dialog.flag=!0},search:function(){this._table.tableInitial()},del:function(e){var t=this;this.confirmPrompt().then(function(){Object(r.a)(regeneratorRuntime.mark(function a(){var r,i,o;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.deleteAlarmAutoLinkage({fId:e.id});case 2:r=a.sent,i=r.flag,o=r.errorCode,i?(t.$message.success({message:"删除成功"}),t._table.tableInitial(!0)):t.$message.error({message:t.$t("error."+o)});case 6:case"end":return a.stop()}},a)}))()})},edit:function(e){this.dialog.title="修改",this.dialog.name="commandAddmodify",this.dialog.options=e,this.dialog.options.edit=!0,this.dialog.flag=!0},outPut:function(){var e=this.$service.winParams(this.$COMMON.baseUrl+"/vehiclePeccancy/exportVehiclePeccancyInfo",this.outPutParams);window.location.href=e}}),watch:{"dialog.flag":function(e){e||(this.dialog.name="")},refresh:function(e){e&&(this._table.tableInitial(),this.refresh=!1)},searchP:function(e){this.outPutParams=e}}},d=(a("c218"),Object(s.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"commandConfig"},[a("cv-operation",[a("el-form-item",[a("cv-dropdown-tree",{attrs:{url:"/enterprise/getEnterpriseTreeList",placeholder:"请选择公司搜索"},model:{value:e.common.enterpriseId,callback:function(t){e.$set(e.common,"enterpriseId",t)},expression:"common.enterpriseId"}})],1),a("el-form-item",[a("cv-tool",{staticClass:"cv-tool",attrs:{name:e.$route.name,data:e.$store.getters.manageMenus,"is-remove":!1,"is-export":!1,"is-modify":!1},on:{add:e.add,search:e.search}})],1)],1),a("cv-content",[a("cv-grid",{ref:"commandTable",attrs:{params:{enterpriseId:e.common.enterpriseId},url:"/videoController/getAlarmAutoLinkage"}},[a("el-table-column",{attrs:{label:e.$t("所属公司"),prop:"enterpriseName"}}),a("el-table-column",{attrs:{label:e.$t("报警类型"),prop:"alarmName"}}),a("el-table-column",{attrs:{label:e.$t("关联指令"),prop:"orderNames"}}),a("el-table-column",{attrs:{label:e.$t("action.operation"),prop:"operate"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cv-table-tool",{attrs:{name:e.$route.name,data:e.$store.getters.manageMenus},on:{modify:function(a){return e.edit(t.row)},remove:function(a){return e.del(t.row)}}})]}}])})],1)],1),a("el-dialog",{attrs:{visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[a(e.dialog.name,{tag:"component",attrs:{options:e.dialog.options,visible:e.dialog.flag,refresh:e.refresh,searchTable:e.searchPs},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)},"update:refresh":function(t){e.refresh=t},"update:searchTable":function(t){e.searchPs=t},"update:search-table":function(t){e.searchPs=t}}})],1)],1)},[],!1,null,null,null).exports);t.default=d}}]);