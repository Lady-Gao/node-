(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-295d0fb6"],{"04a0":function(e,t,r){"use strict";var o=r("4c09");r.n(o).a},"23d7":function(e,t,r){},"405b":function(e,t,r){},"4c09":function(e,t,r){},"75a7":function(e,t,r){"use strict";var o=r("d4bc");r.n(o).a},"8c69":function(e,t,r){"use strict";var o=r("23d7");r.n(o).a},b0ad:function(e,t,r){"use strict";(function(e){r("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var r=this,o=e||this.$t("action.confirmIsRemove");return new Promise(function(e,i){r.$confirm(o,r.$t("action.tip"),{confirmButtonText:r.$t("action.confirm"),cancelButtonText:r.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,r){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=r||this.$message.error({message:this.$t("请选择时间范围在"+r+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,r){var o=e.length,i=t.length;return i<o?{name:"add",data:this.$service.isUnique(e,t,r)}:o<i?{name:"remove",data:this.$service.isUnique(t,e,r)}:o==i?{name:"equal",data:this.$service.isUnique(e,t,r)}:void 0},showTooltip:function(e,t){var r=e.target,o=this.$refs[t];o.referenceElm=r,o.$refs.popper.style.display="none",o.doDestroy(),o.setExpectedState(!0),o.handleShowPopper()},mouseenterShowTip:function(e,t,r){var o=e.target;if(o.scrollWidth>o.offsetWidth||r)return this.showTooltip(e,t),r?r.startTime+"~"+r.endTime:o.innerText},mouseenterShowToolTip:function(e,t,r){var o=e.target;return this.showTooltip(e,t),!r&&o.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,r){var o=this,i=0<arguments.length&&void 0!==t?t:"Baidu",a=1<arguments.length?r:void 0;return e[i]?e[i]._preloader?e[i]._preloader:Promise.resolve(e[i]):(e[i]={},e[i]._preloader=new Promise(function(t,r){var l=document.createElement("script");l.src=a,e.document.body.appendChild(l),o.$service.isIe()&&o.$service.IE_VERSION<11?l.onreadystatechange=function(){"loaded"!=l.readyState&&"complete"!=l.readyState||(t(e[i]),e[i]._preloader=null)}:l.onload=function(){t(e[i]),e[i]._preloader=null}}),e[i]._preloader)}}}}).call(this,r("c8ba"))},b504:function(e,t,r){"use strict";var o=r("405b");r.n(o).a},cc16:function(e,t,r){"use strict";r.r(t),r("7f7f"),r("ac6a"),r("386d"),r("96cf");var o,i=r("3b8d"),a={props:{data:{},options:{}},data:function(){return{form:{},forbid:"",fatigueDrive:"",toversSpeed:"",overSpeed:"",overSpeedH:"",toverSpeedH:""}},inject:["store"],methods:{cancel:function(){this.data.btnClick=!1,this.data.active=1},getParams:function(){return{forbid:this.forbid,fatigueDrive:this.fatigueDrive,tOversSpeed:this.toversSpeed,overSpeed:this.overSpeed,overSpeedH:this.overSpeedH,tOverSpeedH:this.toverSpeedH,recordTime:this.$filter.format((new Date).getTime(),"yyyy-MM-dd HH:mm:ss"),enterpriseId:this.data.enterpriseId,vehicleIds:this.data.vehicleIds}},confirm:function(e){var t=this,r=this.getParams();this.$store.dispatch("insertPlatFormConfig",r).then(function(e){!e.flag&&e.errorCode?t.$message.error({message:t.$t("error."+e.errorCode)}):(t.store.dialog.flag=!1,t.store.alarmConList(!0),t.$message.success(t.$t("action.addSuccess")))})}}},l=(r("75a7"),r("2877")),s=Object(l.a)(a,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bindSecond"},[r("el-row",{attrs:{gutter:20}},[r("el-form",{ref:"bindT",attrs:{"label-position":"top",model:e.form}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"疲劳驾驶报警",prop:"title"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.fatigueDrive,callback:function(t){e.fatigueDrive=t},expression:"fatigueDrive"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"禁行报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.forbid,callback:function(t){e.forbid=t},expression:"forbid"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"超速报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.overSpeed,callback:function(t){e.overSpeed=t},expression:"overSpeed"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"高速公路超速报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.overSpeedH,callback:function(t){e.overSpeedH=t},expression:"overSpeedH"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"三分钟超速报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.toversSpeed,callback:function(t){e.toversSpeed=t},expression:"toversSpeed"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"三分钟高速公路超速报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.toverSpeedH,callback:function(t){e.toverSpeedH=t},expression:"toverSpeedH"}})],1)],1)],1),r("el-col",{staticClass:"dialog-footer",attrs:{span:24}},[r("el-button",{staticClass:"confirm",attrs:{type:"primary"},on:{click:function(t){return e.cancel()}}},[e._v("上一步")]),r("el-button",{on:{click:function(t){return e.confirm()}}},[e._v(e._s("确认"))])],1)],1)],1)},[],!1,null,null,null).exports,n={components:{bindSecond:s},computed:{_table:function(){return this.$refs.addTable}},props:{options:{},flagPage:{type:Boolean,default:!1}},data:function(){return{label:"",allFleets:[],multipleSelection:[],carCode:[],enterpriseName:"",fleetListT:"",fleetName:"",enterpriseId:"",table:[],fleetCheckID:[],fleetIds:[],next:!1,search:{enterpriseId:""},dialog:{flag:!1,active:1,vehicleIds:"",name:"",size:"dialog-tiny",btnClick:!1,enterpriseId:""},fleetParams:{enterpriseId:"",pId:"",type:""},loading:!1}},methods:{fleetLoad:(o=Object(i.a)(regeneratorRuntime.mark(function e(){var t,r,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("queryVehicleByFleetIdforPage",{fleetIds:this.fleetListT});case 2:t=e.sent,r=t.data,o=t.flag,this.table=o?r&&r.records:[];case 6:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),handleSelectionChange:function(e){this.multipleSelection=e},vehicleIdCall:function(e){"empty"!=e.id?this.fleetListT=e.id:this.fleetListT=""},nextStep:function(){0==this.multipleSelection.length?this.$message.warning("请选择车辆再进行下一步操作"):3<this.dialog.active++?this.dialog.active=1:this.dialog.btnClick=!0},closed:function(){this.options.flag=!1}},watch:{"options.flag":function(e){(this.dialog.flag=e)||(this.options.name="")},"search.enterpriseId":function(e){this.fleetName="",e&&(this.search.enterpriseId=e,this._table.tableInitial())},fleetListT:function(e){null!=e?this.fleetLoad():this._table.tableInitial()},multipleSelection:function(e){var t=this;this.carCode=[],e.forEach(function(e){t.carCode.push(e.id)}),this.dialog.vehicleIds=this.carCode.join(",")}}},c=(r("b504"),Object(l.a)(n,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"loaclNext1"},[r("el-steps",{attrs:{active:e.dialog.active,"align-center":""}},[r("el-step",{attrs:{title:"步骤 1"}}),r("el-step",{attrs:{title:"步骤 2"}})],1),r("el-form",{directives:[{name:"show",rawName:"v-show",value:!e.dialog.btnClick,expression:"!dialog.btnClick"}],ref:"form",staticStyle:{padding:"40px"},attrs:{model:e.dialog.form,"label-width":"120px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"所属公司/机构",prop:"enterpriseName"}},[r("cv-dropdown-tree",{ref:"enterpriseNameValue",staticStyle:{width:"300px"},attrs:{url:"/enterprise/findEnterpriseOrganizationTreeList",label:e.label,placeholder:e.$t("role.company"),"is-default":!1},on:{"update:label":function(t){e.label=t}},model:{value:e.search.enterpriseId,callback:function(t){e.$set(e.search,"enterpriseId",t)},expression:"search.enterpriseId"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"所属车组:"}},[r("cv-dropdown-tree",{attrs:{url:"/enterprise/findFleetTreeList","is-inital":!1,"auto-params":{enterpriseId:e.label.enterpriseId,pId:e.label.id,type:e.label.type},label:e.vehicleIdCall},on:{"update:label":function(t){e.vehicleIdCall=t}},model:{value:e.fleetListT,callback:function(t){e.fleetListT=t},expression:"fleetListT"}})],1)],1),r("el-col",{attrs:{span:24}},[r("cv-grid",{ref:"addTable",staticClass:"table",attrs:{params:e.search,url:"/vehicle/findVehiclePage","default-height":300,data:e.table},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{label:"车牌号码",prop:"plateCode"}}),r("el-table-column",{attrs:{label:"车组",prop:"fleetName"}}),r("el-table-column",{attrs:{label:"SIM卡号",prop:"mobileCode"}})],1)],1)],1),r("el-form-item",{staticClass:" footer1 text1"},[r("el-button",{staticClass:"confirm1",attrs:{type:"primary"},on:{click:function(t){return e.closed()}}},[e._v("取消")]),r("el-button",{staticClass:"cancel2",attrs:{type:"primary",loading:e.loading},on:{click:e.nextStep}},[e._v("下一步")])],1)],1),r("div",{directives:[{name:"show",rawName:"v-show",value:e.dialog.btnClick,expression:"dialog.btnClick"}],staticStyle:{"margin-top":"40px","margin-left":"70px"}},[r("bind-second",{attrs:{data:e.dialog}})],1)],1)},[],!1,null,null,null).exports),d={props:{options:{}},data:function(){return{loading:!1,forbid:"0",fatigueDrive:"0",toversSpeed:"0",overSpeed:"0",overSpeedH:"0",toverSpeedH:"0"}},methods:{modifyParams:function(){return{forbid:this.forbid,fatigueDrive:this.fatigueDrive,tOversSpeed:this.toversSpeed,overSpeed:this.overSpeed,overSpeedH:this.overSpeedH,tOverSpeedH:this.toverSpeedH,recordTime:this.$filter.format((new Date).getTime(),"yyyy-MM-dd HH:mm:ss"),enterpriseId:this.options.modify.enterpriseId,vehicleIds:this.options.modify.vehicleIds}},confirm:function(e){var t=this,r=this.modifyParams();this.$store.dispatch("insertPlatFormConfig",r).then(function(e){!e.flag&&e.errorCode?t.$message.error({message:t.$t("error."+e.errorCode)}):(t.options.flag=!1,t.$emit("confirm"),t.$message.success(t.$t("action.modifySuccess")),t.loading=!1)})}},mounted:function(){this.forbid=this.options.modify.forbid,this.fatigueDrive=this.options.modify.fatigueDrive,this.toversSpeed=this.options.modify.toversSpeed,this.overSpeed=this.options.modify.overSpeed,this.overSpeedH=this.options.modify.overSpeedH,this.toverSpeedH=this.options.modify.toverSpeedH},watch:{"options.flag":function(e){e||(this.options.name="")}}},f=(r("8c69"),Object(l.a)(d,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"alarmfig"},[r("el-row",{attrs:{gutter:20}},[r("el-form",{attrs:{"label-position":"top",model:e.options.modify}},[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"疲劳驾驶报警",prop:"title"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.fatigueDrive,callback:function(t){e.fatigueDrive=t},expression:"fatigueDrive"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"禁行报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.forbid,callback:function(t){e.forbid=t},expression:"forbid"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"超速报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.overSpeed,callback:function(t){e.overSpeed=t},expression:"overSpeed"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"高速公路超速报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.overSpeedH,callback:function(t){e.overSpeedH=t},expression:"overSpeedH"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"三分钟超速报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.toversSpeed,callback:function(t){e.toversSpeed=t},expression:"toversSpeed"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"三分钟高速公路超速报警",prop:"href"}},[r("el-switch",{attrs:{"on-color":"#13ce66","off-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.toverSpeedH,callback:function(t){e.toverSpeedH=t},expression:"toverSpeedH"}})],1)],1)],1),r("el-col",{staticClass:"dialog-footer",attrs:{span:24}},[r("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("action.confirm")))]),r("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)],1)},[],!1,null,null,null).exports),p=r("b0ad"),u={components:{modify:f,add:c,bindSecond:s},provide:function(){return{store:this}},computed:{_table:function(){return this.$refs.alarmTable}},props:{options:{},api:{default:"/platFormAlarm/queryPaltFormConfigByPage"},flagPage:{type:Boolean,default:!1}},mixins:[p.a],data:function(){return{label:"",vehicleIds:"",multiple:[],carIds:[],id:"",search:{fleetIds:"",enterpriseId:""},dialog:{childTreeData:[],title:"--",flag:!1,name:"add",size:"dialog-full",id:"",modify:{vehicleIds:"",forbid:"",fatigueDrive:"",toversSpeed:"",overSpeed:"",overSpeedH:"",toverSpeedH:"",enterpriseId:""}}}},methods:{alarmConList:function(){this._table.tableInitial()},plateCodeAndColor:function(e){return e.plateCode+"("+this.$filter.plateCodeColor(e.plateColor)+")"},driverStuas:function(e){return this.$filter.alarmStatus(e.fatigueDrive)},overStuas:function(e){return this.$filter.alarmStatus(e.tOversSpeed)},overHStuas:function(e){return this.$filter.alarmStatus(e.tOverSpeedH)},filterAlStuas:function(e){return this.$filter.alarmStatus(e.overSpeed)},filteralarmStuas:function(e){return this.$filter.alarmStatus(e.overSpeedH)},filterLStuas:function(e){return this.$filter.alarmStatus(e.forbid)},addContent:function(e){this.dialog.flag=!0,this.dialog.size="dialog-large",this.dialog.name="add",this.dialog.title="报警配置新增"},modify:function(e){this.dialog.flag=!0,this.dialog.modify.vehicleIds=e.row.vehicleId,this.dialog.modify.enterpriseId=e.row.enterpriseId,this.dialog.modify.fatigueDrive=e.row.fatigueDrive,this.dialog.modify.toversSpeed=e.row.tOversSpeed,this.dialog.modify.toverSpeedH=e.row.tOverSpeedH,this.dialog.modify.forbid=e.row.forbid,this.dialog.modify.overSpeed=e.row.overSpeed,this.dialog.modify.overSpeedH=e.row.overSpeedH,this.dialog.title=this.$t("power.modify"),this.dialog.name="modify",this.dialog.size="dialog-small"},removeCar:function(e){var t=this;this.confirmPrompt().then(function(){t.$store.dispatch("delPlatFormConfig",{vehicleIds:e.row.vehicleId}).then(function(e){e.flag?(t.alarmConList(!0),t.$message.success("删除成功")):t.$message.error(t.$t("error."+e.errorCode))})})},remove:function(){var e=this;0==this.carIds.length?this.$message.warning("请选择删除项"):this.confirmPrompt().then(function(){e.$store.dispatch("delPlatFormConfig",{vehicleIds:e.vehicleIds}).then(function(t){t.flag?(e.alarmConList(),e.$message.success("删除成功")):e.$message.error(e.$t("error."+t.errorCode))})})},handleSelectionChange:function(e){this.multiple=e}},watch:{multiple:function(e){var t=this;this.carIds=[],e.forEach(function(e){t.carIds.push(e.vehicleId)}),this.vehicleIds=this.carIds.join(",")}}},m=(r("04a0"),Object(l.a)(u,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"vehicleType"},[r("cv-operation",{attrs:{position:"left"}},[r("el-form-item",{attrs:{label:"所属公司/机构",prop:"enterpriseId"}},[r("cv-dropdown-tree",{attrs:{placeholder:e.$t("common.enterprise.enterpriseName"),url:"/enterprise/findEnterpriseOrganizationTreeList",readonly:!1,"is-default":!1,label:e.label},on:{"update:label":function(t){e.label=t}},model:{value:e.search.enterpriseId,callback:function(t){e.$set(e.search,"enterpriseId",t)},expression:"search.enterpriseId"}})],1),r("el-form-item",{attrs:{label:"所属车组",prop:"fleetId"}},[r("cv-dropdown-tree",{attrs:{url:"/enterprise/findFleetTreeList","is-default":!1,"un-node-filter":["type",null],"is-initial":!1,"auto-params":{enterpriseId:e.label.enterpriseId,pId:e.label.id,type:e.label.type}},model:{value:e.search.fleetIds,callback:function(t){e.$set(e.search,"fleetIds",t)},expression:"search.fleetIds"}})],1),r("el-form-item",{staticStyle:{float:"right"}},[r("cv-tool",{attrs:{name:e.$route.name,data:e.$store.getters.monitorMenu,"is-modify":!1,"is-export":!1,"is-add":!0},on:{add:e.addContent,remove:e.remove,search:e.alarmConList}})],1)],1),r("cv-content",[r("cv-grid",{ref:"alarmTable",staticClass:"table",attrs:{params:e.search,url:"/platFormAlarm/queryPaltFormConfigByPage"},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{label:e.$t("cE.carNumbers"),prop:"plateCode",width:"150",formatter:e.plateCodeAndColor}}),r("el-table-column",{attrs:{label:e.$t("dm.company"),prop:"enterpriseName"}}),r("el-table-column",{attrs:{label:"车组名称",prop:"fleetName"}}),r("el-table-column",{attrs:{label:"疲劳驾驶",prop:"fatigueDrive",width:"100",formatter:e.driverStuas}}),r("el-table-column",{attrs:{label:"禁行报警",prop:"forbid",formatter:e.filterLStuas}}),r("el-table-column",{attrs:{label:"超速报警",prop:"overSpeeed",formatter:e.filterAlStuas}}),r("el-table-column",{attrs:{label:"高速公路超速报警",prop:"overSpeedH",width:"150",formatter:e.filteralarmStuas}}),r("el-table-column",{attrs:{label:"三分钟超速报警",prop:"tOversSpeed",width:"150",formatter:e.overStuas}}),r("el-table-column",{attrs:{label:"三分钟超速高速报警",prop:"tOverSpeedH",width:"200",formatter:e.overHStuas}}),r("el-table-column",{attrs:{label:e.$t("action.operation"),width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"cv-table-tool"},[r("cv-span",{attrs:{type:"success"},nativeOn:{click:function(r){return e.modify(t)}}},[e._v(e._s(e.$t("power.modify")))]),r("cv-span",{attrs:{type:"danger"},nativeOn:{click:function(r){return e.removeCar(t)}}},[e._v(e._s(e.$t("power.remove")))])],1)]}}])})],1),r("el-dialog",{attrs:{visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[r(e.dialog.name,{tag:"component",attrs:{options:e.dialog},on:{confirm:function(t){return e.alarmConList(!0)}}})],1)],1)],1)},[],!1,null,null,null).exports);m.install=function(e){e.component(m.name,m)},t.default=m},d4bc:function(e,t,r){}}]);