(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1d9675d9"],{8369:function(t,e,r){"use strict";var i=r("cebc");e.a={data:function(){return{table:{size:10,total:0,current:1,flag:!1,loading:!1,data:[]}}},methods:{tableLoading:function(t,e,r,o){var a=this;r?(this.table.flag=!0,this.table.current=1):this.table.flag=!1,this.table.loading=!0;var l=Object(i.a)({current:this.table.current,size:this.table.size},e);this.$http(o?{url:t,data:l}:{url:t,params:l}).then(function(t){var e=t.data;t.flag&&0!=e.length?(a.table.data=e.records,a.table.total=e.total,a.table.current=e.current):(a.table.data=[],a.table.total=0),a.table.loading=!1}).catch(function(t){a.table.loading=!1})},tableFilterColor:function(t){return this.$filter.plateCodeColor(t.plateColor)},tableFilterIcType:function(t){return this.$filter.icType(t.state)},tableFilterIcResult:function(t){return this.$filter.icResult(t.readerresult)},tableFilterTiredAlarm:function(t){return this.$filter.tiredAlarmType(t.alarm)},tableFilterTiredAdas:function(t){return this.$filter.tiredAdasType(t.alarm)},tableFilterOrderTypeS:function(t){return this.$filter.orderTypeS(t.sendFlag)},tableFilterFormat:function(t){return this.$filter.format(t.orderTime||t.gpsTime)},tableFilterFormats:function(t){return this.$filter.format(t.backTime)},tableBusLineType:function(t){return this.$filter.lineType(t.lineType)},tableFilterAcc:function(t){return this.$filter.accStatus(t.accStatus)},tableSplitMobile:function(t){return t.mobileCode?t.mobileCode.slice(1,t.mobileCode.length):""},tableConfirm:function(t){return this.$filter.isConfirm(t.isnotarize)},tableUpkeep:function(t){return this.$filter.isConfirm(t.type)},tableRenewal:function(t){return this.$filter.renewal(t.state)},tableReMot:function(t){return this.$filter.reMot(t.state)},tableOil:function(t){return this.$filter.fixNumber(t.total,2)},tableSex:function(t){return this.$filter.sex(t.sex)},plateCodeF:function(t){return t.plateCode?t.plateCode:"--"},plateCodeAndColor:function(t){return t.plateCode+"("+this.$filter.plateCodeColor(t.plateColor)+")"},driverStuas:function(t){return this.$filter.alarmStatus(t.fatigueDrive)},overStuas:function(t){return this.$filter.alarmStatus(t.tOversSpeed)},overHStuas:function(t){return this.$filter.alarmStatus(t.tOverSpeedH)},filterAlStuas:function(t){return this.$filter.alarmStatus(t.overSpeed)},filteralarmStuas:function(t){return this.$filter.alarmStatus(t.overSpeedH)},filterLStuas:function(t){return this.$filter.alarmStatus(t.forbid)},applyFlag:function(t){return this.$filter.applyFlag(t.applyFlag)},SEtime:function(t){return this.$filter.SEtime(t.StartTime,t.EndTime)},channelType:function(t){return this.$filter.channelType(t.Channel)},FileSize:function(t){return this.$filter.FileSize(t.fileSize||t.FileSize||0)},AlarmFilter:function(t){return this.$filter.AlarmFilter(t.Alarm)},MediaTypeFilter:function(t){return this.$filter.MediaTypeFilter(t.MediaType)},StreamTypeFilter:function(t){return this.$filter.StreamTypeFilter(t.StreamType)},StorageTypeFilter:function(t){return this.$filter.StorageTypeFilter(t.StorageType)},statusType:function(t){return this.$filter.statusType(t.Status)},fileSource:function(t){return this.$filter.fileSource(t.fileSource)}}}},d96d:function(t,e,r){"use strict";r.r(e),r("7f7f"),r("ed08");var i={props:{options:{}},data:function(){return{uploadForm:new FormData,tokens:{Accept:"application/json, text/plain",token:localStorage.getItem("token")},form:{versionNo:"",versionName:"",groupName:"",focus:"",updateLog:"",file:[],id:""},fileList:[],rules:{versionNo:[{required:!0,message:"不能为空",trigger:"blur,change"},{pattern:/^[0-9]+$/,message:"只能为数字"}],App:[{required:!0,message:"App类型",trigger:"blur,change"}],versionName:[{required:!0,message:"版本名称",trigger:"blur,change"},{pattern:/^[0-9]+\.[0-9]+\.[0-9]+$/,message:"请输入版本名称 格式类型:2.3.1"}],groupName:[{required:!0,message:"组名",trigger:"blur,change"}],file:[{required:!0,message:"上传文件",trigger:"change"}]}}},created:function(){this.show(!0)},watch:{"options.flag":function(t){this.show(t)}},methods:{submitForm:function(){var t=this;if(0!=this.fileList.length&&(this.rules.file[0].required=!1),this.$refs.forms.validate(function(e){return!!e&&("添加"==t.options.title&&0==t.fileList.length?(t.$message.error("请上传文件"),!1):("修改"==t.options.title&&(t.form.id=t.options.data.id),void t._uploadMethods.submit()))}),"修改"==this.options.title&&0==this.fileList.length){var e={id:this.options.data.id,versionNo:this.form.versionNo,versionName:this.form.versionName||"",groupName:this.form.groupName||"",focus:this.form.focus,updateLog:this.form.updateLog||""};this.$store.dispatch("modifyVersionG",e).then(function(e){e?(t.$message.warning("修改成功"),t.$emit("confirm"),t.options.flag=!1):t.$message.error(t.$t("error."+e.errorCode))})}},resetForm:function(){this.options.flag=!1,this.form.text=""},beforeRemove:function(t,e){return this.$confirm("确定移除 ".concat(t.name,"？"))},handleAvatarSuccess:function(t){if(!t.flag)return this.options.flag=!1,this.$message.error({message:this.$t("error."+t.errorCode)}),!1;this.$message.success(this.options.title+"成功"),this.options.flag=!1,this.$emit("confirm"),this.rules.file[0].required=!1},handleChange:function(t,e){this.fileList=e},show:function(t){this.fileList=[],"添加"==this.options.title&&t?(this.form={versionNo:"",versionName:"",groupName:"",focus:"0",updateLog:"",flie:""},this.rules.file[0].required=!0):"修改"==this.options.title&&t&&(this.form.versionNo=this.options.data.versionNo,this.form.versionName=this.options.data.versionName,this.form.groupName=this.options.data.groupName,this.form.App="APK"==this.options.data.type?"安卓":"苹果",this.form.focus=0==this.options.data.focus?"0":"1",this.form.updateLog=this.options.data.updateLog,this.form.url=this.options.data.url,this.rules.file[0].required=!1)}},computed:{_uploadMethods:function(){return this.$refs.upload},_formMethods:function(){return this.$refs.forms}}},o=(r("ff71"),r("2877")),a=Object(o.a)(i,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"forms",attrs:{model:t.form,"label-width":"80px",rules:t.rules,inline:!0,"label-position":"right"}},[r("el-form-item",{attrs:{prop:"versionNo",label:"版本号"}},[r("el-input",{staticStyle:{width:"180px"},attrs:{disabled:"修改"==t.options.title},model:{value:t.form.versionNo,callback:function(e){t.$set(t.form,"versionNo",e)},expression:"form.versionNo"}})],1),r("el-form-item",{attrs:{prop:"App",label:"App类型"}},[r("el-select",{staticStyle:{width:"180px"},attrs:{placeholder:"安卓/苹果",disabled:"修改"==t.options.title},model:{value:t.form.App,callback:function(e){t.$set(t.form,"App",e)},expression:"form.App"}},[r("el-option",{attrs:{label:"安卓",value:"android"}}),r("el-option",{attrs:{label:"苹果",value:"ios"}})],1)],1),r("el-form-item",{attrs:{prop:"versionName",label:"版本名称 "}},[r("el-input",{staticStyle:{width:"180px"},model:{value:t.form.versionName,callback:function(e){t.$set(t.form,"versionName",e)},expression:"form.versionName"}})],1),r("el-form-item",{attrs:{prop:"groupName",label:"组名 "}},[r("el-input",{staticStyle:{width:"180px"},model:{value:t.form.groupName,callback:function(e){t.$set(t.form,"groupName",e)},expression:"form.groupName"}})],1),r("el-form-item",{attrs:{prop:"file",label:"上传文件"}},[r("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"添加"==t.options.title?t.$COMMON.baseUrl+"/appVersion/insertVersion":t.$COMMON.baseUrl+"/appVersion/updateVersion",drag:"","file-list":t.fileList,"auto-upload":!1,"on-change":t.handleChange,"on-success":t.handleAvatarSuccess,accept:".apk","on-error":t.handError,data:t.form,headers:t.tokens}},[r("i",{staticClass:"el-icon-upload"}),r("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),r("em",[t._v("点击上传")])])])],1),r("el-form-item",{attrs:{prop:"rules6",label:"强制更新说明"}},[r("el-select",{attrs:{placeholder:"是/否"},model:{value:t.form.focus,callback:function(e){t.$set(t.form,"focus",e)},expression:"form.focus"}},[r("el-option",{attrs:{label:"是",value:"1"}}),r("el-option",{attrs:{label:"否",value:"0"}})],1)],1),r("el-form-item",{attrs:{prop:"rules7",label:"发布说明"}},[r("el-input",{staticStyle:{width:"360px"},attrs:{type:"textarea",rows:"5"},model:{value:t.form.updateLog,callback:function(e){t.$set(t.form,"updateLog",e)},expression:"form.updateLog"}})],1),r("el-row",[r("el-col",{staticClass:"dialog-footer",attrs:{span:24}},[r("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v("确定")]),r("el-button",{on:{click:t.resetForm}},[t._v("取消")])],1)],1)],1)},[],!1,null,null,null).exports,l={mixins:[r("8369").a],data:function(){return{App:"",grid:{},dialog:{flag:!1,title:"search",size:"dialog-small",data:{App:"ios"}},code:{flag:!1}}},mounted:function(){},computed:{_table:function(){return this.$refs.table1}},methods:{load:function(){this._table.tableInitial()},addBtn:function(){this.dialog.title="添加",this.dialog.flag=!0},modify:function(t){this.dialog.title="修改",this.dialog.data=t,this.dialog.flag=!0},down:function(t){var e=this.$service.winParams(this.$COMMON.baseUrl+"/app/appVersion/downApp?id="+t.id);window.location.href=e,location.href=e}},components:{versioncomponent:a}},n=Object(o.a)(l,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("cv-operation",[r("el-form-item",[r("cv-tool",{attrs:{name:t.$route.name,data:t.$store.getters.manageMenus,"is-remove":!1,"is-modify":!1,"is-calibrate":!1,"is-export":!1,"is-search":!1},on:{add:t.addBtn}})],1)],1),r("cv-content",[r("cv-grid",{ref:"table1",attrs:{params:t.grid,url:"/appVersion/getAppVersionsPage"}},[r("el-table-column",{attrs:{label:"版本号",prop:"versionNo"}}),r("el-table-column",{attrs:{label:"组名",prop:"groupName"}}),r("el-table-column",{attrs:{label:"发布时间",prop:"publishTime"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                 "+t._s(t.$filter.format(e.row.publishTime,"yyyy-MM-dd"))+"\n               ")]}}])}),r("el-table-column",{attrs:{label:"发布地址",prop:"url"}}),r("el-table-column",{attrs:{label:"发布说明",prop:"updateLog"}}),r("el-table-column",{attrs:{label:"强制更新",prop:"focus"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                 "+t._s(0==e.row.focus?"是":"否")+"\n               ")]}}])}),r("el-table-column",{attrs:{label:"App类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("APK"==e.row.type?"安卓":"苹果"))]}}])}),r("el-table-column",{attrs:{label:"操作",prop:"1"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("cv-span",{attrs:{type:"success"},nativeOn:{click:function(r){return t.modify(e.row)}}},[t._v("修改")]),r("cv-span",{attrs:{type:"success"},nativeOn:{click:function(r){return t.down(e.row)}}},[t._v("下载")])]}}])})],1),r("el-dialog",{attrs:{visible:t.dialog.flag,title:t.dialog.title,"custom-class":t.dialog.size},on:{"update:visible":function(e){return t.$set(t.dialog,"flag",e)}}},[r("versioncomponent",{attrs:{options:t.dialog},on:{confirm:t.load}})],1)],1)],1)},[],!1,null,null,null).exports;n.install=function(t){t.component(n.name,n)},e.default=n},f85e:function(t,e,r){},ff71:function(t,e,r){"use strict";var i=r("f85e");r.n(i).a}}]);