(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-95f3cb46"],{"1a39":function(e,t,i){"use strict";i.r(t),i("ac6a"),i("28a5");var s,o=i("cebc"),n={methods:{videoNumber:function(e){this.$emit("LayoutByScreens",e)},fullscreen:function(){this.$emit("fullscreen")}}},l=(i("74b6"),i("2877")),a=Object(l.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cv-video-operation"},[i("ul",[i("el-button",{on:{click:function(t){return e.videoNumber(1)}}},[e._v("1")]),i("el-button",{on:{click:function(t){return e.videoNumber(4)}}},[e._v("4")]),i("el-button",{on:{click:function(t){return e.videoNumber(6)}}},[e._v("6")]),i("el-button",{on:{click:function(t){return e.videoNumber(9)}}},[e._v("9")]),i("el-button",{on:{click:function(t){return e.videoNumber(16)}}},[e._v("16")])],1)])},[],!1,null,null,null).exports,r=(i("c5f6"),i("96cf"),i("3b8d")),c={props:{vehicleInfos:{}},data:function(){return{basicInfo:{},content:{activeName:"tabs0"},loopTimer:null}},methods:{loopLocations:(s=Object(r.a)(regeneratorRuntime.mark(function e(t){var i,s,o,n,l,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={vehicleIds:t,mapType:this.$store.getters.mapType},e.next=3,this.$http({url:"/videoController/getVehicleVideoLastLocation",params:i});case 3:s=e.sent,o=s.flag,n=s.data,l=s.errorCode,o&&!l&&(this.basicInfo=n.records[0],this.$refs.map.mapMethods.clearOverlays(),a=this.$refs.map.mapMethods.point({latitude:n.records[0].mapLatitude,longitude:n.records[0].mapLongitude}),r=this.$refs.map.mapMethods.mapAddpoint({longitude:Number(n.records[0].mapLongitude),latitude:Number(n.records[0].mapLatitude)},this.$filter.isOnline(n.records[0],!1,this.$store.getters.mapName),{width:32,height:32}),this.$refs.map.mapMethods.addOverlay(r),this.$refs.map.mapMethods.moveToCenter(a,this.$refs.map.mapMethods.map.getZoom()));case 8:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},watch:{"vehicleInfos.vehicleId":function(e){var t=this;clearInterval(this.loopTimer),this.loopTimer=setInterval(function(){t.loopLocations(e)},1500)}},beforeDestroy:function(){clearInterval(this.loopTimer)}},d=(i("9d74"),Object(l.a)(c,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cv-scrollbar",{staticClass:"vehicleInfo-video"},[i("div",{staticClass:"status"},[i("h3",[e._v("基本信息")]),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("终端ID:")]),i("el-col",{attrs:{span:14}},[e._v("\n                "+e._s(e._f("isValue")(e.basicInfo.terminalCode))+"\n            ")])],1),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("所属公司:")]),i("el-col",{attrs:{span:14}},[e._v("\n                "+e._s(e._f("isValue")(e.basicInfo.enterpriseName))+"\n            ")])],1),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("车队:")]),i("el-col",{attrs:{span:14}},[e._v("\n                "+e._s(e._f("isValue")(e.basicInfo.fleetName))+"\n            ")])],1),i("div",{staticClass:"plateCode"},[i("div",{staticClass:"pColor",style:{borderColor:this.$filter.plateCodeColor1(e.basicInfo.plateColor)}},[i("div",{staticClass:"inColor",style:{backgroundColor:this.$filter.plateCodeColor1(e.basicInfo.plateColor),color:4==e.basicInfo.plateColor?"black":"#fff"}},[e._v("\n                    "+e._s(e.basicInfo.plateCode||"--")+"\n                ")])])]),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("上报时间:")]),i("el-col",{attrs:{span:17}},[e._v("\n                "+e._s(e._f("isValue")(e._f("format")(e.basicInfo.gpsTime,"yyyy-MM-dd HH:mm:ss")))+"\n            ")])],1),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("速度:")]),i("el-col",{style:{color:1==e.basicInfo.locateStatus?"#000":"red"},attrs:{span:5}},[e._v(e._s(e._f("isValue")("0.0"==e.basicInfo.dspeed?"0.0"==e.basicInfo.gpsSpeed?"0 ":e.basicInfo.gpsSpeed:e.basicInfo.dspeed,"km/h")))]),i("el-col",{attrs:{span:5}},[e._v("总里程:")]),i("el-col",{attrs:{span:5}},[e._v(e._s(e._f("isValue")(e.basicInfo.mileage,"km")))])],1),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("方向:")]),i("el-col",{attrs:{span:5}},[e._v(e._s(e._f("isValue")(e._f("direction")(e.basicInfo.directionText))))]),i("el-col",{attrs:{span:5}},[e._v("海拔:")]),i("el-col",{attrs:{span:5}},[e._v(e._s(e._f("isValue")(e.basicInfo.height,"m")))])],1),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("经度:")]),i("el-col",{attrs:{span:5}},[e._v(e._s(e._f("isValue")(e._f("toFixed")(e.basicInfo.mapLongitude,6))))]),i("el-col",{attrs:{span:5}},[e._v("纬度:")]),i("el-col",{attrs:{span:5}},[e._v(e._s(e._f("isValue")(e._f("toFixed")(e.basicInfo.mapLatitude,6))))])],1),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("当前报警:")]),i("el-col",{attrs:{span:14}},[e._v(e._s(e._f("isValue")(e.basicInfo.alarmCount)))])],1),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("报警信息:")]),i("el-col",{attrs:{span:17}},[e._v(e._s(e._f("isValue")(e.basicInfo.alarmShortInfo)))])],1),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("地理位置:")]),i("el-col",{attrs:{span:17}},[e._v(e._s(e._f("isValue")(e.basicInfo.locationDesc)))])],1),i("el-row",{staticClass:"item",attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[e._v("ACC状态:")]),i("el-col",{attrs:{span:17}},[e._v(e._s(e._f("isValue")(e._f("accStatus")(e.basicInfo.accStatus))))])],1),i("el-row",{staticStyle:{"margin-top":"10px"}},[i("el-col",{attrs:{span:6}},[i("el-button",{attrs:{size:"small",disabled:""}},[e._v("预览所有")])],1),i("el-col",{attrs:{span:6}},[i("el-button",{directives:[{name:"instruction",rawName:"v-instruction",value:{title:"文本下发",id:this.vehicleInfos.vehicleId?this.vehicleInfos.vehicleId:"",enterpriseId:this.vehicleInfos.enterpriseId?this.vehicleInfos.enterpriseId:"",size:"dialog-middle",name:"textIssue",params:{vehicleId:this.vehicleInfos.vehicleId?this.vehicleInfos.vehicleId:"",enterpriseId:this.vehicleInfos.enterpriseId?this.vehicleInfos.enterpriseId:""}},expression:"{\n                                    title: '文本下发',\n                                    id: this.vehicleInfos.vehicleId?this.vehicleInfos.vehicleId:'',\n                                    enterpriseId: this.vehicleInfos.enterpriseId?this.vehicleInfos.enterpriseId:'',\n                                    size: 'dialog-middle',\n                                    name: 'textIssue', \n                                    params:{vehicleId:this.vehicleInfos.vehicleId?this.vehicleInfos.vehicleId:'',enterpriseId:this.vehicleInfos.enterpriseId?this.vehicleInfos.enterpriseId:''}}"}],attrs:{size:"small"}},[e._v("文本下发")])],1),i("el-col",{attrs:{span:6}},[i("el-button",{attrs:{size:"small",disabled:""}},[e._v("电话回拨")])],1),i("el-col",{attrs:{span:6}},[i("el-button",{directives:[{name:"instruction",rawName:"v-instruction",value:{title:"拍照",id:this.vehicleInfos.vehicleId?this.vehicleInfos.vehicleId:"",enterpriseId:this.vehicleInfos.enterpriseId?this.vehicleInfos.enterpriseId:"",size:"dialog-middle",name:"photo",params:{vehicleId:this.vehicleInfos.vehicleId?this.vehicleInfos.vehicleId:"",enterpriseId:this.vehicleInfos.enterpriseId?this.vehicleInfos.enterpriseId:""}},expression:"{\n                                    title: '拍照',\n                                    id: this.vehicleInfos.vehicleId?this.vehicleInfos.vehicleId:'',\n                                    enterpriseId: this.vehicleInfos.enterpriseId?this.vehicleInfos.enterpriseId:'',\n                                    size: 'dialog-middle',\n                                    name: 'photo', \n                                    params:{vehicleId:this.vehicleInfos.vehicleId?this.vehicleInfos.vehicleId:'',enterpriseId:this.vehicleInfos.enterpriseId?this.vehicleInfos.enterpriseId:''}}"}],attrs:{size:"small"}},[e._v("拍照")])],1)],1)],1),i(e.$store.getters.mapName,{ref:"map",tag:"component",staticClass:"mapbottom"})],1)},[],!1,null,"21ebf0ac",null).exports),h=i("9add"),u=i("3b6f"),v=i("cd33"),p={mixins:[h.a,v.a,u.a],props:{flashTree:{default:function(){return!1}}},data:function(){return{videoTreeData:null,treeReady:!0,currentVehicle:"",popover:{alias:"",id:""},listCH:[]}},computed:{_popoverMethods:function(){return this.$refs.popover},_listsMethods:function(){return this.$refs.lists}},methods:{nodeClick:function(e){this.listCH.enterpriseId=e.enterpriseId,this.listCH.plateCode=e.plateCode,this.listCH.id=e.pId,"C"==e.text.charAt(0)&&"H"==e.text.charAt(1)&&this.chClick(e.text)},playAll:function(){this.$emit("playAll",{id:this.listCH.id,legth:this.listCH.channelInfos.length,plateCode:this.listCH.plateCode,enterpriseId:this.listCH.enterpriseId}),this.handlerCollectionDestory()},chClick:function(e){var t={text:e,pId:this.listCH.id,plateCode:this.listCH.plateCode,enterpriseId:this.listCH.enterpriseId};this.currentVehicle=this.listCH.id,this.$store.dispatch("ptSinglePass",t),this.handlerCollectionDestory(),this.widthF=!1,this.$emit("confirm",e)},treeOperation:function(e){var t="",i=this,s=e.type,o=e.isAttention;return 4==s&&(t=1==o?'<i id="tree-collection" class="cv-icon-font el-icon-tsp-shoucang" style="color:#f3aa4e"></i>':'<i id="tree-collection" class="cv-icon-font el-icon-tsp-shoucang1"></i>'),{template:t,methods:function(){var t=document.getElementById("tree-collection");t&&(t.onclick=function(t){i.handlerCollection(t,e)})}}},handlerCollectionDestory:function(){this.mixins_hidePopover(this._popoverMethods)},attentionEditHandler:function(e,t){e.stopPropagation(),this.listCH=t,this.widthF=!0,this.mixins_showPopover(this._popoverMethods,e.target)}},mounted:function(){var e=this;this.$http({url:"/monitor/findVehicleTreeInfoList",params:{flag:!0}}).then(function(t){t.flag&&(e.videoTreeData=t.data,e.treeReady=!1)})}},f=(i("febc"),Object(l.a)(p,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"cv-tabs-vehiclelists"},[i("cv-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.treeReady,expression:"treeReady"}],staticClass:"cv-tabs-tree",attrs:{titles:["车辆选择","车辆列表"],isScrollbar:"",type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("cv-tree-search",{ref:"tree",attrs:{data:e.videoTreeData,"other-param":{flag:!0},lazy:e.vehilceApi,"icons-filter":e.treeIconsFilter,"node-filter":e.nodeFilter,operation:e.isOperation&&e.treeOperation,"limit-check":e.handlerLimitCheck},on:{"node-click":e.nodeClick}}),i("cv-tree-lists",{ref:"lists",attrs:{"search-api":e.listsApi,"is-check":!1,currentVehicle:e.currentVehicle},on:{"node-click":e.handlerListsClick},scopedSlots:e._u([{key:"label",fn:function(t){return[i("cv-icon",{staticClass:"tabicongao",attrs:{name:(t.row.icon||"icon1")+"cheliang",color:"1"==t.row.onlineStatus?"#1bca22":""}}),i("span",[e._v(e._s(t.row.plateCode||t.row.text))])]}},{key:"operation",fn:function(t){return[0<t.row.channelInfos.length?i("cv-icon",{attrs:{name:"shipinyuan",color:"1"==t.row.onlineStatus?"#1bca22":""},on:{click:function(i){return e.attentionEditHandler(i,t.row)}}}):e._e()]}}])},[i("template",{slot:"checkbox"},[i("el-checkbox",{attrs:{label:"1"}},[e._v("在线")]),i("el-checkbox",{attrs:{label:"0"}},[e._v("离线")])],1)],2)],1),e.flashTree?i("el-popover",{ref:"popover",attrs:{placement:"bottom",width:"160"}},[i("cv-scrollbar",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handlerCollectionDestory,expression:"handlerCollectionDestory"}],class:[e.widthF?"wF":"w"],staticStyle:{height:"120px"}},[i("li",{staticStyle:{padding:"5px",cursor:"pointer"},on:{click:e.playAll}},[e._v("全部播放")]),e._l(e.listCH.channelInfos,function(t){return i("li",{key:t.id,staticStyle:{padding:"5px",cursor:"pointer"},on:{click:function(i){return e.chClick(t.channelName)}}},[e._v(e._s(t.channelName))])})],2)],1):e._e()],1)},[],!1,null,null,null).exports),m=i("7812"),I=i("2f62"),C={components:{operation:a,vehicleInfo:d,videoTree:f},data:function(){return{videoFun:{},treeReady:!1,tree:{treeChecked:!1},video:{videonumber:[0]},windowNum:[],common:{vehicleId:null,enterpriseId:null,isFull:!1,timer:null,plateCode:null,mediaData:null},allChangeVehicle:{}}},methods:Object(o.a)({},Object(I.b)(["reSetVideoArr"]),Object(I.d)(["clearMess"]),{singleCar:function(e){e.data[0].id!=this.common.vehicleId&&(this.videoFun.Colse(-1),this.clearMess(),e.data[0].channelInfos.length?(this.videoFun.setOsdVisible(!0),this.realtimePlayAll(Object(o.a)({},e.data[0],{legth:e.data[0].channelInfos.length}))):(this.videoFun.setOsdVisible(!1),this.$message.warning(e.data[0].plateCode+"没有视频设备"))),this.allChangeVehicle[e.data[0].plateCode]=e.data[0],this.common.vehicleId=e.data[0].id},LayoutByScreens:function(e){this.videoFun.LayoutByScreens(e)},realtimePlayAll:function(e){var t=this;this.common.vehicleId=e.id,this.common.enterpriseId=e.enterpriseId,this.common.plateCode=e.plateCode,this.$store.dispatch("getVideoSimCodeAndIp",e.id).then(function(i){var s=i.data;i.errorCode,i.flag,t.videoFun.pallAll(s.simCode,e.legth,1,!0,s.ipAddress,s.port,e.plateCode)});for(var i=1;i>e.legth;i++)this.windowNum.push(i)}}),beforeDestroy:function(){this.videoFun.Colse(-1),this.clearMess()},mounted:function(){var e=this,t=this;setTimeout(function(){e.videoFun=new m.a("player",4,{selectedEvent:function(e){var i=document.getElementById("video-osd-text-"+(e-1)).innerText.split("/")[0];if(t.common.plateCode!=i){var s=t.allChangeVehicle[i];t.common=Object(o.a)({},s,{vehicleId:s.pId||s.id})}}})},500)},watch:{"$store.getters.ptSinglePass":function(e,t){var i=this,s=0<arguments.length&&void 0!==e?e:{},n=1<arguments.length&&void 0!==t?t:{},l=s.text.substring(2);this.allChangeVehicle[s.plateCode]=s;var a=document.querySelectorAll(".video-osd-text"),r=[];a.forEach(function(e){s.plateCode==e.innerText.split("/")[0]&&r.push(e.innerText.split("/")[1])}),n&&s.plateCode!=n.plateCode?(this.videoFun.Colse(0),this.$store.dispatch("getVideoSimCodeAndIp",s.pId).then(function(e){var t=e.data;e.errorCode,e.flag,i.videoFun.Connect(t.simCode,l,1,!0,t.ipAddress,t.port,s.plateCode)})):(this.$store.dispatch("getVideoSimCodeAndIp",s.pId).then(function(e){var t=e.data;e.errorCode,e.flag,i.videoFun.Connect(t.simCode,l,1,!0,t.ipAddress,t.port,s.plateCode)}),this.common=Object(o.a)({},s,{vehicleId:s.pId}))}}},b=(i("eadc"),Object(l.a)(C,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"realtimevideo"},[i("cv-operation",{attrs:{position:"left"}},[i("el-form-item",[i("operation",{on:{LayoutByScreens:e.LayoutByScreens}})],1)],1),i("cv-content",[i("div",{staticStyle:{width:"100%",height:"99.5%"},attrs:{slot:"aside"},slot:"aside"},[i("video-tree",{class:[e.treeReady?"widthF":"widthE"],attrs:{flashTree:!0,"node-monitor":e.singleCar},on:{playAll:e.realtimePlayAll}})],1),i("div",{class:["inContent",e.common.isFull?"inContent-full":""]},[i("div",{staticStyle:{height:"100%",right:"374px",left:"7px",bottom:"0px",position:"absolute"},attrs:{id:"player",refs:"player"}}),i("div",{staticClass:"rightTab"},[i("vehicle-info",{attrs:{vehicleInfos:e.common}})],1)])])],1)},[],!1,null,null,null).exports);t.default=b},"219d":function(e,t,i){},"61f6":function(e,t,i){},"74b6":function(e,t,i){"use strict";var s=i("d591");i.n(s).a},7557:function(e,t,i){},7812:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var s=i("d225"),o=i("b0b4"),n=function(){function e(t,i,o){Object(s.a)(this,e),this.init(t,i,o)}return Object(o.a)(e,[{key:"init",value:function(e,t,i){var s=2<arguments.length&&void 0!==i?i:{};CvNetVideo.Init(document.getElementById(e),t||1,s)}},{key:"LayoutByScreens",value:function(e){CvNetVideo.LayoutByScreens(e)}},{key:"Resize",value:function(e,t){CvNetVideo.Resize(e,t)}},{key:"setOsdVisible",value:function(e){CvNetVideo.SetOsdVisible(e)}},{key:"setOsdColor",value:function(e){CvNetVideo.SetOsdColor(e)}},{key:"setOsdText",value:function(e,t){CvNetVideo.SetOsdText(e,t)}},{key:"Connect",value:function(e,t,i,s,o,n,l){var a=!(3<arguments.length&&void 0!==s)||s,r=4<arguments.length?o:void 0,c=5<arguments.length?n:void 0;this.NowSelectVideo=CvNetVideo.NowSelectVideo,CvNetVideo.StartRealTimeVideo(e,t,i,a,this.NowSelectVideo,{clusterHost:r,clusterPort:c})}},{key:"pallAll",value:function(e,t,i,s,o,n,l){for(var a=!(3<arguments.length&&void 0!==s)||s,r=4<arguments.length?o:void 0,c=5<arguments.length?n:void 0,d=1;d<=t;d++)CvNetVideo.StartRealTimeVideo(e,d,i,a,d,{clusterHost:r,clusterPort:c})}},{key:"getSelectVideo",value:function(){return CvNetVideo.GetSelectedVideo()}},{key:"Colse",value:function(e){CvNetVideo.Stop(e)}},{key:"AVTransferControl",value:function(e,t,i,s,o,n,l){CvNetVideo.AVTransferControl(e,t,i,s,o,n,{remoteHost:l})}},{key:"PlaybackVideo",value:function(e,t,i,s,o,n,l,a,r,c,d,h){CvNetVideo.PlaybackVideo(e,t,i,s,o,n,l,a,r,c,{clusterHost:d,clusterPort:h})}},{key:"PlaybackVideoControl",value:function(e,t,i,s,o,n,l){CvNetVideo.PlaybackVideoControl(e,t,i,s,o,n,{remoteHost:l})}}]),e}()},"9d74":function(e,t,i){"use strict";var s=i("219d");i.n(s).a},d591:function(e,t,i){},eadc:function(e,t,i){"use strict";var s=i("7557");i.n(s).a},febc:function(e,t,i){"use strict";var s=i("61f6");i.n(s).a}}]);