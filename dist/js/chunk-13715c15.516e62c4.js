(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-13715c15"],{"7e88":function(e,t,a){"use strict";a.r(t),a("386d");var r,i=a("8369"),s={mixins:[i.a],props:{options:{}},data:function(){return{idM:"",search:{lineNo:"",lineName:""},dialog:{title:"修改",flag:!1,data:[]}}},methods:{loadTable:function(){this.$refs.busline.tableInitial()},getRowHandler:function(e){this.idM=e.id},VehicleStatus:function(e){return this.$filter.vehicleSt(e.clzt)},VehicleLevel:function(e){return this.$filter.vehicleLv(e.hylb)},confirm:function(){var e=this;if(""==this.idM)this.$message.error({message:"请点击选择更换线路"});else{var t={oilVehicleId:this.options.idT,lineId:this.idM};this.$http({url:"/oilSubsidy/modifyBusLine",params:t}).then(function(t){!t.flag&&t.errorCode?e.$message.error({message:e.$t("error."+t.errorCode)}):(e.$message.success(e.$t("UserManage.actionSuccess")),e.options.flag=!1,e.$parent.$parent.loadTable())}).catch(function(){return!1})}},cellHandler:function(){this.dialog.flag=!0}},mounted:function(){this.loadTable()}},l=a("2877"),o=Object(l.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("span",{staticStyle:{"margin-right":"10px"}},[e._v("线路标识")]),a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"",size:"small"},model:{value:e.search.lineNo,callback:function(t){e.$set(e.search,"lineNo",t)},expression:"search.lineNo"}}),a("span",{staticStyle:{"margin-right":"10px"}},[e._v("线路名称")]),a("el-input",{staticStyle:{"margin-bottom":"10px",width:"100px"},attrs:{placeholder:"",size:"small"},model:{value:e.search.lineName,callback:function(t){e.$set(e.search,"lineName",t)},expression:"search.lineName"}}),a("el-button",{staticStyle:{float:"right"},attrs:{type:"",size:"small"},on:{click:e.loadTable}},[e._v("搜索")]),a("cv-grid",{ref:"busline",attrs:{url:"/busline/showbusline",params:e.search},on:{"row-click":e.getRowHandler}},[a("el-table-column",{attrs:{label:"线路标识","min-width":"100",prop:"lineNo"}}),a("el-table-column",{attrs:{label:"线路名称","min-width":"150",prop:"lineName"}})],1),a("el-col",{staticClass:"dialog-footer",staticStyle:{"margin-top":"20px"},attrs:{span:24}},[a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s("确认"))]),a("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)},[],!1,null,"4a12e331",null).exports,n=(a("96cf"),a("3b8d")),c={props:{options:{}},data:function(){return{formData:{plateCode:"",fleetName:"",enterpriseName:"",superiorPlatformName:""}}},methods:{getVehicleMessage:(r=Object(n.a)(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.options.id)return e.next=3,this.$http({url:"/vehicle/getVehicleById",params:{id:this.options.id}});e.next=7;break;case 3:t=e.sent,a=t.data,t.flag&&0!=a.length?this.formData=a:this.$message.error({message:this.$t("error."+a.errorCode)});case 7:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},created:function(){this.getVehicleMessage()}},d={components:{vehicleMessage:Object(l.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.formData}},[a("el-form-item",{attrs:{label:"车牌号码"}},[a("el-input",{attrs:{placeholder:"",readonly:""},model:{value:e.formData.plateCode,callback:function(t){e.$set(e.formData,"plateCode",t)},expression:"formData.plateCode"}})],1),a("el-form-item",{attrs:{label:"所属公司"}},[a("el-input",{attrs:{placeholder:"",readonly:""},model:{value:e.formData.enterpriseName,callback:function(t){e.$set(e.formData,"enterpriseName",t)},expression:"formData.enterpriseName"}})],1),a("el-form-item",{attrs:{label:"所属车组"}},[a("el-input",{attrs:{placeholder:"",readonly:""},model:{value:e.formData.fleetName,callback:function(t){e.$set(e.formData,"fleetName",t)},expression:"formData.fleetName"}})],1),a("el-form-item",{attrs:{label:"上级平台"}},[a("el-input",{attrs:{placeholder:"",readonly:""},model:{value:e.formData.superiorPlatformName,callback:function(t){e.$set(e.formData,"superiorPlatformName",t)},expression:"formData.superiorPlatformName"}})],1)],1),a("el-row",{staticClass:"dialog-footer",staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.options.flag=!1}}},[e._v(e._s("确认"))]),a("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)},[],!1,null,null,null).exports,getLine:o},data:function(){return{ids:"",dialog:{id:"",title:"",flag:!1,name:"",size:"",idT:"",data:[]},search:{cphm:"",wspId:this.ids}}},methods:{loadTable:function(){this.$refs.tableVehicle.tableInitial()},VehicleStatus:function(e){return this.$filter.vehicleSt(e.clzt)},VehicleLevel:function(e){return this.$filter.vehicleLv(e.hylb)},changeLine:function(e){this.dialog.flag=!0,this.dialog.name="getLine",this.dialog.title="更换线路",this.dialog.size="dialog-small",this.dialog.idT=e.id},vehicleMessage:function(e){this.dialog.flag=!0,this.dialog.name="vehicleMessage",this.dialog.title="车辆信息",this.dialog.size="dialog-small",this.dialog.id=e.vehicleId}},watch:{"dialog.flag":function(e){e||(this.dialog.name="")}}},u=Object(l.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"oli"},[a("cv-grid",{ref:"tableVehicle",staticClass:"table",attrs:{url:"/oilSubsidy/findVehicleBusesWs",params:e.search}},[a("el-table-column",{attrs:{"min-width":"100",label:"车牌号码",prop:"cphm"}}),a("el-table-column",{attrs:{label:"车辆状态","min-width":"100",prop:"clzt",formatter:e.VehicleStatus}}),a("el-table-column",{attrs:{label:"车辆类型","min-width":"100",prop:"hylb",formatter:e.VehicleLevel}}),a("el-table-column",{attrs:{label:"当前路线","min-width":"130",prop:"lineName"}}),a("el-table-column",{attrs:{label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cv-span",{attrs:{type:"danger"},nativeOn:{click:function(a){return e.changeLine(t.row)}}},[e._v("\n            更换线路\n          ")]),a("cv-span",{attrs:{type:"primary"},nativeOn:{click:function(a){return e.vehicleMessage(t.row)}}},[e._v("详细")])]}}])})],1),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.flag,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[a(e.dialog.name,{tag:"component",attrs:{options:e.dialog},on:{confirm:e.loadTable}})],1)],1)},[],!1,null,null,null).exports,f={props:{options:{}},data:function(){return{company:"",formData:{passCode:"",userName:"",passWord:"",enterpriseId:"",superPlatformId:"",enterpriseName:""},setPing:[],loading:!1,rules:{passCode:[{type:"string",required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"}],userName:[{type:"string",required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"}],passWord:[{type:"string",required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"}],enterpriseId:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"}],superPlatformId:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"change"}]}}},methods:{oillAction:function(e,t){var a=this;this.$http({url:e,params:t}).then(function(e){!e.flag&&e.errorCode?a.$message.error({message:a.$t("error."+e.errorCode)}):(a.loading=!0,a.$emit("confirm"),a.$message.success({message:"操作成功"}),a.options.flag=!1),a.loading=!1}).catch(function(){a.loading=!1})},superiorPlatform:function(){var e=this;this.$http({url:"/transfer/findProtocolTransferGroupPageInfo",params:{current:1,size:20}}).then(function(t){t.flag&&(e.setPing=t.data.records)})},confirm:function(){var e=this;this.$refs.addFormOill.validate(function(t){if(!t)return!1;var a={passcode:e.formData.passCode,username:e.formData.userName,password:e.formData.passWord,enterpriseId:e.formData.enterpriseId,superPlatformId:e.formData.superPlatformId},r={id:e.options.modifyData.id,passcode:e.formData.passCode,username:e.formData.userName,password:e.formData.passWord,enterpriseId:e.formData.enterpriseId,superPlatformId:e.formData.superPlatformId};""==e.options.modifyData.id?e.oillAction("/buses/insertVehicleBusesWsParam",a):e.oillAction("/buses/updateVehicleBusesWsParam",r)})}},watch:{"options.flag":function(e){e||(this.options.name="",this.formData.passCode="",this.formData.userName="",this.formData.passWord="",this.formData.enterpriseName="",this.formData.enterpriseId="",this.formData.superPlatformId="")}},mounted:function(){this.superiorPlatform(),""!=this.options.modifyData.id&&(this.formData.passCode=this.options.modifyData.passCode,this.formData.userName=this.options.modifyData.userName,this.formData.passWord=this.options.modifyData.passWord,this.formData.enterpriseName=this.options.modifyData.enterpriseName,this.formData.enterpriseId=this.options.modifyData.enterpriseId,this.formData.superPlatformId=this.options.modifyData.superPlatformId)}},m=Object(l.a)(f,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"addFormOill",attrs:{model:e.formData,"label-position":"top",inline:!1,rules:e.rules}},[a("el-form-item",{attrs:{label:"对接码",prop:"passCode"}},[a("el-input",{attrs:{size:"small"},model:{value:e.formData.passCode,callback:function(t){e.$set(e.formData,"passCode","string"==typeof t?t.trim():t)},expression:"formData.passCode"}})],1),a("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[a("el-input",{attrs:{size:"small"},model:{value:e.formData.userName,callback:function(t){e.$set(e.formData,"userName","string"==typeof t?t.trim():t)},expression:"formData.userName"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"passWord"}},[a("el-input",{attrs:{size:"small"},model:{value:e.formData.passWord,callback:function(t){e.$set(e.formData,"passWord","string"==typeof t?t.trim():t)},expression:"formData.passWord"}})],1),a("el-form-item",{attrs:{label:"企业名称",prop:"enterpriseId"}},[a("cv-dropdown-tree",{attrs:{placeholder:e.$t("common.enterprise.enterpriseName"),url:"/enterprise/getEnterpriseTreeList",readonly:!1},model:{value:e.formData.enterpriseId,callback:function(t){e.$set(e.formData,"enterpriseId",t)},expression:"formData.enterpriseId"}})],1),a("el-form-item",{attrs:{label:"上级平台",prop:"superPlatformId"}},[a("el-select",{staticClass:"code",attrs:{clearable:"",placeholder:e.$t("terminal.placeholder"),maxlength:100},model:{value:e.formData.superPlatformId,callback:function(t){e.$set(e.formData,"superPlatformId",t)},expression:"formData.superPlatformId"}},e._l(e.setPing,function(e){return a("el-option",{key:e.id_,attrs:{label:e.superiorPlatform,value:e.id_}})}),1)],1)],1)],1),a("el-col",{staticClass:"dialog-footer",attrs:{span:24}},[a("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("action.save")))]),a("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)},[],!1,null,"ee2588d4",null).exports,p=a("b0ad"),h={mixins:[i.a,p.a],components:{oillVehicle:u,add:m},props:{api:{default:"/buses/findVehicleBusesWsParam"},flagPage:{type:Boolean,default:!1}},data:function(){return{ids:"",dialog:{title:"",size:"dialog-tiny",flag:!1,name:"",modifyData:{id:"",passCode:"",userName:"",passWord:"",superPlatformId:"",enterpriseId:"",enterpriseName:""}},search:{plateCode:"",enterpriseId:""}}},methods:{loadTable:function(){this.$refs.tableList.tableInitial()},FillAction:function(e,t){var a=this;this.table.loading=!0,this.$http({url:e,params:t}).then(function(e){e.flag?("7200"==e.data&&a.$message.success({message:"获取成功"}),a.loadTable()):a.$message.error({message:a.$t("error."+e.errorCode)}),a.table.loading=!1}).catch(function(){a.table.loading=!1})},rowHandler:function(e){this.$refs.Al.search.wspId=e.id,this.$refs.Al.loadTable()},modifyHandler:function(e){this.dialog.flag=!0,this.dialog.name="add",this.dialog.title="修改",this.dialog.id=e.id,this.dialog.size="dialog-tiny",this.dialog.modifyData.id=e.id,this.dialog.modifyData.passCode=e.passcode,this.dialog.modifyData.enterpriseId=e.enterpriseId,this.dialog.modifyData.enterpriseName=e.enterpriseName,this.dialog.modifyData.userName=e.username,this.dialog.modifyData.passWord=e.password,this.dialog.modifyData.superPlatformId=e.superPlatformId},addCompany:function(){this.dialog.flag=!0,this.dialog.name="add",this.dialog.title="新增",this.dialog.size="dialog-tiny",this.dialog.modifyData.id=""},remove:function(e){var t=this;this.confirmPrompt().then(function(){t.$http({url:"/buses/delectVehicleBusesWsParam",params:{busesID:e.id}}).then(function(e){e.flag?(t.loadTable(!0),t.$message.success(t.$t("UserManage.actionSuccess"))):t.$message.error(t.$t("UserManage.actionError"))})}).catch(function(){t.$message.info(t.$t("UserManage.cancelRemove"))})},loadAllCar:function(){this.$refs.Al.search.wspId="",this.$refs.Al.loadTable()},getVehicle:function(e){var t={wsId:e.id};this.FillAction("/oilSubsidy/getVehicle",t)}}},g=(a("d123"),Object(l.a)(h,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"oli"},[a("cv-operation",{staticClass:"header",attrs:{position:"left"}},[a("el-form-item",{attrs:{label:"所属公司"}},[a("cv-dropdown-tree",{staticClass:"win150",attrs:{placeholder:e.$t("common.enterprise.enterpriseName"),url:"/enterprise/getEnterpriseTreeList",readonly:!1},model:{value:e.search.enterpriseId,callback:function(t){e.$set(e.search,"enterpriseId",t)},expression:"search.enterpriseId"}})],1),a("div",{staticClass:"topRight"},[a("el-form-item",[a("el-button",{attrs:{icon:"search",size:"small"},on:{click:e.loadTable}},[e._v("搜索")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:e.addCompany}},[e._v("添加对接企业")])],1),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:e.loadAllCar}},[e._v("查看全部油补车辆")])],1)],1)],1),a("cv-content",[a("div",{staticClass:"oilTable"},[a("cv-grid",{ref:"tableList",attrs:{url:"/buses/findVehicleBusesWsParam",params:e.search},on:{"row-click":e.rowHandler}},[a("el-table-column",{attrs:{label:"对接码",prop:"passcode","min-width":"100"}}),a("el-table-column",{attrs:{label:"用户名","min-width":"100",prop:"username"}}),a("el-table-column",{attrs:{label:"企业名称",prop:"enterpriseName","min-width":"100"}}),a("el-table-column",{attrs:{label:"上级平台","min-width":"130",prop:"protocolName"}}),a("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cv-span",{attrs:{type:"success"},nativeOn:{click:function(a){return e.getVehicle(t.row)}}},[e._v("\n                      获取车辆\n                  ")]),a("cv-span",{attrs:{type:"primary"},nativeOn:{click:function(a){return e.modifyHandler(t.row)}}},[e._v("修改")]),a("cv-span",{attrs:{type:"danger"},nativeOn:{click:function(a){return e.remove(t.row)}}},[e._v("删除")])]}}])})],1)],1),a("div",{staticClass:"oilRight"},[a("oill-vehicle",{ref:"Al",attrs:{message:e.search.plateCode}})],1)]),a("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.flag,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[a(e.dialog.name,{tag:"component",attrs:{options:e.dialog},on:{confirm:e.loadTable}})],1)],1)},[],!1,null,"294f6a1d",null).exports);t.default=g},8369:function(e,t,a){"use strict";var r=a("cebc");t.a={data:function(){return{table:{size:10,total:0,current:1,flag:!1,loading:!1,data:[]}}},methods:{tableLoading:function(e,t,a,i){var s=this;a?(this.table.flag=!0,this.table.current=1):this.table.flag=!1,this.table.loading=!0;var l=Object(r.a)({current:this.table.current,size:this.table.size},t);this.$http(i?{url:e,data:l}:{url:e,params:l}).then(function(e){var t=e.data;e.flag&&0!=t.length?(s.table.data=t.records,s.table.total=t.total,s.table.current=t.current):(s.table.data=[],s.table.total=0),s.table.loading=!1}).catch(function(e){s.table.loading=!1})},tableFilterColor:function(e){return this.$filter.plateCodeColor(e.plateColor)},tableFilterIcType:function(e){return this.$filter.icType(e.state)},tableFilterIcResult:function(e){return this.$filter.icResult(e.readerresult)},tableFilterTiredAlarm:function(e){return this.$filter.tiredAlarmType(e.alarm)},tableFilterTiredAdas:function(e){return this.$filter.tiredAdasType(e.alarm)},tableFilterOrderTypeS:function(e){return this.$filter.orderTypeS(e.sendFlag)},tableFilterFormat:function(e){return this.$filter.format(e.orderTime||e.gpsTime)},tableFilterFormats:function(e){return this.$filter.format(e.backTime)},tableBusLineType:function(e){return this.$filter.lineType(e.lineType)},tableFilterAcc:function(e){return this.$filter.accStatus(e.accStatus)},tableSplitMobile:function(e){return e.mobileCode?e.mobileCode.slice(1,e.mobileCode.length):""},tableConfirm:function(e){return this.$filter.isConfirm(e.isnotarize)},tableUpkeep:function(e){return this.$filter.isConfirm(e.type)},tableRenewal:function(e){return this.$filter.renewal(e.state)},tableReMot:function(e){return this.$filter.reMot(e.state)},tableOil:function(e){return this.$filter.fixNumber(e.total,2)},tableSex:function(e){return this.$filter.sex(e.sex)},plateCodeF:function(e){return e.plateCode?e.plateCode:"--"},plateCodeAndColor:function(e){return e.plateCode+"("+this.$filter.plateCodeColor(e.plateColor)+")"},driverStuas:function(e){return this.$filter.alarmStatus(e.fatigueDrive)},overStuas:function(e){return this.$filter.alarmStatus(e.tOversSpeed)},overHStuas:function(e){return this.$filter.alarmStatus(e.tOverSpeedH)},filterAlStuas:function(e){return this.$filter.alarmStatus(e.overSpeed)},filteralarmStuas:function(e){return this.$filter.alarmStatus(e.overSpeedH)},filterLStuas:function(e){return this.$filter.alarmStatus(e.forbid)},applyFlag:function(e){return this.$filter.applyFlag(e.applyFlag)},SEtime:function(e){return this.$filter.SEtime(e.StartTime,e.EndTime)},channelType:function(e){return this.$filter.channelType(e.Channel)},FileSize:function(e){return this.$filter.FileSize(e.fileSize||e.FileSize||0)},AlarmFilter:function(e){return this.$filter.AlarmFilter(e.Alarm)},MediaTypeFilter:function(e){return this.$filter.MediaTypeFilter(e.MediaType)},StreamTypeFilter:function(e){return this.$filter.StreamTypeFilter(e.StreamType)},StorageTypeFilter:function(e){return this.$filter.StorageTypeFilter(e.StorageType)},statusType:function(e){return this.$filter.statusType(e.Status)},fileSource:function(e){return this.$filter.fileSource(e.fileSource)}}}},b0ad:function(e,t,a){"use strict";(function(e){a("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var a=this,r=e||this.$t("action.confirmIsRemove");return new Promise(function(e,i){a.$confirm(r,a.$t("action.tip"),{confirmButtonText:a.$t("action.confirm"),cancelButtonText:a.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,a){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=a||this.$message.error({message:this.$t("请选择时间范围在"+a+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,a){var r=e.length,i=t.length;return i<r?{name:"add",data:this.$service.isUnique(e,t,a)}:r<i?{name:"remove",data:this.$service.isUnique(t,e,a)}:r==i?{name:"equal",data:this.$service.isUnique(e,t,a)}:void 0},showTooltip:function(e,t){var a=e.target,r=this.$refs[t];r.referenceElm=a,r.$refs.popper.style.display="none",r.doDestroy(),r.setExpectedState(!0),r.handleShowPopper()},mouseenterShowTip:function(e,t,a){var r=e.target;if(r.scrollWidth>r.offsetWidth||a)return this.showTooltip(e,t),a?a.startTime+"~"+a.endTime:r.innerText},mouseenterShowToolTip:function(e,t,a){var r=e.target;return this.showTooltip(e,t),!a&&r.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,a){var r=this,i=0<arguments.length&&void 0!==t?t:"Baidu",s=1<arguments.length?a:void 0;return e[i]?e[i]._preloader?e[i]._preloader:Promise.resolve(e[i]):(e[i]={},e[i]._preloader=new Promise(function(t,a){var l=document.createElement("script");l.src=s,e.document.body.appendChild(l),r.$service.isIe()&&r.$service.IE_VERSION<11?l.onreadystatechange=function(){"loaded"!=l.readyState&&"complete"!=l.readyState||(t(e[i]),e[i]._preloader=null)}:l.onload=function(){t(e[i]),e[i]._preloader=null}}),e[i]._preloader)}}}}).call(this,a("c8ba"))},d123:function(e,t,a){"use strict";var r=a("f33a");a.n(r).a},f33a:function(e,t,a){}}]);