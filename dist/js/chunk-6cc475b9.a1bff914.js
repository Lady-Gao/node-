(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6cc475b9"],{"05c0":function(e,t,i){"use strict";i("7f7f"),i("20d6"),i("ac6a");var r=i("cebc"),a=i("3f4e"),n=i("2f62"),o={name:"CvPublictreeContent",components:{CvContent:a.a},props:{model:String,vehicleMonitor:Function,loading:Boolean,noresize:{default:!1,type:Boolean}},data:function(){return{entryList:[],condition:""}},computed:Object(r.a)({},Object(n.c)(["onlineList","isAttention","socketEnterprise","socketVehicle","vehicle_data","vehicleCondition"]),{isCheck:function(){switch(this.model){case"multi":return!0;case"single":default:return!1}},_treeMethods:function(){return this.$refs.tabs},_contentMethods:function(){return this.$refs.content}}),beforeDestroy:function(){var e=this._treeMethods.getAllNodes;this.setStoreVehicleSearchCondition(this.condition),this.setStoreVehicleData(e())},mounted:function(){var e=this._treeMethods.$refs.tree.reference().ztreeApi;e()&&e().checkAllNodes(!1)},methods:Object(r.a)({},Object(n.b)(["setStoreVehicleData","setStoreVehicleSearchCondition"]),{handlerVehicleSearch:function(e){this.condition=e},vehicle_Monitor:function(e){var t=e.data;if(e.name,"function"==typeof this.vehicleMonitor)switch(this.model){case"multi":return this.vehicle_Monitor_multi(e);case"single":return this.vehicleMonitor(t[0])}},vehicle_Monitor_multi:function(e){var t=this,i=e.data;switch(e.name){case"check":this.entryList=this.entryList.concat(i);break;case"cancel":i.forEach(function(e){var i=t.entryList.findIndex(function(t){return t.id==e.id});0<=i&&t.entryList.splice(i,1)})}this.vehicleMonitor(this.entryList)}})},s=(i("45d7"),i("2877")),l=Object(s.a)(o,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cv-content",{ref:"content",attrs:{loading:e.loading,noresize:e.noresize}},[e.model?i("cv-tabs-tree",{ref:"tabs",staticClass:"vehiclemaster-tree",attrs:{slot:"aside","vehicle-search":e.vehicleCondition,"is-checked":e.isCheck,"tree-data":e.vehicle_data,"online-monitor":e.onlineList,"vehicle-monitor":e.socketVehicle,"attention-monitor":e.isAttention,"enterprise-fleet-monitor":e.socketEnterprise,"node-monitor":e.vehicle_Monitor},on:{"vehicle-choose-search":e.handlerVehicleSearch},slot:"aside"}):e._e(),e._t("default")],2)},[],!1,null,"2dfdf41b",null).exports;l.install=function(e){e.component(l.name,l)},t.a=l},"1f48":function(e,t,i){"use strict";i.r(t),i("20d6"),i("ac6a"),i("386d");var r=i("cebc"),a=i("05c0"),n=i("2f62"),o=i("b0ad"),s={components:{CvPublictreeContent:a.a},mixins:[o.a],computed:Object(r.a)({_tree:function(){return this.$refs.alarmTree},_table:function(){return this.$refs.handelTable}},Object(n.c)(["multicar_currentVehicle"])),data:function(){return{label:"",alarmStr:[],alarmList:[],alarmTree:[],allAlarm:[],alarmLoading:!1,alarmType:"",alarmTypeText:"",alarmFlag:!1,value:"1",pickerOption:{disabledDate:function(e){return e.getTime()>Date.now()}},search:{vehicleIds:"",alarmTypeStr:"",mapType:this.$store.getters.mapType,startTime:this.$filter.format(new Date,"yyyy-MM-dd start"),endTime:this.$filter.format(new Date,"yyyy-MM-dd HH:mm:ss")},timeT:[this.$filter.format(new Date,"yyyy-MM-dd start"),this.$filter.format(new Date,"yyyy-MM-dd HH:mm:ss")],operation:{alarm:"1",alarmTypes:[],vehicleIds:[]},backTime:""}},mounted:function(){var e=this;this.alarmLoad(),this.$store.dispatch("findAlarmTypeInfoListByAdas",{platforms:"5,6"}).then(function(t){var i=t.flag,r=t.data;t.errorCode,i&&(e.alarmTree=r.map(function(e){return e.alarmId}))}),this.$route.query.vehicleId&&(this.search.vehicleIds=this.$route.query.vehicleId,this.search.alarmTypeStr=this.$route.query.alarmTypeId,this.isSearch(),this.search.vehicleIds="",this.search.alarmTypeStr="")},methods:{isSearch:function(){if(7<this.$filter.timeRange(this.timeT[0],this.timeT[1]))return this.$message.warning(this.$t("action.day7mess")),!1;this._table.tableInitial()},handlerVehicleMonitor:function(e){var t=[];e.forEach(function(e){t.push(e.id)}),this.search.vehicleIds=this.$service.isContext(t.join(","))?"":t.join(",")},alarmLoad:function(){var e=this;this.$store.dispatch("frinAlarmTypeInfoListT").then(function(t){e.alarmList=t.data.children})},handleAlarm:function(e){var t=this.$service.winParams("/monitor/alHandle",{vehicleId:e.vehicleId,plateColor:e.plateColor,plateCode:e.plateCode,alarmTime:e.time,enterpriseId:e.enterpriseId});this.$service.winOpen(t)},checked:function(e){this.operation.alarmTypes=e},alarmTime:function(e){return""!=e.time?e.time:""},bigTime:function(e){return!(864e5<Date.now()-new Date(e.time).getTime())},viewShow:function(e){return!(-1<this.alarmTree.findIndex(function(t){return t==e.alarmId}))},down:function(){var e=this,t=[];if(0<this.operation.vehicleIds.length&&this.operation.vehicleIds.forEach(function(e){t.push(e.id)}),7<this.$filter.timeRange(this.search.startTime,this.search.endTime))return this.$message.warning(this.$t("action.day7mess")),!1;if(null!=this.timeT){var i={vehicleIds:this.$service.isContext(t.join(","))?"":t.join(","),startTime:this.timeT[0],endTime:this.timeT[1],alarmTypeStr:this.search.alarmTypeStr,mapType:this.$store.getters.mapType};this.$store.dispatch("exportAlarmInfoList",i).then(function(t){t.flag?e.$message.success({message:e.$t("error."+t.errorCode)}):e.$message.error({message:e.$t("error."+t.errorCode)})})}else this.$message.warning(this.$t("reportForm.overSpeed.selectTime"))},filterColor:function(e){return this.$filter.plateCodeColor(e.plateColor)},filterAlarmLevel:function(e){return this.$filter.alarmLevel(e.alarmLevel)},filterAlarmType:function(e){for(var t=0;t<this.allAlarm.length;t++)if(this.allAlarm[t].alarmId==e.alarmId)return this.allAlarm[t].alarmName},videodetail:function(e){switch(e){case"96":case"97":case"98":case"99":case"100":case"101":case"102":return!0}},vDataGet:function(e,t,i){var r=this;this.showTooltip(e,"tooltip"),this.$http({url:"/videoController/getVideoAlarmDetailInfo",params:{alarmId:t,alramTypeId:i}}).then(function(e){var t=e.data;e.flag&&(r.alarmTypeText=t)})}},watch:{alarmStr:function(e){this.search.alarmTypeStr=e&&e.join(",")},timeT:function(e){this.search.startTime=e?e[0]:"",this.search.endTime=e?e[1]:""}}},l=(i("2e73"),i("2877")),c=Object(l.a)(s,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"one"},[i("cv-operation",{attrs:{position:"left"}},[i("el-form-item",{attrs:{label:e.$t("processing.date")}},[i("el-date-picker",{attrs:{editable:!1,clearable:!1,"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","picker-options":e.pickerOption,size:"small"},model:{value:e.timeT,callback:function(t){e.timeT=t},expression:"timeT"}})],1),i("el-form-item",{attrs:{label:e.$t("processing.processing")}},[i("cv-dropdown-tree",{ref:"alarmTree",staticStyle:{display:"inline-block"},attrs:{isCheck:!0,"is-default":!1,data:e.alarmList},model:{value:e.alarmStr,callback:function(t){e.alarmStr=t},expression:"alarmStr"}})],1),i("el-form-item",[i("cv-tool",{staticClass:"cv-tool",staticStyle:{margin:"0"},attrs:{name:e.$route.name,data:e.$store.getters.monitorMenu,"is-remove":!1,"is-add":!1,"is-modify":!1},on:{search:e.isSearch,export:e.down}})],1)],1),i("cv-publictree-content",{attrs:{model:"multi","vehicle-monitor":e.handlerVehicleMonitor,loading:e.alarmLoading}},[i("el-tooltip",{ref:"tooltip",attrs:{content:e.alarmTypeText,placement:"top"}}),i("cv-grid",{ref:"handelTable",staticClass:"alarmGrid",attrs:{isInitial:!1,url:"/alarmInfo/findAlarmInfoList.do",params:e.search}},[i("el-table-column",{attrs:{label:e.$t("processing.alramNumber"),prop:"plateCode","min-width":"100px"}}),i("el-table-column",{attrs:{label:e.$t("processing.color"),prop:"plateColor","min-width":"100px",formatter:e.filterColor}}),i("el-table-column",{attrs:{label:e.$t("processing.type"),prop:"alarmName",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("i",{directives:[{name:"show",rawName:"v-show",value:e.videodetail(t.row.alarmId),expression:"videodetail(scope.row.alarmId)"}],staticClass:"el-icon-warning vtip",on:{mouseover:function(i){return e.vDataGet(i,t.row.id,t.row.alarmId)},mouseout:function(t){return e.mouseoverHideTip("tooltip")}}}),i("span",[e._v(e._s(t.row.alarmName))])]}}])}),i("el-table-column",{attrs:{label:e.$t("processing.distinction"),prop:"alarmLevel","min-width":"100px",formatter:e.filterAlarmLevel}}),i("el-table-column",{attrs:{label:e.$t("processing.source"),prop:"sources","min-width":"100px"}}),i("el-table-column",{attrs:{label:e.$t("processing.speed"),prop:"speed","min-width":"120px"}}),i("el-table-column",{attrs:{label:e.$t("processing.gpsSpeed"),prop:"gpsSpeed","min-width":"160px"}}),i("el-table-column",{attrs:{label:e.$t("processing.locationName"),prop:"locationName","min-width":"120px"}}),i("el-table-column",{attrs:{label:e.$t("processing.time"),prop:"time","min-width":"120px",formatter:e.alarmTime}}),i("el-table-column",{attrs:{label:e.$t("processing.operation"),prop:"operation","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.viewShow(t.row)&&e.bigTime(t.row)?i("cv-span",{attrs:{type:"primary"},nativeOn:{click:function(i){return e.handleAlarm(t.row)}}},[e._v("\n                            "+e._s(e.$t("processing.Handle")))]):e._e(),e.viewShow(t.row)&&!e.bigTime(t.row)?i("cv-span",{attrs:{type:"danger"}},[e._v(e._s(e.$t("processing.Handlelongtime")))]):e._e()]}}])})],1)],1)],1)},[],!1,null,"589cad5b",null).exports;t.default=c},"2e73":function(e,t,i){"use strict";var r=i("ed27");i.n(r).a},"45d7":function(e,t,i){"use strict";var r=i("6e18");i.n(r).a},"6e18":function(e,t,i){},b0ad:function(e,t,i){"use strict";(function(e){i("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var i=this,r=e||this.$t("action.confirmIsRemove");return new Promise(function(e,a){i.$confirm(r,i.$t("action.tip"),{confirmButtonText:i.$t("action.confirm"),cancelButtonText:i.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,i){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=i||this.$message.error({message:this.$t("请选择时间范围在"+i+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,i){var r=e.length,a=t.length;return a<r?{name:"add",data:this.$service.isUnique(e,t,i)}:r<a?{name:"remove",data:this.$service.isUnique(t,e,i)}:r==a?{name:"equal",data:this.$service.isUnique(e,t,i)}:void 0},showTooltip:function(e,t){var i=e.target,r=this.$refs[t];r.referenceElm=i,r.$refs.popper.style.display="none",r.doDestroy(),r.setExpectedState(!0),r.handleShowPopper()},mouseenterShowTip:function(e,t,i){var r=e.target;if(r.scrollWidth>r.offsetWidth||i)return this.showTooltip(e,t),i?i.startTime+"~"+i.endTime:r.innerText},mouseenterShowToolTip:function(e,t,i){var r=e.target;return this.showTooltip(e,t),!i&&r.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,i){var r=this,a=0<arguments.length&&void 0!==t?t:"Baidu",n=1<arguments.length?i:void 0;return e[a]?e[a]._preloader?e[a]._preloader:Promise.resolve(e[a]):(e[a]={},e[a]._preloader=new Promise(function(t,i){var o=document.createElement("script");o.src=n,e.document.body.appendChild(o),r.$service.isIe()&&r.$service.IE_VERSION<11?o.onreadystatechange=function(){"loaded"!=o.readyState&&"complete"!=o.readyState||(t(e[a]),e[a]._preloader=null)}:o.onload=function(){t(e[a]),e[a]._preloader=null}}),e[a]._preloader)}}}}).call(this,i("c8ba"))},ed27:function(e,t,i){}}]);