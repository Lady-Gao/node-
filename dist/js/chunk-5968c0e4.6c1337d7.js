(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5968c0e4"],{"1a46":function(t,e,a){"use strict";a.r(e),a("7f7f");var i={mixins:[],props:{options:{}},data:function(){return{add:{name:"",alias:"",remark:"",protocolVersion:""},loading:!1,rules:{name:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{min:1,max:45,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:1,max:45})},{validator:this.isName,trigger:"blur"}],alias:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{min:1,max:45,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:1,max:45})}],remark:[{min:1,max:120,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:1,max:120})}],protocolVersion:[{required:!0,message:this.$t("companyManage.fk"),trigger:"blur,change"},{min:1,max:11,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:1,max:11})}]}}},methods:{isName:function(t,e,a){var i=this;this.$service.isContext(e)||this.$store.dispatch("isExistTerminalProtocol",{name:e}).then(function(t){t.flag?a():a(new Error(i.$t("error."+t.errorCode)))})},confirm:function(){var t=this;this.$refs.formItem.validate(function(e){if(!e)return!1;var a={name:t.add.name,alias:t.add.alias,remark:t.add.remark,protocolVersion:t.add.protocolVersion};t.loading=!0,t.$store.dispatch("insertTerminalProtocol",a).then(function(e){t.loading=!1,!e.flag&&e.errorCode?t.$message.error({message:t.$t("error."+e.errorCode)}):(t.options.flag=!1,t.$emit("confirm"),t.$message.success(t.$t("action.modifySuccess")))}).catch(function(){t.loading=!1})})}},watch:{"options.flag":function(t){t||(this.options.name="")}}},o=(a("5f65"),a("2877")),r=Object(o.a)(i,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"formItem",attrs:{inline:!1,"label-position":"top",model:t.add,rules:t.rules}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("companyManage.n"),prop:"name"}},[a("el-input",{attrs:{size:"small"},model:{value:t.add.name,callback:function(e){t.$set(t.add,"name","string"==typeof e?e.trim():e)},expression:"add.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("dM.shortName"),prop:"alias"}},[a("el-input",{attrs:{size:"small"},model:{value:t.add.alias,callback:function(e){t.$set(t.add,"alias","string"==typeof e?e.trim():e)},expression:"add.alias"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("dM.protocol"),prop:"protocolVersion"}},[a("el-input",{attrs:{size:"small"},model:{value:t.add.protocolVersion,callback:function(e){t.$set(t.add,"protocolVersion","string"==typeof e?e.trim():e)},expression:"add.protocolVersion"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("dM.remark"),prop:"remark"}},[a("el-input",{attrs:{rows:3,resize:"none",placeholder:t.$t("placeholder.inputValue"),size:"small"},model:{value:t.add.remark,callback:function(e){t.$set(t.add,"remark","string"==typeof e?e.trim():e)},expression:"add.remark"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.confirm}},[t._v(t._s(t.$t("action.confirm")))]),a("el-button",{on:{click:function(e){t.options.flag=!1}}},[t._v(t._s(t.$t("action.cancel")))])],1)],1)},[],!1,null,"62dda421",null).exports,n=(a("6b54"),{mixins:[],props:{options:{}},data:function(){return{formData:{name:"",alias:"",remark:"",protocolVersion:""},loading:!1,rules:{name:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{min:1,max:45,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:1,max:45})},{validator:this.isName,trigger:"blur"}],alias:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{min:1,max:45,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:1,max:45})}],remark:[{min:1,max:120,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:1,max:120})}],protocolVersion:[{required:!0,message:this.$t("companyManage.fk"),trigger:"blur,change"},{min:1,max:11,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:1,max:11})}]}}},methods:{confirm:function(){var t=this;this.$refs.formItem.validate(function(e){if(!e)return!1;var a={name:t.formData.name,alias:t.formData.alias,remark:t.formData.remark,protocolVersion:t.formData.protocolVersion,id:t.formData.id};t.loading=!0,t.$store.dispatch("updateTerminalProtocol",a).then(function(e){t.loading=!1,!e.flag&&e.errorCode?t.$message.error({message:t.$t("error."+e.errorCode)}):(t.$message.success(t.$t("action.modifySuccess")),t.$emit("confirm"),t.options.flag=!1)}).catch(function(){t.loading=!1})})}},watch:{"options.flag":function(t){t||(this.options.name="")}},mounted:function(){this.formData.name=this.options.modify.name,this.formData.alias=this.options.modify.alias+"",this.formData.remark=this.options.modify.remark,this.formData.protocolVersion=this.options.modify.protocolVersion.toString(),this.formData.id=this.options.modify.id}}),s=(a("f1f2"),Object(o.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"formItem",attrs:{inline:!1,"label-position":"top",model:t.formData,rules:t.rules}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("companyManage.n"),prop:"name"}},[a("el-input",{attrs:{size:"small"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name","string"==typeof e?e.trim():e)},expression:"formData.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("dM.shortName"),prop:"alias"}},[a("el-input",{attrs:{size:"small"},model:{value:t.formData.alias,callback:function(e){t.$set(t.formData,"alias","string"==typeof e?e.trim():e)},expression:"formData.alias"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("dM.protocol"),prop:"protocolVersion"}},[a("el-input",{attrs:{size:"small"},model:{value:t.formData.protocolVersion,callback:function(e){t.$set(t.formData,"protocolVersion","string"==typeof e?e.trim():e)},expression:"formData.protocolVersion"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:t.$t("dM.remark"),prop:"remark"}},[a("el-input",{attrs:{rows:3,placeholder:"请输入内容",size:"small"},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark","string"==typeof e?e.trim():e)},expression:"formData.remark"}})],1)],1)],1)],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.confirm}},[t._v(t._s(t.$t("action.confirm")))]),a("el-button",{on:{click:function(e){t.options.flag=!1}}},[t._v(t._s(t.$t("action.cancel")))])],1)],1)},[],!1,null,"a7af2d04",null).exports),l=(a("ac6a"),{mixins:[],props:{options:{}},data:function(){return{art:[],checkAll:!0,checkedCities:[],cities:[],isIndeterminate:!0,loading:!1}},methods:{save:function(){var t=this,e={id:this.options.bing.id};this.$store.dispatch("findBindedAbilityList",e).then(function(e){if(!e.flag&&e.errorCode)t.$message.error({message:t.$t("error."+e.errorCode)});else for(var a=0;a<e.data.length;a++)t.checkedCities.push(e.data[a].id)})},unSave:function(){var t=this,e={id:this.options.bing.id};this.$store.dispatch("findTerminalAbilityList",e).then(function(e){!e.flag&&e.errorCode?t.$message.error({message:t.$t("error."+e.errorCode)}):(t.art=e.data,t.cities=t.art)})},confirm:function(){var t=this;this.$refs.bingItem.validate(function(e){if(!e)return!1;var a={id:t.options.bing.id,ids:t.checkedCities.join(",")};t.loading=!0,t.$store.dispatch("insertProtocolAndAbility",a).then(function(e){t.loading=!1,!e.flag&&e.errorCode?t.$message.error({message:t.$t("error."+e.errorCode)}):t.$message.success(t.$t("vgPower.bindSuccess"))}).catch(function(){t.loading=!1})}),this.options.flag=!1},handleCheckAllChange:function(t){var e=[];this.cities.forEach(function(t){e.push(t.id)}),this.checkedCities=t.target.checked?e:[],this.isIndeterminate=!1},handleCheckedPowerChange:function(t){var e=t.length;this.checkAll=e===this.cities.length,this.isIndeterminate=0<e&&e<this.cities.length}},mounted:function(){this.save(),this.unSave()},watch:{"options.flag":function(t){t||(this.options.name="")}}}),c={components:{add:r,modify:s,bing:Object(o.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"bingItem",attrs:{model:t.options.bing}},[a("el-form-item",[a("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("绑定关系")]),a("el-checkbox-group",{on:{change:t.handleCheckedPowerChange},model:{value:t.checkedCities,callback:function(e){t.checkedCities=e},expression:"checkedCities"}},t._l(t.cities,function(e){return a("el-checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(e.name))])}),1)],1)],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:t.confirm}},[t._v(t._s(t.$t("action.confirm")))]),a("el-button",{on:{click:function(e){t.options.flag=!1}}},[t._v(t._s(t.$t("action.cancel")))])],1)],1)],1)},[],!1,null,null,null).exports},data:function(){return{table:[],loading:!1,dialog:{flag:!1,title:"--",size:"dialog-small",name:"search",id:"",modify:{name:"",alias:"",remark:"",protocolVersion:"",id:""},bing:{id:""}}}},methods:{powerList:function(){var t=this;this.loading=!0,this.$store.dispatch("findTerminalProtocolList",{}).then(function(e){if(t.loading=!1,!e.flag)return!1;for(var a=[],i=0;i<e.data.length;i++)a.push(e.data[i]);t.table=a}).catch(function(){t.loading=!1})},load:function(){this.powerList()},addEvent:function(t){this.dialog.size="dialog-middle",this.dialog.id="",this.dialog.flag=!0,this.dialog.name=t.name,this.dialog.title=t.title},remove:function(t){var e=this;this.confirmPrompt().then(function(){e.$store.dispatch("deleteTerminalProtocolById",{id:t.row.id}).then(function(t){!t.flag&&t.errorCode?e.$message.error({message:e.$t("error."+t.errorCode)}):(e.load(),e.$message.success(e.$t("action.removeSuccess")))})})},modify:function(t){this.dialog.size="dialog-small",this.dialog.flag=!0,this.dialog.name="modify",this.dialog.title=this.$t("power.modify"),this.dialog.modify=t.row},add:function(){this.dialog.size="dialog-small",this.dialog.flag=!0,this.dialog.name="add",this.dialog.title=this.$t("power.add")},bing:function(t){this.dialog.size="dialog-small",this.dialog.flag=!0,this.dialog.name="bing",this.dialog.title=this.$t("power.bing"),this.dialog.bing=t.row}},created:function(){this.powerList()}},m=Object(o.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"port"},[a("cv-operation",[a("el-form-item",[a("cv-tool",{attrs:{name:t.$route.name,data:t.$store.getters.manageMenus,"is-modify":!1,"is-remove":!1,"is-search":!1,"is-export":!1},on:{add:t.add}})],1)],1),a("cv-content",[a("cv-grid",{ref:"table",attrs:{data:t.table,url:"/terminalProtocol/findTerminalProtocolList"}},[a("el-table-column",{attrs:{label:t.$t("companyManage.n"),prop:"name"}}),a("el-table-column",{attrs:{label:t.$t("dM.shortName"),prop:"alias"}}),a("el-table-column",{attrs:{label:t.$t("dM.remark"),prop:"remark"}}),a("el-table-column",{attrs:{label:t.$t("dM.protocol"),prop:"protocolVersion"}}),a("el-table-column",{attrs:{label:t.$t("UserManage.operation")},scopedSlots:t._u([{key:"default",fn:function(e){return[a("cv-span",{staticClass:"cv-span-success",nativeOn:{click:function(a){return t.modify(e)}}},[t._v(t._s(t.$t("power.modify")))]),a("cv-span",{staticClass:"cv-span-danger",nativeOn:{click:function(a){return t.remove(e)}}},[t._v(t._s(t.$t("power.remove")))]),a("cv-span",{staticClass:"cv-span-warning",nativeOn:{click:function(a){return t.bing(e)}}},[t._v(t._s(t.$t("power.bing")))])]}}])})],1)],1),a("el-dialog",{attrs:{visible:t.dialog.flag,title:t.dialog.title,"custom-class":t.dialog.size},on:{"update:visible":function(e){return t.$set(t.dialog,"flag",e)}}},[a(t.dialog.name,{tag:"component",attrs:{options:t.dialog},on:{confirm:t.load}})],1)],1)},[],!1,null,null,null).exports;m.install=function(t){t.component(m.name,m)},e.default=m},3015:function(t,e,a){},"5f65":function(t,e,a){"use strict";var i=a("cebb");a.n(i).a},cebb:function(t,e,a){},f1f2:function(t,e,a){"use strict";var i=a("3015");a.n(i).a}}]);