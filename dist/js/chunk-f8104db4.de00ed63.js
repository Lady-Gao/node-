(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-f8104db4"],{"0bfd":function(t,e,o){"use strict";var s=o("c879");o.n(s).a},1737:function(t,e,o){"use strict";o.r(e),o("7f7f");var s={props:{options:{}},data:function(){return{uploadForm:new FormData,tokens:{Accept:"application/json, text/plain",token:localStorage.getItem("token")},form:{versionName:"",focus:"",updateLog:"",type:"",insertVersion:"/csVersion/insertVersion"},fileList:[],rules:{versionName:[{required:!0,message:"不能为空",trigger:"blur,change"},{pattern:/^[0-9]+$/,message:"只能为数字"}],type:[{required:!0,message:"App类型",trigger:"blur,change"}],file:[{required:!0,message:"上传文件",trigger:"change"}]}}},created:function(){this.show(!0)},watch:{"options.flag":function(t){this.show(t)}},methods:{submitForm:function(){var t=this;if(this.$refs.forms.validate(function(e){if(!e)return!1;if("添加"==t.options.title){if(!(1<=t.fileList.length))return t.$message.error("请上传文件"),!1;t._uploadMethods.submit()}}),"修改"==this.options.title){var e={id:this.options.data.id,type:this.form.type,versionName:this.form.versionName||"",focus:this.form.focus,updateLog:this.form.updateLog||"",insertVersion:"/csVersion/insertVersion"};this.$store.dispatch("modifycsVersionG",e).then(function(e){e?(t.$message.warning("修改成功"),t.$emit("confirm"),t.options.flag=!1):t.$message.error(t.$t("error."+e.errorCode))})}},resetForm:function(){this.options.flag=!1,this.form.text=""},beforeRemove:function(t,e){return this.$confirm("确定移除 ".concat(t.name,"？"))},handleChange:function(t,e){this.fileList=e,0!=this.fileList.length&&(this.rules.file[0].required=!1)},show:function(t){this.fileList=[],"添加"==this.options.title&&t?(this.form={versionNo:"",versionName:"",groupName:"",focus:"0",updateLog:"",flie:""},this.rules.file[0].required=!0):"修改"==this.options.title&&t&&(this.form.versionNo=this.options.data.versionNo,this.form.versionName=this.options.data.versionName,this.form.groupName=this.options.data.groupName,this.form.type="win"==this.options.data.type?"win":"mac",this.form.focus=0==this.options.data.focus?"0":"1",this.form.updateLog=this.options.data.updateLog,this.form.url=this.options.data.url)},handleAvatarSuccess:function(t){if(!t.flag)return this.options.flag=!1,this.$message.error({message:this.$t("error."+t.errorCode)}),!1;this.$message.warning("上传成功"),this.options.flag=!1,this.$emit("confirm")}},computed:{_uploadMethods:function(){return this.$refs.upload},_formMethods:function(){return this.$refs.form}}},i=(o("0bfd"),o("2877")),r={data:function(){return{App:"",grid:{},dialog:{flag:!1,title:"search",size:"dialog-small",data:{App:"win"}},code:{flag:!1}}},computed:{table1:function(){return this.$refs.table1}},methods:{load:function(){this.table1.tableInitial()},addBtn:function(){this.dialog.title="添加",this.dialog.flag=!0},modify:function(t){this.dialog.title="修改",this.dialog.data=t,this.dialog.flag=!0},down:function(t){var e=this.$service.winParams(this.$COMMON.baseUrl+"/app/appVersion/downCs?id="+t.id);window.location.href=e}},components:{clientcomponent:Object(i.a)(s,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"forms",attrs:{model:t.form,"label-width":"80px",rules:t.rules,"label-position":"right"}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"versionName",label:"版本号"}},[o("el-input",{model:{value:t.form.versionName,callback:function(e){t.$set(t.form,"versionName",e)},expression:"form.versionName"}})],1)],1),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"App",label:"操作系统"}},[o("el-select",{attrs:{placeholder:"win/mac"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[o("el-option",{attrs:{label:"win",value:"win"}}),o("el-option",{attrs:{label:"mac",value:"mac"}})],1)],1)],1)],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"rules6",label:"强制更新"}},[o("el-select",{attrs:{placeholder:"是/否"},model:{value:t.form.focus,callback:function(e){t.$set(t.form,"focus",e)},expression:"form.focus"}},[o("el-option",{attrs:{label:"是",value:"1"}}),o("el-option",{attrs:{label:"否",value:"0"}})],1)],1)],1)],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:24}},["添加"==this.options.title?o("el-form-item",{attrs:{prop:"file",label:"上传文件"}},[o("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:t.$COMMON.baseUrl+"/csVersion/insertVersion",accept:".exe",drag:"","file-list":t.fileList,"auto-upload":!1,"on-success":t.handleAvatarSuccess,"on-change":t.handleChange,data:t.form,headers:t.tokens}},[o("i",{staticClass:"el-icon-upload"}),o("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),o("em",[t._v("点击上传")])])])],1):t._e()],1)],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:24}},[o("el-form-item",{attrs:{prop:"rules7",label:"发布说明"}},[o("el-input",{staticStyle:{width:"360px"},attrs:{type:"textarea",rows:"5"},model:{value:t.form.updateLog,callback:function(e){t.$set(t.form,"updateLog",e)},expression:"form.updateLog"}})],1)],1)],1),o("el-row",[o("el-col",{staticClass:"dialog-footer",attrs:{span:24}},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("form")}}},[t._v("确定")]),o("el-button",{on:{click:t.resetForm}},[t._v("取消")])],1)],1)],1)},[],!1,null,null,null).exports}},a=Object(i.a)(r,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("cv-operation",[o("el-form-item",[o("cv-tool",{attrs:{name:t.$route.name,data:t.$store.getters.manageMenus,"is-remove":!1,"is-modify":!1,"is-export":!1,"is-search":!1},on:{add:t.addBtn}})],1)],1),o("cv-content",[o("cv-grid",{ref:"table1",attrs:{params:t.grid,url:"/csVersion/getCsVersionsPage"}},[o("el-table-column",{attrs:{label:"版本号",prop:"versionName","min-width":"179"}}),o("el-table-column",{attrs:{label:"发布时间",prop:"publishTime","min-width":"179"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                 "+t._s(t.$filter.format(e.row.publishTime,"yyyy-MM-dd"))+"\n               ")]}}])}),o("el-table-column",{attrs:{label:"发布地址",prop:"url","min-width":"179"}}),o("el-table-column",{attrs:{label:"发布说明",prop:"updateLog","min-width":"179"}}),o("el-table-column",{attrs:{label:"强制更新",prop:"focus"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                 "+t._s(1==e.row.focus?"是":"否")+"\n               ")]}}])}),o("el-table-column",{attrs:{label:"操作系统"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("win"==e.row.type?"win":"mac"))]}}])}),o("el-table-column",{attrs:{label:"操作",prop:"1","min-width":"179"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("cv-span",{attrs:{type:"success"},nativeOn:{click:function(o){return t.modify(e.row)}}},[t._v("修改")]),o("cv-span",{attrs:{type:"success"},nativeOn:{click:function(o){return t.down(e.row)}}},[t._v("下载")])]}}])})],1)],1),o("el-dialog",{attrs:{visible:t.dialog.flag,title:t.dialog.title,"custom-class":t.dialog.size},on:{"update:visible":function(e){return t.$set(t.dialog,"flag",e)}}},[o("clientcomponent",{attrs:{options:t.dialog},on:{confirm:t.load}})],1)],1)},[],!1,null,null,null).exports;a.install=function(t){t.component(a.name,a)},e.default=a},c879:function(t,e,o){}}]);