(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4fdb3350"],{"1fe3":function(e,t,n){},3656:function(e,t,n){},"47a2":function(e,t,n){"use strict";var o=n("1fe3");n.n(o).a},"58af":function(e,t,n){"use strict";t.a={methods:{ocxInit:function(e,t){e.SetServerInfo(t.ipAddress,t.port,t.userLevel,t.replayPower,t.picCutPower,t.ytCtrlPower,t.MTpowerPower)},ocxRealtimePlay:function(e,t){e.StartRealTimeVideo(t.simCode,t.channel,t.StreamType,t.hasAudio)},ocxRealtimePlayXY:function(e,t){e.StartRealTimeVideoProtocolStandard(t.simCode,t.channel,t.dataType,t.StreamType)},ocxReplay:function(e,t){e.PlayBack_Utc(t.simCode,t.channel,t.MediaType,t.StreamType,t.StorageType,t.PlaybackMode,t.Multiple,t.StartTime,t.EndTime,t.DataSource)},ocxCloseVideo:function(e){e.StopAll()},ocxSpeaking:function(e,t){e.StartRTSpeaking(t.simCode.options.channel,t.StreamType)},ocxStopSpeaking:function(e){e.StopRTSpeaking()},ocxMonitor:function(e,t){e.StartMonitorVoice(t.simCode.options.channel,t.StreamType)},ocxStopMonitor:function(e){e.StopMonitorVoice()}}}},"5a4c":function(e,t,n){"use strict";var o=n("3656");n.n(o).a},"7ea6":function(e,t,n){"use strict";n.r(t);var o,i=n("cebc"),s=(n("3b2b"),n("ac6a"),n("96cf"),n("3b8d")),a=(n("a481"),n("c5f6"),n("b0ad")),r=n("2f62"),c={name:"CvFlyweight",props:{max:{type:Number,default:50},target:{type:String,default:"span"}},data:function(){return{toolPool:0}},computed:{_wrapper:function(){return this.$refs.wrapper}},methods:{createContent:function(e){if(this.toolPool<this.max){var t=this.createEl("li",{innerHTML:e});return this._wrapper.appendChild(t),t}var n=this._wrapper.children[0];return n.innerHTML=e,n},createEl:function(e,t){var n=document.createElement(e);return Object.getOwnPropertyNames(t).forEach(function(e){var o=t[e];n[e]=o}),n}}},l=n("2877"),d=Object(l.a)(c,function(){var e=this.$createElement;return(this._self._c||e)("ul",{ref:"wrapper",attrs:{id:"ul"}})},[],!1,null,null,null).exports,m={name:"alarm",mixins:[a.a],data:function(){return{activeName:"third",socket:null,urgentCount:"",middleCount:"",commonCount:"",taskData:"",directive:[],tooltipContent:"",onlineNumber:"",pushShow:!1,handlerClose:!0,timer:null,dom:{}}},components:{flyweight:d},computed:Object(i.a)({},Object(r.c)(["user"]),{token:function(){return localStorage.getItem("token")},_urgentMethods:function(){return this.$refs.urgent},_middleMethods:function(){return this.$refs.middle},_commonMethods:function(){return this.$refs.common}}),methods:Object(i.a)({},Object(r.b)(["alarmSingleNotarize","addDirective","onlineList","onlineNub","socketIsManage","socketIsVehicle","isAttention","setVideoMedia","outTask","socketInspector","Directive","socketIsPassenger","socketIsMessage","socketVidoeMessage"]),{handlerCommand:function(e){var t=this;this.$store.dispatch("alarmFlag",!1),e=Number(e),this.handlerClose=!1,e&&(this.timer=setTimeout(function(){t.handlerClose=!0,clearTimeout(t.timer),t.timer=null},1e3*e))},handlerClick:function(){this.handlerClose=!1,this.$store.dispatch("alarmFlag",!1)},decodeIE:function(e){if("string"==typeof e)return e;for(var t in e)e[t]=decodeURIComponent(e[t]);return e},alarmWebsocket:function(){var e=this,t=this.user,n=this.token;this.socket=io(this.$COMMON.socketUrl,{query:{token:n,language:localStorage.getItem("language"),userId:t.id}}),this.socket.on("connect",function(e){}),this.socket.on("t1",function(t){e._messageType(e.decodeIE(t)),e._alarmLevel(e.decodeIE(t))}),this.socket.on("t2",function(t){e._alarmMessageBox(e.decodeIE(t))}),this.socket.on("t3",function(t){e._videoBox(e.decodeIE(t))}),this.socket.on("s1",function(t){e.socketInspector(e.decodeIE(t))}),this.socket.on("f1",function(t){e.taskData++,e.outTask(e.taskData)})},_alarmMessageBox:function(e){this.socketIsMessage(this.decodeIE(e))},_videoBox:function(e){this.socketVidoeMessage(e)},_alarmLevel:function(e){this.pushShow=!0;var t,n=this._urgentMethods,o=this._middleMethods,i=this._commonMethods,s=this._template;switch(Number(e.alarmLevel)){case 0:this.pushShow=!0,this.urgentCount++,t=n.createContent(s(e));break;case 1:this.pushShow=!0,this.middleCount++,t=o.createContent(s(e));break;case 2:this.pushShow=!0,this.commonCount++,t=i.createContent(s(e))}t.mess=e},openWind:function(e){var t;1==e.platform?t=this.$router.resolve({path:"/monitor/alarmHandle",query:{vehicleId:e.vehicleId,time:e.time,alarmTypeId:e.alarmTypeId}}):5!=e.platform&&6!=e.platform||(t=this.$router.resolve({path:"/monitor/AssistantAriving",query:{vehicleId:e.vehicleId,time:e.time,alarmTypeId:e.alarmTypeId}})),window.open(t.href,"_blank")},_template:function(e){var t=this,n=JSON.stringify(e),o='\n                <div class="cv-row">\n                    <span class="cv-col theader-item1 notice-item">{{plateCode}}</span>\n                    <span class="cv-col theader-item2 notice-item">{{messageText}}</span>\n                    <span class="cv-col theader-item3 notice-item">'.concat(e.time.slice(5),'</span>\n                    <span class="cv-col theader-item4 notice-item">{{alarmTypeName}}</span>\n                    <a class="cv-col theader-item5 notice-item" v-if>').concat(this.$t("home.confirm")," </a>\n                </div>\n            ");return o=o.replace(/<(.*)v-if(.+)(<\/[\w]+>)/g,function(o,i){return"1"==e.action?"<a class='cv-col cv-col-4 notice-item notice-item-confirm' mess='".concat(n,"'>").concat(t.$t("home.confirm"),"</a>"):"\x3c!----\x3e"}),this._compileTemplate(o,e)},mouseenterHandler:function(e){this.$myJq.delegation(e,"SPAN")&&(this.tooltipContent=this.mouseenterShowTip(e,"tooltip"))},handlerEvent:(o=Object(s.a)(regeneratorRuntime.mark(function e(t){var n,o,i,s,a,r,c,l,d,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.$myJq.delegation(t,"A"))){e.next=20;break}if(o=this.$message,i=o.success,s=o.error,a=JSON.parse(n.getAttribute("mess")),r=a.simCode,c=a.serialNumber,l=a.alarmTypeId,n.loading){e.next=18;break}return e.prev=5,n.loading=!0,e.next=9,this.alarmSingleNotarize({serialNumber:c,alarmTypeId:l,sim:r});case 9:d=e.sent,m=d.flag,n.loading=!1,m?i(this.$t("action.noticeSuccess")):s(this.$t("action.noticeFail")),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),e.t0(this.$t("action.noticeFail"));case 18:e.next=21;break;case 20:t.path[2].mess&&this.openWind(t.path[2].mess);case 21:case"end":return e.stop()}},e,this,[[5,15]])})),function(e){return o.apply(this,arguments)}),_compileTemplate:function(e,t){if(this.$service.isObject(t)){var n=e;return Object.getOwnPropertyNames(t).forEach(function(e){var o=new RegExp("{{"+e+"}}","g");n=n.replace(o,t[e])}),n}},_messageType:function(e){switch(this.pushShow=!0,e.msgType){case"W":this.directive.unshift(e),this.addDirective(this.directive),this.Directive(e);break;case"O":this.pushShow=!0,this.onlineNumber++,this.onlineList(e),this.onlineNub(this.onlineNumber);break;case"ENTERPRISE_FLEET_MSG":return this.socketIsManage(e);case"VehicleMsg":return this.socketIsVehicle(e);case"attentionMsg":return this.isAttention(e);case"M":return this.setVideoMedia(e);case"passengerFlow":return this.socketIsPassenger(e)}}}),destroyed:function(){this.socket&&this.socket.disconnect()},mounted:function(){this.token&&this.alarmWebsocket()},watch:{"$store.getters.alarmFlag":function(e){e&&(this.pushShow=!0,this.handlerClose=!0)}}},u=(n("5a4c"),Object(l.a)(m,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.handlerClose&&e.pushShow,expression:"handlerClose && pushShow"}],staticClass:"cv-bottomalarm"},[n("div",{staticClass:"cv-bottomalarm-header"},[n("cv-icon",{staticClass:"cv-bottomalarm-close",attrs:{name:"remove",color:"#fff"},nativeOn:{click:function(t){return e.handlerClick(t)}}}),n("el-dropdown",{staticStyle:{float:"right"},attrs:{trigger:"click"},on:{command:e.handlerCommand}},[n("cv-icon",{staticClass:"cv-bottomalarm-setting",attrs:{name:"xitong9",color:"#fff"}}),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"15"}},[e._v(e._s(e.$t("home.fifteenSeconds")))]),n("el-dropdown-item",{attrs:{command:"30"}},[e._v(e._s(e.$t("home.thirtySeconds")))]),n("el-dropdown-item",{attrs:{command:"600"}},[e._v(e._s(e.$t("home.tenMinutes")))]),n("el-dropdown-item",{attrs:{command:"0"}},[e._v(e._s(e.$t("home.temporarilyClosed")))])],1)],1)],1),n("el-tooltip",{ref:"tooltip",attrs:{content:e.tooltipContent,placement:"top",effect:"light"}}),n("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("el-row",{staticClass:"cv-bottomalarm-theader",staticStyle:{background:"#dfe6ec"}},[n("span",{staticClass:"theader-item1 cv-col notice-item"},[e._v(e._s(e.$t("cL.carNumber")))]),n("span",{staticClass:"theader-item2 cv-col notice-item"},[e._v(e._s(e.$t("home.msginfo")))]),n("span",{staticClass:"theader-item3 cv-col notice-item"},[e._v(e._s(e.$t("processing.time")))]),n("span",{staticClass:"theader-item4 cv-col notice-item"},[e._v(e._s(e.$t("processing.type")))]),n("span",{staticClass:"theader-item5 cv-col notice-item"},[e._v(e._s(e.$t("action.operation")))])]),n("el-tab-pane",{attrs:{name:"first"}},[n("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                "+e._s(e.$t("common.alarm.serious"))+"\n        \t    "),n("el-badge",{attrs:{value:e.urgentCount,max:99}})],1),n("flyweight",{ref:"urgent",staticClass:"cv-bottomalarm-flyweight",nativeOn:{mouseover:function(t){return e.mouseenterHandler(t)},mouseout:function(t){return e.mouseoverHideTip("tooltip")},click:function(t){return e.handlerEvent(t)}}})],1),n("el-tab-pane",{attrs:{name:"second"}},[n("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                "+e._s(e.$t("common.alarm.intermediate"))+"\n        \t    "),n("el-badge",{attrs:{value:e.middleCount,max:99}})],1),n("flyweight",{ref:"middle",staticClass:"cv-bottomalarm-flyweight",nativeOn:{mouseover:function(t){return e.mouseenterHandler(t)},mouseout:function(t){return e.mouseoverHideTip("tooltip")},click:function(t){return e.handlerEvent(t)}}})],1),n("el-tab-pane",{attrs:{name:"third"}},[n("span",{attrs:{slot:"label"},slot:"label"},[e._v("\n                "+e._s(e.$t("common.alarm.ordinary"))+"\n        \t    "),n("el-badge",{attrs:{value:e.commonCount,max:99}})],1),n("flyweight",{ref:"common",staticClass:"cv-bottomalarm-flyweight",nativeOn:{mouseover:function(t){return e.mouseenterHandler(t)},mouseout:function(t){return e.mouseoverHideTip("tooltip")},click:function(t){return e.handlerEvent(t)}}})],1)],1)],1)},[],!1,null,null,null).exports),h={props:{options:{}},mixins:[""],data:function(){return{info:""}},methods:{answer:function(){var e=this;if(""==this.info)return this.$message.warning("请输入应答内容"),!1;var t={userId:this.$store.getters.user.id,answer:this.info,inspectId:this.options.mess.inspectId,inspectType:Number(this.options.mess.inspectType),enterpriseId:this.$store.getters.user.enterpriseId,answerTime:this.$filter.format(new Date,"yyyy-MM-dd HH:mm:ss"),infoId:this.options.mess.infoId,superPlatId:this.options.mess.superPlatId,inspectPostId:this.options.mess.userIdAndInspectPostId[this.$store.getters.user.id]};this.$http({url:"/inspectTheSentry/insertInspectSentryAnswer",params:t}).then(function(t){t.flag&&(e.options.flag=!1,e.options.name="")}),this.$http({url:"/inspectTheSentry/sendInspectSentryAnswer",params:t}).then(function(t){t.flag&&(e.options.flag=!1,e.options.name="")})}},mounted:function(){},watch:{"options.flag":function(e){e||(this.options.name="")}}},p=Object(l.a)(h,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("span",[e._v("查岗内容:"+e._s(e.options.mess.message))]),n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.info,expression:"info",modifiers:{trim:!0}}],staticStyle:{width:"100%",display:"block","text-indent":"1em","box-sizing":"border-box",padding:"5px"},attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:e.info},on:{input:function(t){t.target.composing||(e.info=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),n("el-button",{staticStyle:{float:"right",margin:"20px 0"},attrs:{type:"primary"},on:{click:e.answer}},[e._v("回复")])],1)},[],!1,null,null,null).exports,f=n("c2aa").a,v=(n("47a2"),{name:"index",components:{vHeader:function(){return n.e("chunk-9279735a").then(n.bind(null,"e1da"))},bestNotice:u,inspectAnswer:p,mtindexVideo:Object(l.a)(f,function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"vBox",attrs:{id:"videoPort"}},[t("object",{attrs:{id:"video",codebase:this.$COMMON.ocxLib,classid:"clsid:f3943464-829d-4bb8-8b05-10516831ceed"}})])},[],!1,null,null,null).exports},data:function(){return{dialog:{flag:!1,title:this.$t("home.lookupResponse"),size:"dialog-small",name:"inspectAnswer",mess:{}},isActive:!1}},methods:{tog:function(e){this.isActive=!e}},computed:Object(i.a)({},Object(r.c)(["menuTitle"]),{menus:function(){return this.$store.state.mtindex.menus},searchList:function(){return this.$store.state.mtindex.searchList}}),mounted:function(){this.$store.dispatch("mtgetMenus")},watch:{"dialog.flag":function(e){var t=this;e||setTimeout(function(e){t.dialog.name=""},2e3)},"$store.getters.socketInspector":function(e){e&&(this.dialog.flag=!0,this.dialog.name="inspectAnswer",this.dialog.mess=e)},"$store.getters.socketMessage":function(e){this.$notify({title:this.$t("companyManage.tip3"),type:"warning",message:this.$t("companyManage.tip6"),duration:0})},"$store.getters.socketVidoeMessage":function(e){if(e){if(!this.$service.isIe())return void this.$message.warning("有新的推送！请使用IE浏览器查看");this.dialog.flag=!0,this.dialog.title=this.$t("multiCar.video"),this.dialog.size="dialog-large",this.dialog.name="mtindexVideo",this.dialog.mess=e}}}}),g=(n("d373"),Object(l.a)(v,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"myIndex"},[n("v-header"),n("best-notice",{staticClass:"cv-alarm"}),n("div",{staticClass:"nav"},[n("el-breadcrumb",{staticClass:"cv-breadcrumb",attrs:{separator:"/"}},[n("el-breadcrumb-item",{attrs:{to:{path:e.$route.path}}},[e._v(e._s(e.menuTitle))])],1)],1),n("transition",{attrs:{name:"el-fade-in"}},[n("router-view",{staticClass:"contents",style:{top:""==e.menuTitle?"60px":""},attrs:{id:"contents"}})],1),n("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[n(e.dialog.name,{tag:"component",attrs:{options:e.dialog}})],1)],1)},[],!1,null,null,null).exports);t.default=g},b0ad:function(e,t,n){"use strict";(function(e){n("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var n=this,o=e||this.$t("action.confirmIsRemove");return new Promise(function(e,i){n.$confirm(o,n.$t("action.tip"),{confirmButtonText:n.$t("action.confirm"),cancelButtonText:n.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,n){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=n||this.$message.error({message:this.$t("请选择时间范围在"+n+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,n){var o=e.length,i=t.length;return i<o?{name:"add",data:this.$service.isUnique(e,t,n)}:o<i?{name:"remove",data:this.$service.isUnique(t,e,n)}:o==i?{name:"equal",data:this.$service.isUnique(e,t,n)}:void 0},showTooltip:function(e,t){var n=e.target,o=this.$refs[t];o.referenceElm=n,o.$refs.popper.style.display="none",o.doDestroy(),o.setExpectedState(!0),o.handleShowPopper()},mouseenterShowTip:function(e,t,n){var o=e.target;if(o.scrollWidth>o.offsetWidth||n)return this.showTooltip(e,t),n?n.startTime+"~"+n.endTime:o.innerText},mouseenterShowToolTip:function(e,t,n){var o=e.target;return this.showTooltip(e,t),!n&&o.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,n){var o=this,i=0<arguments.length&&void 0!==t?t:"Baidu",s=1<arguments.length?n:void 0;return e[i]?e[i]._preloader?e[i]._preloader:Promise.resolve(e[i]):(e[i]={},e[i]._preloader=new Promise(function(t,n){var a=document.createElement("script");a.src=s,e.document.body.appendChild(a),o.$service.isIe()&&o.$service.IE_VERSION<11?a.onreadystatechange=function(){"loaded"!=a.readyState&&"complete"!=a.readyState||(t(e[i]),e[i]._preloader=null)}:a.onload=function(){t(e[i]),e[i]._preloader=null}}),e[i]._preloader)}}}}).call(this,n("c8ba"))},c2aa:function(e,t,n){"use strict";(function(e){var o=n("58af");t.a={props:{options:{}},mixins:[o.a],data:function(){return{}},methods:{play:function(){var e={ipAddress:this.options.mess.ipAddress,port:this.options.mess.port,userLevel:this.$store.getters.user.userLevel,MTpowerPower:!0,picCutPower:!0,replayPower:!0,ytCtrlPower:!0};this.ocxInit(document.getElementById("video"),e),document.getElementById("video").SetOrResetVideos(1),document.getElementById("video").SetOperationIndex(0),document.getElementById("video").StartRealTimeVideo(this.options.mess.simCode,this.options.mess.channelCount,1,!0)}},watch:{"options.flag":function(e){if(!e){var t=document.getElementById("video");t.SetOperationIndex(0),this.ocxCloseVideo(t)}}},mounted:function(){var t=this;[{target:"video",id:"openV",event:"OnControlDoubleClickEvent(id,isFullScreen)",inContext:"isFullScreen ? document.getElementById('videoPort').className=\"fullWindow\" : (document.getElementById('videoPort').className=\"vBox\",document.getElementById('video').ResizeControl(600,400));"}].forEach(function(t){var n=document.createElement("script");n.setAttribute("for",t.target),n.id=t.id,n.event=t.event,n.textContent=t.inContext,e.document.body.appendChild(n)}),setTimeout(function(){t.play()},2e3)},beforeDestroy:function(){var t=document.getElementById("openV");e.document.body.removeChild(t)}}}).call(this,n("c8ba"))},d373:function(e,t,n){"use strict";var o=n("e287");n.n(o).a},e287:function(e,t,n){}}]);