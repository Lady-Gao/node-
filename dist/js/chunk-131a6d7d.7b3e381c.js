(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-131a6d7d"],{1072:function(t,e,a){},1885:function(t,e,a){},8730:function(t,e,a){"use strict";var i=a("1072");a.n(i).a},"8ba4":function(t,e,a){"use strict";a.r(e),a("7f7f"),a("ac6a"),a("7514");var i=a("d225"),s=a("b0b4"),n=a("bd86"),r=(a("1885"),{width:30,startPosition:10,endPosition:90,vals:["你好","我好","大家好"],bgs:["red","blue","yellow"],styleUrl:""}),o=function(){function t(e,a){return Object(i.a)(this,t),Object(n.a)(this,"barsEvent",function(){var t=this;this.poster.on("mousedown",".bars",function(e){t.getPosition(e.pageX);var a=$(this);t.bars.removeClass("on"),a.addClass("on"),$(document).on("mousemove",function(e){!function(e,a){var i=t.getPosition(e.pageX);t.getPrecentArr(),t.limitEvent(i,a)}(e,a)}),$(document).on("mouseup",function(){t.getPrecentArr(),$(document).off("mousemove mouseup")})})}),Object(n.a)(this,"sliderEvent",function(t){var e=this;this.poster.on("click",function(t){var a=e.getPosition(t.pageX),i=function(){var t;return e.bars.each(function(){$(this).hasClass("on")&&(t=$(this))}),t}();void 0!==i&&(e.limitEvent(a,i),e.getPrecentArr())})}),Object(n.a)(this,"inputWatch",function(){var t=this,e=/^(\d{1}|[1-9]\d{1}|100)$/;this.poster.on("input propertychange","input",function(){var a=$(this),i=a.parent().parent(),s=function(t){var e="",a=t.val();return e=3<=a.length?100==a?a:a.substr(0,2):a,t.val(e),e}(a);e.test(s)&&(t.getDistance(i,s),t.getPrecentArr())})}),this.poster=e,this.max=100,this.opts=$.extend(!0,r,a),this.maxWidth=e.width(),this.maxDistance=this.maxWidth,this}return Object(s.a)(t,[{key:"init",value:function(){return this.createDom(),this.initPosition(this.opts.startPosition,this.opts.endPosition),this.eventGroup(),this}},{key:"eventGroup",value:function(){this.barsEvent(),this.sliderEvent(),this.inputWatch()}},{key:"createDom",value:function(){for(var t=this,e='<ul class="area"><li>'+this.opts.vals[0]+"</li><li>"+this.opts.vals[1]+"</li><li>"+this.opts.vals[2]+"</li></ul>",a=0;a<2;a++)t.poster.append('<div class="bars"><div class="tip"><input type="text"></div></div>');this.poster.append(e),this.areas=this.poster.find(".area li"),this.bars=this.poster.find(".bars"),this.startBar=this.bars.eq(0),this.endBar=this.bars.eq(1)}},{key:"initPosition",value:function(t,e){return this.getDistance(this.startBar,t),this.getDistance(this.endBar,e),this.getPrecentArr(),this}},{key:"getDistance",value:function(t,e){var a=this.maxWidth/this.max,i=t.find(".tip");t.css("left",a*e-this.opts.width/2),this.getPrecent(i,a*e)}},{key:"getPrecent",value:function(t,e){var a=this.max/this.maxWidth,i=Math.floor(a*e);t.find("input").val(i)}},{key:"getPrecentArr",value:function(){var t,e,a,i,s,n=this,r=$(".tip"),o=[];function l(t){return n.maxWidth/n.max*t}r.each(function(){var t=parseInt($(this).find("input").val());o.push(t)}),this.poster.attr("enter",JSON.stringify([Math.min(o[0],o[1]),Math.max(o[0],o[1])])),t=o,e=[],a=l(Math.min(t[0],t[1])),i=l(Math.max(t[0],t[1])-Math.min(t[0],t[1])),s=l(n.max-Math.max(t[0],t[1])),e[0]=a,e[1]=i,e[2]=s,n.areas.each(function(t){$(this).css({width:e[t],background:n.opts.bgs[t]})})}},{key:"limitEvent",value:function(t,e){var a=0;a=t<=0?0:t>=this.maxDistance?this.maxDistance:t,e.css("left",a-this.opts.width/2),this.getPrecent(e.find(".tip"),a)}},{key:"getPosition",value:function(t){return t-this.poster.offset().left}}]),t}(),l={props:{options:{}},data:function(){return{showFrom:{list:[]},submitFalg:!1}},watch:{"options.flag":function(t){t||(this.options.name="")}},methods:{save:function(){var t=this,e=this.getData();this.submitFalg=!0,this.$store.dispatch("bearingCalibration",e).then(function(e){e.flag?(t.$message.success("标定成功"),t.options.flag=!1,t.$emit("tableLoad")):t.$message.error(t.$t("error."+e.errorCode)),t.submitFalg=!1})},getData:function(){var t=this.showFrom.list,e=[],a=JSON.parse($(".sliderbar").attr("enter"));return t.forEach(function(t){var a={id:t.id,fullVal:t.fullVal,emptyVal:t.emptyVal};e.push(a)}),{id:this.options.id,parameterList:e,lowVal:a[0],highVal:a[1]}}},mounted:function(){this.slider=new o($(".sliderbar"),{vals:["轻载","半载","重载"],bgs:["#0ae68b","#00cbff","#ff3400"]}),this.slider.init(),this.slider.initPosition(this.options.arryDataList.lowVal,this.options.arryDataList.highVal),this.showFrom.list=this.options.arryDataList.parameterList}},c=(a("8730"),a("2877")),h={components:{add:Object(c.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bearingMark-scrollbar"},[t._m(0),a("div",[a("div",{staticClass:"header"},[t._v("设置标定值")]),a("el-row",{staticClass:"list-header"},[a("el-col",{staticStyle:{"text-align":"right"},attrs:{span:12}},[a("span",[t._v("空载标定(%)")])]),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:12}},[a("span",[t._v("满载标定(%)")])])],1),a("el-form",{attrs:{model:t.showFrom,"label-width":"130px"}},t._l(t.showFrom.list,function(e){return a("el-form-item",{key:e.id,attrs:{label:e.id+"号传感器"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.emptyVal,callback:function(a){t.$set(e,"emptyVal",a)},expression:"item.emptyVal"}}),a("el-input",{attrs:{placeholder:""},model:{value:e.fullVal,callback:function(a){t.$set(e,"fullVal",a)},expression:"item.fullVal"}})],1)}),1)],1),a("div",{staticClass:"dialog-footer"},[a("el-button",{attrs:{type:"primary",loading:t.submitFalg},on:{click:t.save}},[t._v(t._s(t.$t("action.confirm")))]),a("el-button",{on:{click:function(e){t.options.flag=!1}}},[t._v(t._s(t.$t("action.cancel")))])],1)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticClass:"header"},[this._v("设置阈值")]),e("div",{staticClass:"sliderbar"})])}],!1,null,"730241d7",null).exports},created:function(){var t=this;this.$http({url:"/enterprise/getEnterpriseTreeList"}).then(function(e){!e.flag&&e.errorCode?t.$message.error({message:t.$t("error."+e.errorCode)}):(t.companyTree=e.data,t.treeFlag=!1)})},data:function(){return{companyTree:[],vehicle_tree:null,table:{data:[],loading:!1},dialog:{flag:!1,title:"手动标定",size:"dialog-small",name:"",id:"",arryDataList:[]},buttonFlag:!1,vehicleId:"",bearingStr:"--",bearingLevelColor:"green"}},methods:{treeLoaded:function(){this.treeLoadFlag=!1},handlerMonitor:function(t){this.vehicleId=t.id},add:function(){if(!this.vehicleId)return this.$message.warning("请选择车辆"),!1;0<this.table.data.length?(this.dialog.flag=!0,this.dialog.name="add",this.dialog.id=this.vehicleId):this.$message.warning("列表数据为空")},addMark:function(){var t=this;if(!this.vehicleId)return this.$message.warning("请选择车辆"),!1;if(0<this.table.data.length){var e=this.getData();this.buttonFlag=!0,this.$store.dispatch("bearingCalibration",e).then(function(e){e.flag?t.$message.success("标定成功"):t.$message.error(t.$t("error."+e.errorCode)),t.buttonFlag=!1})}else this.$message.warning("列表数据为空")},getData:function(){var t=this.table.data,e=[];return t.forEach(function(t){var a={id:t.id,fullVal:t.fullVal};e.push(a)}),{id:this.vehicleId,parameterList:e}},tableLoad:function(){var t=this,e={id:this.vehicleId};this.table.loading=!0,this.$store.dispatch("queryBearingConfi",e).then(function(e){e.flag?(t.dialog.arryDataList=e.data,t.table.data=e.data.parameterList,t.bearingStr=e.data.bearingStr,t.bearingLevelColor=t.getTextColor(e.data.bearingLevel)):t.table.data=[],t.table.loading=!1})},getTextColor:function(t){switch(t){case 0:return"green";case 1:return"blue";case 2:return"orange";case 3:return"red"}}},watch:{}},u=(a("ef4f"),Object(c.a)(h,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"bearingMark-list"},[a("cv-operation",[a("el-form-item",[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.buttonFlag,expression:"buttonFlag"}],attrs:{type:"",size:"small"},nativeOn:{click:function(e){return t.addMark(e)}}},[t._v("快捷标定")])],1),a("el-form-item",[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.buttonFlag,expression:"buttonFlag"}],attrs:{type:"",size:"small"},nativeOn:{click:function(e){return t.add(e)}}},[t._v("手动标定")])],1)],1),a("cv-content",[a("div",{attrs:{slot:"aside"},slot:"aside"},[a("el-input",{attrs:{placeholder:t.$t("companyManage.ph")},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),a("cv-scrollbar",{directives:[{name:"loading",rawName:"v-loading",value:t.treeLoadFlag,expression:"treeLoadFlag"}],class:[t.treeLoadFlag?"scrollW1":"scrollW2"]},[a("cv-tree",{ref:"companyTree",staticStyle:{height:"100%"},attrs:{data:t.companyTree,"tree-loaded":t.treeLoaded},on:{"node-click":t.handlerMonitor}})],1)],1),a("cv-grid",{attrs:{params:{},url:"/vehicleBearing/queryBearingConfig"}},[a("el-table-column",{attrs:{label:"传感器",prop:"id"}}),a("el-table-column",{attrs:{label:"当前承重(%)",prop:"original"}}),a("el-table-column",{attrs:{label:"空载标定(%)",prop:"emptyVal"}}),a("el-table-column",{attrs:{label:"满载标定(%)",prop:"fullVal"}}),a("el-table-column",{attrs:{label:"实际承重(%)",prop:"real"}})],1),a("div",{staticClass:"textColor"},[a("span",[t._v("车辆承重:")]),a("span",{class:t.bearingLevelColor},[t._v(t._s(t.bearingStr))])])],1),a("el-dialog",{attrs:{visible:t.dialog.flag,title:t.dialog.title,"custom-class":t.dialog.size},on:{"update:visible":function(e){return t.$set(t.dialog,"flag",e)}}},[a(t.dialog.name,{tag:"component",attrs:{options:t.dialog},on:{confirm:function(e){return t.tableLoad(!0)}}})],1)],1)},[],!1,null,null,null).exports);u.install=function(t){t.component(u.name,u)},e.default=u},a127:function(t,e,a){},ef4f:function(t,e,a){"use strict";var i=a("a127");a.n(i).a}}]);