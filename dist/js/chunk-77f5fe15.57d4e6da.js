(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-77f5fe15"],{"1ea3":function(a,e,t){"use strict";t.r(e),t("ac6a");var i=t("cebc"),l=t("e7c5"),r=t("afa1"),o=t("4728"),s=t("2f62"),n={components:{scrollbarPagination:r.a,vehicleMessage:o.a,cvMaptool:l.default},mixins:[],computed:Object(i.a)({},Object(s.c)(["mapName"]),{_mapMethods:function(){return this.$refs.map.mapMethods}}),data:function(){return{mapInitial:!1,current:null,MarkerClusterer:null,mapAllPoint:[],loadFlag:!1,rectangle:null,location:"",vehicleIds:[],scrollPageData:[],allData:[],scurrent:0,pointMarkers:{},vehicleData:{},currentId:null,popover:{flag:!1},isFull:!1}},methods:{mapReady:function(){this.mapInitial=!0},Addrectangle:function(){var a=this;this._mapMethods.clearOverlays(),this._mapMethods.markerClustererClearAll(),this.scurrent=0,this.allData=[],this.vehicleIds=[],this.pointMarkers={},this.mapAllPoint=[],this.vehicleData={},this.popover.flag=!1,this._mapMethods.onclickRectangle(function(e){a.rectangle=e.overlay;var t={minLongitude:parseInt(1e6*e.params.minLng),minLatitude:parseInt(1e6*e.params.minLat),maxLongitude:parseInt(1e6*e.params.maxLng),maxLatitude:parseInt(1e6*e.params.maxLat),mapType:a.$store.getters.mapType};a.loadFlag=!0,a.$store.dispatch("findAreaDelimitedQueryLocationListInfo",t).then(function(e){if(e.flag&&0!=e.data.length){e.data.forEach(function(e){a.vehicleIds.push(e.id)});var t=a.vehicleIds.join(",");a.$store.dispatch("getMultiVehicleLastLocationList",{vehicleIds:t,mapType:a.$store.getters.mapType}).then(function(e){if(!e.flag)return a.$message.error({message:a.$t("error."+e.errorCode)}),a.loadFlag=!1,a._mapMethods.clearOverlays(),!1;a.allData=e.data,e.data.forEach(function(e){var t={};t.latitude=e.mapLatitude,t.longitude=e.mapLongitude;var i=a._mapMethods.point(t),l=a._mapMethods.mapAddpoint(t,a.$filter.isOnline(e,!1,a.$store.getters.mapName));setTimeout(function(){l.label=a._mapMethods.addLabel(l,e.plateCode)}),a._mapMethods.addEventListener(l,"click",function(){a.popover.flag=!0,a.vehicleData=e,l.label.setStyle({backgroundColor:"black",color:"#fff"}),a.currentId=e.vehicleId,l.setTop(!0),a._mapMethods.moveToCenter(i,20)}),a.mapAllPoint.push(l),a.pointMarkers[e.vehicleId]=l}),a._mapMethods.markerClustererAddMarkers(a.mapAllPoint),a._mapMethods.getBestView(a.mapAllPoint),a._mapMethods.removeOverlay(a.rectangle),a.loadFlag=!1})}else a.$message.warning("暂无数据"),a._mapMethods.removeOverlay(a.rectangle),a.loadFlag=!1}).catch(function(){a.$message.error("网络错误"),a._mapMethods.removeOverlay(a.rectangle),a.loadFlag=!1})})},paginationClick:function(a){var e=this._mapMethods.point({lat:a.mapLatitude,lng:a.mapLongitude});this._mapMethods.moveToCenter(e,20),this.pointMarkers[a.vehicleId].label.setStyle({backgroundColor:"black",color:"#fff"}),this.pointMarkers[a.vehicleId].setTop(!0),this.vehicleData=a,this.currentId=a.vehicleId,this.popover.flag=!0}},watch:{}},c=(t("3e50"),t("2877")),p=Object(c.a)(n,function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"SFTL"},[t(a.mapName,{directives:[{name:"loading",rawName:"v-loading",value:a.loadFlag,expression:"loadFlag"}],ref:"map",tag:"component",staticClass:"maps",attrs:{zooms:[4,18],"element-loading-text":a.$t("role.type1"),mapLoaded:a.mapReady}}),t("cv-lazy-render",{attrs:{immediate:a.mapInitial,transition:"top"}},[t("cv-maptool",{staticClass:"tool",attrs:{"map-target":a.$refs.map,layout:["tool","search","bestview","fullscreen"],markers:a.mapAllPoint}},[t("el-button",{attrs:{type:"text"},on:{click:a.Addrectangle}},[a._v(a._s(this.$t("searchForTimeAndLocation.searchV")))])],1)],1),t("cv-lazy-render",{attrs:{immediate:a.mapInitial,transition:"right"}},[t("vehicle-message",{staticStyle:{top:"0px",right:"5px"},attrs:{data:a.vehicleData,"is-show":a.popover}})],1),t("cv-lazy-render",{attrs:{immediate:a.mapInitial,transition:"bottom"}},[t("scrollbar-pagination",{staticClass:"track-list",attrs:{all:a.allData,"current-id":a.currentId},on:{position:a.paginationClick}})],1)],1)},[],!1,null,null,null).exports;e.default=p},"3e50":function(a,e,t){"use strict";var i=t("65aa");t.n(i).a},"65aa":function(a,e,t){}}]);