(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a4265824"],{"015a":function(t,e,i){},"44ba":function(t,e,i){"use strict";var a=i("015a");i.n(a).a},"55af":function(t,e,i){},"59f4":function(t,e,i){},"624c":function(t,e,i){"use strict";var a=i("59f4");i.n(a).a},6470:function(t,e,i){"use strict";i.r(e),i("7f7f"),i("ac6a"),i("96cf");var a,n,r=i("3b8d"),l=i("cebc"),o=i("2f62"),s={name:"allCheck",mixins:[{methods:{dispatch:function(t,e,i){for(var a=this.$parent||this.$root,n=a.$options.componentName;a&&(!n||n!==t);)(a=a.$parent)&&(n=a.$options.componentName);a&&a.$emit.apply(a,[e].concat(i))},broadcast:function(t,e,i){(function t(e,i,a){this.$children.forEach(function(n){n.$options.componentName===e?n.$emit.apply(n,[i].concat(a)):t.apply(n,[e,i].concat([a]))})}).call(this,t,e,i)}}}],props:{data:{},allChecked:{},checkDisabled:!1},data:function(){return{checked:[],checkAll:!1,isIndeterminate:!1}},methods:{handleCheckAll:function(t){var e=[];this.data.Items.forEach(function(t){e.push(t.id)}),this.checked=t?e:[],this.isIndeterminate=!1,this.$emit("checked",{id:this.data.menuId,checked:this.checked})},handleChecked:function(t){this.$emit("checked",{id:this.data.menuId,checked:this.checked});var e=t.length;this.checkAll=e===this.data.Items.length,this.isIndeterminate=0<e&&e<this.data.Items.length}},mounted:function(){this.data.checked&&(this.checked=this.data.checked,this.data.checked.length==this.data.Items.length?this.isIndeterminate=!1:this.isIndeterminate=!0)}},c=(i("44ba"),i("2877")),u={props:{fleetid:{},routeId:{},clear:{}},components:{allCheck:Object(c.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cv-allCheck"},[i("el-checkbox",{ref:"allCheck",staticClass:"allCheck",attrs:{label:t.data.title,indeterminate:t.isIndeterminate},on:{change:t.handleCheckAll},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v(t._s(t.data.title))]),i("el-checkbox-group",{staticClass:"checkGroup",attrs:{disabled:t.checkDisabled},on:{change:t.handleChecked},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},t._l(t.data.Items,function(e){return i("el-checkbox",{key:e.name,attrs:{label:e.id,disabled:t.checkDisabled}},[t._v(t._s(e.name))])}),1)],1)},[],!1,null,null,null).exports},mixins:[""],created:function(){this.getVehicleTree(this.fleetid)},data:function(){return{readonly:!1,toggleFlag:!1,contents:"",search:"",vehicleData:{title:"全部",menuId:0,Items:[],checked:[]}}},methods:Object(l.a)({},Object(o.b)(["queryVehiclesByFleet"]),{toggle:function(){this.toggleFlag=!this.toggleFlag},outHide:function(){this.toggleFlag=!1},GetCheckedVal:function(t){var e=this,i=[],a=[];a.push({vehicleIds:t.checked.join(","),id:this.routeId}),t.checked.forEach(function(t){e.vehicleData.Items.forEach(function(e){e.id==t&&i.push(e.name)})}),this.contents=i.join(","),this.$emit("update:coverParams",a)},getVehicleTree:(a=Object(r.a)(regeneratorRuntime.mark(function t(e){var i,a,n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=[],t.next=3,this.queryVehiclesByFleet({fleetId:e});case 3:a=t.sent,n=a.flag,r=a.data,n&&r&&r.forEach(function(t){i.push({name:t.plateCode,id:t.vehicleId})}),this.vehicleData.Items=i;case 8:case"end":return t.stop()}},t,this)})),function(t){return a.apply(this,arguments)})}),watch:{fleetid:function(t){this.getVehicleTree(t)},clear:function(t){t&&(this.contents="",this.$emit("update:clear",!1))}}},d=(i("e06f"),Object(c.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:t.outHide,expression:"outHide"}],staticClass:"v-select"},[i("el-input",{attrs:{title:21<t.contents.length?t.contents:"",readonly:"",placeholder:"车辆选择"},nativeOn:{click:function(e){return t.toggle(e)}},model:{value:t.contents,callback:function(e){t.contents=e},expression:"contents"}}),i("transition",{attrs:{name:"el-zoom-in-top"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.readonly&&t.toggleFlag,expression:"!readonly&&toggleFlag"}],staticClass:"tree-area"},[i("cv-scrollbar",{staticStyle:{height:"210px"}},[i("all-check",{attrs:{data:t.vehicleData},on:{checked:t.GetCheckedVal}})],1)],1)])],1)},[],!1,null,null,null).exports),h={props:{options:{}},components:{},created:function(){this.grid.enterpriseId=this.options.eid},mixins:[i("8369").a],computed:{_table:function(){return this.$refs.table}},data:function(){return{grid:{enterpriseId:"",fleetId:""},common:{fleetName:"",fleetId:""},routeId:null,selectFid:null}},methods:{load:function(){this._table.tableInitial()},cancelDialog:function(){this.$emit("update:visible",!1)},confirm:function(){this.routeId&&this.selectFid?(this.$emit("update:visible",!1),this.$emit("update:routeData",{rid:this.routeId,fid:this.selectFid})):this.$message.warning({message:"请选择一条线路信息"})},selected:function(t){this.routeId=t.id,this.selectFid=t.fleetId}},watch:{"grid.fleetId":function(){this._table.tableInitial()}}},f=(i("624c"),Object(c.a)(h,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rTable"},[i("el-form",{attrs:{inline:""}},[i("el-form-item",{attrs:{label:"车组选择"}},[i("cv-dropdown-tree",{staticStyle:{width:"200px"},attrs:{url:"/enterprise/findFleetTreeList","auto-params":{enterpriseId:this.options.id,pId:this.options.id,type:this.options.type}},on:{label:t.vehicleIdCall},model:{value:t.grid.fleetId,callback:function(e){t.$set(t.grid,"fleetId","string"==typeof e?e.trim():e)},expression:"grid.fleetId"}})],1)],1),i("cv-grid",{ref:"table",attrs:{params:t.grid,url:"/workLine/queryWorkLines","default-height":300},on:{"row-click":t.selected}},[i("el-table-column",{attrs:{label:t.$t("名称"),prop:"name"}}),i("el-table-column",{attrs:{label:t.$t("所属公司"),prop:"enterpriseName"}}),i("el-table-column",{attrs:{label:t.$t("所属车组"),prop:"fleetName"}})],1),i("div",{staticClass:"buttons"},[i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确认")]),i("el-button",{attrs:{type:"default"},on:{click:t.cancelDialog}},[t._v("取消")])],1)],1)},[],!1,null,null,null).exports),p={components:{vehicleSelect:d,rTable:f},mixins:[""],computed:Object(l.a)({},Object(o.c)(["user","mapName"]),{_mapLook:function(){return this.$refs.map.mapMethods}}),created:function(){this.fleetId=this.$route.query.fleetId,this.routeId=this.$route.query.id},data:function(){return{vs:"vehicleSelect",clearTree:!1,vData:null,dialog:{flag:!1,title:"",size:"dialog-middle",name:"",options:{}},routeData:null,fleetId:null,routeId:null,coverData:{},coverLinesOverlays:[]}},methods:Object(l.a)({},Object(o.b)(["queryWorkLine","queryVehiclesByFleet","workLineCoveredStatistics"]),{lookWorkLine:(n=Object(r.a)(regeneratorRuntime.mark(function t(e){var i,a,n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=[],t.next=3,this.queryWorkLine({id:e,mapType:this.$store.getters.mapType+""});case 3:a=t.sent,n=a.flag,r=a.data,n&&r&&r.pointList.forEach(function(t){i.push({lat:t.latitude,lng:t.longitude})}),this._mapLook.mapAddline(i);case 8:case"end":return t.stop()}},t,this)})),function(t){return n.apply(this,arguments)}),goBack:function(){this.$router.push("/monitor/routerManage")},mapReady:function(){switch(this.$route.query.action){case"look":this.lookWorkLine(this.$route.query.id);break;case"swichRouter":this.dialog.options.eid=this.$route.query.eid,this.dialog.options.id=this.$route.query.eid,this.dialog.options.type=this.$route.query.type}},swichRoute:function(){this.dialog.flag=!0,this.dialog.title="路线切换",this.dialog.name="rTable"},lookCoverRoute:function(t){var e=[],i=[];t.forEach(function(t,a){0==t.isCover?i.push(a-0+1):e.push(a-0+1)});for(var a=[],n=1;n<i.length;n++)i[n]-i[n-1]!=1&&a.push({start:i[n-1]-0+1,len:i[n]-i[n-1]-1});var r=[];a.forEach(function(e){r.push(t.slice(e.start-1,e.start-0+e.len-1))});var l=[];return r.forEach(function(t){var e=[];t.forEach(function(t){e.push({latitude:t.point.latitude,longitude:t.point.longitude})}),l.push(e)}),l}}),watch:{"dialog.flag":function(t){t&&"rTable"==this.dialog.name?this.vs="":this.vs=d,t||(this.dialog.name="")},routeData:function(t){t&&(this._mapLook.clearOverlays(),this.lookWorkLine(t.rid),this.fleetId=t.fid,this.routeId=t.rid,this.clearTree=!0)},coverData:function(t){var e=this;0<this.coverLinesOverlays.length&&this.coverLinesOverlays.forEach(function(t){e._mapLook.removeOverlay(t)}),t[0].vehicleIds&&this.workLineCoveredStatistics({workLines:t,mapType:this.$store.getters.mapType+""}).then(function(t){t.flag&&0!=t.data.length&&e.lookCoverRoute(t.data[0].coverPointList).forEach(function(t,i){e.coverLinesOverlays[i]=e._mapLook.mapAddline(t,{strokeWeight:3,strokeColor:"red"})})})}}},m=(i("c402"),Object(c.a)(p,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"routerManageLook"},[i(t.mapName,{ref:"map",tag:"component",staticClass:"mapStyle",attrs:{mapLoaded:t.mapReady}}),"look"!==this.$route.query.action?i("el-button",{staticClass:"swichRoute",attrs:{type:"primary"},on:{click:t.swichRoute}},[t._v("线路切换")]):t._e(),i("el-button",{staticClass:"goBack",attrs:{type:"primary"},on:{click:t.goBack}},[t._v("返回")]),i(t.vs,{tag:"component",class:"look"==this.$route.query.action?"vehicleSelect":"vehicleSelectR",attrs:{fleetid:t.fleetId,clear:t.clearTree,routeId:t.routeId,coverParams:t.coverData},on:{"update:clear":function(e){t.clearTree=e},"update:routeId":function(e){t.routeId=e},"update:route-id":function(e){t.routeId=e},"update:coverParams":function(e){t.coverData=e},"update:cover-params":function(e){t.coverData=e}}}),i("el-dialog",{attrs:{visible:t.dialog.flag,title:t.dialog.title,"custom-class":t.dialog.size},on:{"update:visible":function(e){return t.$set(t.dialog,"flag",e)}}},[i(t.dialog.name,{tag:"component",attrs:{options:t.dialog.options,visible:t.dialog.flag,routeData:t.routeData},on:{"update:visible":function(e){return t.$set(t.dialog,"flag",e)},"update:routeData":function(e){t.routeData=e},"update:route-data":function(e){t.routeData=e}}})],1)],1)},[],!1,null,null,null).exports);e.default=m},8369:function(t,e,i){"use strict";var a=i("cebc");e.a={data:function(){return{table:{size:10,total:0,current:1,flag:!1,loading:!1,data:[]}}},methods:{tableLoading:function(t,e,i,n){var r=this;i?(this.table.flag=!0,this.table.current=1):this.table.flag=!1,this.table.loading=!0;var l=Object(a.a)({current:this.table.current,size:this.table.size},e);this.$http(n?{url:t,data:l}:{url:t,params:l}).then(function(t){var e=t.data;t.flag&&0!=e.length?(r.table.data=e.records,r.table.total=e.total,r.table.current=e.current):(r.table.data=[],r.table.total=0),r.table.loading=!1}).catch(function(t){r.table.loading=!1})},tableFilterColor:function(t){return this.$filter.plateCodeColor(t.plateColor)},tableFilterIcType:function(t){return this.$filter.icType(t.state)},tableFilterIcResult:function(t){return this.$filter.icResult(t.readerresult)},tableFilterTiredAlarm:function(t){return this.$filter.tiredAlarmType(t.alarm)},tableFilterTiredAdas:function(t){return this.$filter.tiredAdasType(t.alarm)},tableFilterOrderTypeS:function(t){return this.$filter.orderTypeS(t.sendFlag)},tableFilterFormat:function(t){return this.$filter.format(t.orderTime||t.gpsTime)},tableFilterFormats:function(t){return this.$filter.format(t.backTime)},tableBusLineType:function(t){return this.$filter.lineType(t.lineType)},tableFilterAcc:function(t){return this.$filter.accStatus(t.accStatus)},tableSplitMobile:function(t){return t.mobileCode?t.mobileCode.slice(1,t.mobileCode.length):""},tableConfirm:function(t){return this.$filter.isConfirm(t.isnotarize)},tableUpkeep:function(t){return this.$filter.isConfirm(t.type)},tableRenewal:function(t){return this.$filter.renewal(t.state)},tableReMot:function(t){return this.$filter.reMot(t.state)},tableOil:function(t){return this.$filter.fixNumber(t.total,2)},tableSex:function(t){return this.$filter.sex(t.sex)},plateCodeF:function(t){return t.plateCode?t.plateCode:"--"},plateCodeAndColor:function(t){return t.plateCode+"("+this.$filter.plateCodeColor(t.plateColor)+")"},driverStuas:function(t){return this.$filter.alarmStatus(t.fatigueDrive)},overStuas:function(t){return this.$filter.alarmStatus(t.tOversSpeed)},overHStuas:function(t){return this.$filter.alarmStatus(t.tOverSpeedH)},filterAlStuas:function(t){return this.$filter.alarmStatus(t.overSpeed)},filteralarmStuas:function(t){return this.$filter.alarmStatus(t.overSpeedH)},filterLStuas:function(t){return this.$filter.alarmStatus(t.forbid)},applyFlag:function(t){return this.$filter.applyFlag(t.applyFlag)},SEtime:function(t){return this.$filter.SEtime(t.StartTime,t.EndTime)},channelType:function(t){return this.$filter.channelType(t.Channel)},FileSize:function(t){return this.$filter.FileSize(t.fileSize||t.FileSize||0)},AlarmFilter:function(t){return this.$filter.AlarmFilter(t.Alarm)},MediaTypeFilter:function(t){return this.$filter.MediaTypeFilter(t.MediaType)},StreamTypeFilter:function(t){return this.$filter.StreamTypeFilter(t.StreamType)},StorageTypeFilter:function(t){return this.$filter.StorageTypeFilter(t.StorageType)},statusType:function(t){return this.$filter.statusType(t.Status)},fileSource:function(t){return this.$filter.fileSource(t.fileSource)}}}},c402:function(t,e,i){"use strict";var a=i("55af");i.n(a).a},c4c4:function(t,e,i){},e06f:function(t,e,i){"use strict";var a=i("c4c4");i.n(a).a}}]);