(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-42c641ec"],{"05c0":function(e,t,o){"use strict";o("7f7f"),o("20d6"),o("ac6a");var a=o("cebc"),n=o("3f4e"),i=o("2f62"),s={name:"CvPublictreeContent",components:{CvContent:n.a},props:{model:String,vehicleMonitor:Function,loading:Boolean,noresize:{default:!1,type:Boolean}},data:function(){return{entryList:[],condition:""}},computed:Object(a.a)({},Object(i.c)(["onlineList","isAttention","socketEnterprise","socketVehicle","vehicle_data","vehicleCondition"]),{isCheck:function(){switch(this.model){case"multi":return!0;case"single":default:return!1}},_treeMethods:function(){return this.$refs.tabs},_contentMethods:function(){return this.$refs.content}}),beforeDestroy:function(){var e=this._treeMethods.getAllNodes;this.setStoreVehicleSearchCondition(this.condition),this.setStoreVehicleData(e())},mounted:function(){var e=this._treeMethods.$refs.tree.reference().ztreeApi;e()&&e().checkAllNodes(!1)},methods:Object(a.a)({},Object(i.b)(["setStoreVehicleData","setStoreVehicleSearchCondition"]),{handlerVehicleSearch:function(e){this.condition=e},vehicle_Monitor:function(e){var t=e.data;if(e.name,"function"==typeof this.vehicleMonitor)switch(this.model){case"multi":return this.vehicle_Monitor_multi(e);case"single":return this.vehicleMonitor(t[0])}},vehicle_Monitor_multi:function(e){var t=this,o=e.data;switch(e.name){case"check":this.entryList=this.entryList.concat(o);break;case"cancel":o.forEach(function(e){var o=t.entryList.findIndex(function(t){return t.id==e.id});0<=o&&t.entryList.splice(o,1)})}this.vehicleMonitor(this.entryList)}})},l=(o("45d7"),o("2877")),r=Object(l.a)(s,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("cv-content",{ref:"content",attrs:{loading:e.loading,noresize:e.noresize}},[e.model?o("cv-tabs-tree",{ref:"tabs",staticClass:"vehiclemaster-tree",attrs:{slot:"aside","vehicle-search":e.vehicleCondition,"is-checked":e.isCheck,"tree-data":e.vehicle_data,"online-monitor":e.onlineList,"vehicle-monitor":e.socketVehicle,"attention-monitor":e.isAttention,"enterprise-fleet-monitor":e.socketEnterprise,"node-monitor":e.vehicle_Monitor},on:{"vehicle-choose-search":e.handlerVehicleSearch},slot:"aside"}):e._e(),e._t("default")],2)},[],!1,null,"2dfdf41b",null).exports;r.install=function(e){e.component(r.name,r)},t.a=r},4189:function(e,t,o){"use strict";var a=o("4a5c");o.n(a).a},"45d7":function(e,t,o){"use strict";var a=o("6e18");o.n(a).a},"4a5c":function(e,t,o){},"4e0c":function(e,t,o){"use strict";o.r(t),o("386d"),o("7f7f"),o("ac6a");var a={props:{options:{}},data:function(){return{formData:{contactName:"",phoneNumber:"",callStatus:""},loading:!1,rules:{contactName:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{min:0,max:10,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:0,max:20})}],phoneNumber:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{pattern:/^1[34578]\d{9}$/,message:this.$t("terminalProM.typeCorrectNum")},{min:11,max:11,message:this.$filter.lanReplace(this.$t("filter.FixedLength"),{len:11})}],callStatus:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"}]}}},methods:{confirm:function(){var e=this;this.$refs.addForm.validate(function(t){if(!t)return!1;if(!e.options.selectVehicleObject)return e.$message.error({message:e.$t("vgPower.choseVehicle")}),!1;var o={vehicleId:e.options.selectVehicleObject.id,contactName:e.formData.contactName,phoneNumber:e.formData.phoneNumber,callStatus:e.formData.callStatus,enterpriseId:e.$store.getters.user.enterpriseId};e.loading=!0,e.$store.dispatch("insertPhonebook",o).then(function(t){e.loading=!1,!t.flag&&t.errorCode?e.$message.error({message:e.$t("error."+t.errorCode)}):(e.$emit("loadTable",!0),e.$message.success(e.$t("action.addSuccess")),e.options.flag=!1)}).catch(function(){e.loading=!1})})},enterpriseId:function(e){this.formData.id=e.id}},watch:{"options.flag":function(e){e||this.$refs.addForm.resetFields()}}},n=o("2877"),i=Object(n.a)(a,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-row",{staticClass:"container",attrs:{gutter:20}},[o("el-col",{attrs:{span:24}},[o("el-form",{ref:"addForm",attrs:{model:e.formData,"label-position":"top",inline:!1,rules:e.rules}},[o("el-form-item",{attrs:{label:e.$t("phoneBook.contactName"),prop:"contactName"}},[o("el-input",{attrs:{size:"small",maxlength:20},model:{value:e.formData.contactName,callback:function(t){e.$set(e.formData,"contactName","string"==typeof t?t.trim():t)},expression:"formData.contactName"}})],1),o("el-form-item",{attrs:{label:e.$t("phoneBook.phoneNumber"),prop:"phoneNumber"}},[o("el-input",{attrs:{size:"small",maxlength:11},model:{value:e.formData.phoneNumber,callback:function(t){e.$set(e.formData,"phoneNumber","string"==typeof t?t.trim():t)},expression:"formData.phoneNumber"}})],1),o("el-form-item",{attrs:{label:e.$t("phoneBook.callStatus"),prop:"callStatus"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:""},model:{value:e.formData.callStatus,callback:function(t){e.$set(e.formData,"callStatus",t)},expression:"formData.callStatus"}},[o("el-option",{attrs:{label:e.$t("phoneBook.callIn"),value:"1"}}),o("el-option",{attrs:{label:e.$t("phoneBook.callOut"),value:"2"}}),o("el-option",{attrs:{label:e.$t("phoneBook.callInAndOut"),value:"3"}})],1)],1)],1)],1),o("el-col",{staticClass:"dialog-footer",attrs:{span:24}},[o("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("action.save")))]),o("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)},[],!1,null,"2921bc64",null).exports,s={props:{options:{}},data:function(){return{rules:{contactName:[{min:0,max:10,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:0,max:20})}],phoneNumber:[{min:0,max:10,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:0,max:11})}]}}},methods:{confirm:function(){this.$emit("update:isLoading",!0),this.options.flag=!1}}},l=Object(n.a)(s,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-form",{ref:"searchForm",attrs:{model:e.options.search,"label-position":"top","label-width":"80px",rules:e.rules}},[o("el-form-item",{attrs:{label:e.$t("phoneBook.plateCode"),prop:"plateCode"}},[o("el-input",{attrs:{size:"small",maxlength:20},model:{value:e.options.search.plateCode,callback:function(t){e.$set(e.options.search,"plateCode",t)},expression:"options.search.plateCode"}})],1),o("el-form-item",{attrs:{label:e.$t("phoneBook.contactName"),prop:"contactName"}},[o("el-input",{attrs:{size:"small",maxlength:20},model:{value:e.options.search.contactName,callback:function(t){e.$set(e.options.search,"contactName",t)},expression:"options.search.contactName"}})],1),o("el-form-item",{attrs:{label:e.$t("phoneBook.phoneNumber"),prop:"phoneNumber"}},[o("el-input",{attrs:{size:"small",maxlength:11},model:{value:e.options.search.phoneNumber,callback:function(t){e.$set(e.options.search,"phoneNumber",t)},expression:"options.search.phoneNumber"}})],1)],1),o("div",{staticClass:"dialog-footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("action.confirm")))]),o("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)},[],!1,null,null,null).exports,r=(o("6b54"),{props:{options:{}},data:function(){return{formData:{contactName:"",phoneNumber:"",callStatus:"",id:""},disable:!0,rules:{contactName:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{min:0,max:10,message:this.$filter.lanReplace(this.$t("filter.Length"),{min:0,max:20})}],phoneNumber:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"},{pattern:/^1[34578]\d{9}$/,message:this.$t("terminalProM.typeCorrectNum")},{min:11,max:11,message:this.$filter.lanReplace(this.$t("filter.FixedLength"),{len:11})}],callStatus:[{required:!0,message:this.$t("filter.notEmpty"),trigger:"blur,change"}]},loading:!1}},methods:{confirm:function(){var e=this;this.$refs.modify.validate(function(t){if(t){var o={contactName:e.formData.contactName,phoneNumber:e.formData.phoneNumber,callStatus:e.formData.callStatus,id:e.options.modify.id};e.loading=!0,e.$store.dispatch("updatePhonebook",o).then(function(t){e.loading=!1,!t.flag&&t.errorCode?e.$message.error({message:e.$t("error."+t.errorCode)}):(e.options.flag=!1,e.$emit("update:loadTable",!0),e.$message.success(e.$t("action.modifySuccess")))}).catch(function(){e.loading=!1})}})}},watch:{"options.flag":function(e){e||(this.options.name="")}},created:function(){this.formData.contactName=this.options.modify.contactName,this.formData.phoneNumber=this.options.modify.phoneNumber,this.formData.callStatus=this.options.modify.callStatus.toString()}}),c=Object(n.a)(r,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-row",{staticClass:"container",attrs:{gutter:20}},[o("el-col",{attrs:{span:24}},[o("el-form",{ref:"modify",attrs:{inline:!1,"label-position":"top",model:e.formData,rules:e.rules}},[o("el-form-item",{attrs:{label:e.$t("phoneBook.contactName"),prop:"contactName"}},[o("el-input",{attrs:{size:"small",maxlength:100},model:{value:e.formData.contactName,callback:function(t){e.$set(e.formData,"contactName","string"==typeof t?t.trim():t)},expression:"formData.contactName"}})],1),o("el-form-item",{attrs:{label:e.$t("phoneBook.phoneNumber"),prop:"phoneNumber"}},[o("el-input",{attrs:{size:"small",maxlength:100},model:{value:e.formData.phoneNumber,callback:function(t){e.$set(e.formData,"phoneNumber","string"==typeof t?t.trim():t)},expression:"formData.phoneNumber"}})],1),o("el-form-item",{attrs:{label:e.$t("phoneBook.callStatus"),prop:"callStatus"}},[o("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",clearable:""},model:{value:e.formData.callStatus,callback:function(t){e.$set(e.formData,"callStatus",t)},expression:"formData.callStatus"}},[o("el-option",{attrs:{label:e.$t("phoneBook.callIn"),value:"1"}}),o("el-option",{attrs:{label:e.$t("phoneBook.callOut"),value:"2"}}),o("el-option",{attrs:{label:e.$t("phoneBook.callInAndOut"),value:"3"}})],1)],1)],1)],1),o("el-col",{staticClass:"dialog-footer",attrs:{span:24}},[o("el-button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("action.confirm")))]),o("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)},[],!1,null,"9d8d294a",null).exports,h=o("05c0"),m=o("b0ad"),d={components:{add:i,search:l,modify:c,CvPublictreeContent:h.a},computed:{_table:function(){return this.$refs.phoneTable}},mixins:[m.a],data:function(){return{tableLoading:!1,tableFlag:!1,contentLoading:!1,dialog:{flag:!1,title:"--",size:"dialog-tiny",name:"search",selectVehicleObject:null,search:{vehicleId:"",plateCode:"",contactName:"",phoneNumber:""},modify:{id:"",contactName:"",phoneNumber:""}},multipleSelection:[]}},methods:{toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e},getSelectedCount:function(){return this.multipleSelection.length},getSelectedIds:function(){var e=[];return this.multipleSelection.map(function(t){e.push(t.id)}),e},filterCallStatus:function(e){switch(e.callStatus){case 1:return"呼入";case 2:return"呼出";case 3:return"呼入呼出"}},filterSendStatus:function(e){switch(e.isSend){case 0:return"未发送";case 1:return"已发送"}},add:function(e){this.dialog.selectVehicleObject?(this.dialog.flag=!0,this.dialog.title=e.title,this.dialog.name=e.name):this.$message.warning({message:this.$t("vgPower.choseVehicle")})},search:function(e){this.dialog.flag=!0,this.dialog.title=e.title,this.dialog.name=e.name},remove:function(e){var t=this;this.confirmPrompt().then(function(){t.$store.dispatch("deletePhonebook",e.row.id).then(function(e){!e.flag&&e.errorCode?t.$message.error({message:t.$t("error."+e.errorCode)}):(t._table.tableInitial(),t.$message.success({message:t.$t("action.removeSuccess")}))})})},sendDelAll:function(){var e=this;if(this.dialog.selectVehicleObject){var t={vehicleId:this.dialog.selectVehicleObject.id,type:0,ids:this.getSelectedIds().join(",")};this.confirmPrompt(this.$t("phoneBook.confirmIsSendDelAll")).then(function(){e.$store.dispatch("sendPhonebookCmd",t).then(function(t){!t.flag&&t.errorCode?e.$message.error({message:e.$t("error."+t.errorCode)}):(e._table.tableInitial(),e.$message.success({message:e.$t("action.orderSuccess")}))})})}else this.$message.warning({message:this.$t("vgPower.choseVehicle")})},sendUpdate:function(){var e=this;if(this.dialog.selectVehicleObject)if(0!=this.getSelectedIds().length){var t={vehicleId:this.dialog.selectVehicleObject.id,type:1,ids:this.getSelectedIds().join(",")};this.confirmPrompt(this.$t("phoneBook.confirmIsSendUpdate")).then(function(){e.$store.dispatch("sendPhonebookCmd",t).then(function(t){!t.flag&&t.errorCode?e.$message.error({message:e.$t("error."+t.errorCode)}):(e._table.tableInitial(),e.$message.success({message:e.$t("action.orderSuccess")}))})})}else this.$message.warning({message:this.$t("请至少选择一条信息")});else this.$message.warning({message:this.$t("vgPower.choseVehicle")})},sendAdd:function(){var e=this;if(this.dialog.selectVehicleObject)if(0!=this.getSelectedIds().length){var t={vehicleId:this.dialog.selectVehicleObject.id,type:2,ids:this.getSelectedIds().join(",")};0<this.getSelectedCount()?this.confirmPrompt(this.$t("phoneBook.confirmIsSendAdd")).then(function(){e.$store.dispatch("sendPhonebookCmd",t).then(function(t){!t.flag&&t.errorCode?e.$message.error({message:e.$t("error."+t.errorCode)}):(e._table.tableInitial(),e.$message.success({message:e.$t("action.orderSuccess")}))})}):this.$message.warning({message:this.$t("eventInfo.alertToSelect")})}else this.$message.warning({message:this.$t("请至少选择一条信息")});else this.$message.warning({message:this.$t("vgPower.choseVehicle")})},sendEdit:function(){var e=this;if(this.dialog.selectVehicleObject)if(0!=this.getSelectedIds().length){var t={vehicleId:this.dialog.selectVehicleObject.id,type:3,ids:this.getSelectedIds().join(",")};0<this.getSelectedCount()?this.confirmPrompt(this.$t("phoneBook.confirmIsSendEdit")).then(function(){e.$store.dispatch("sendPhonebookCmd",t).then(function(t){!t.flag&&t.errorCode?e.$message.error({message:e.$t("error."+t.errorCode)}):(e._table.tableInitial(),e.$message.success({message:e.$t("action.orderSuccess")}))})}):this.$message.warning({message:this.$t("eventInfo.alertToSelect")})}else this.$message.warning({message:this.$t("请至少选择一条信息")});else this.$message.warning({message:this.$t("vgPower.choseVehicle")})},modify:function(e){this.dialog.flag=!0,this.dialog.title=this.$t("power.modify"),this.dialog.name="modify",this.dialog.size="dialog-tiny",this.dialog.modify=e.row},handlerVehicleMonitor:function(e){this.dialog.selectVehicleObject=e,this.dialog.search.vehicleId=e.id,this._table.tableInitial()}},watch:{tableLoading:function(e){e&&(this._table.tableInitial(e),this.tableLoading=!1)},tableFlag:function(e){e&&(this._table.tableInitial(e),this.tableFlag=!1)}}},u=(o("4189"),Object(n.a)(d,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("cv-operation",[o("el-form-item",[o("cv-tool",{staticStyle:{margin:"0px"},attrs:{name:e.$route.name,data:e.$store.getters.monitorMenu,"is-modify":!1,"is-remove":!1,"is-export":!1,"is-sendDelAll":!0,"is-sendUpdate":!0},on:{add:e.add,search:e.search,sendDelAll:e.sendDelAll,sendUpdate:e.sendUpdate,sendAdd:e.sendAdd,sendEdit:e.sendEdit}})],1)],1),o("cv-publictree-content",{attrs:{model:"single","vehicle-monitor":e.handlerVehicleMonitor,loading:e.contentLoading}},[o("cv-grid",{ref:"phoneTable",attrs:{params:e.dialog.search,url:"/phonebook/getPhonebookPage"},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),o("el-table-column",{attrs:{label:e.$t("phoneBook.plateCode"),prop:"plateCode"}}),o("el-table-column",{attrs:{label:e.$t("phoneBook.contactName"),prop:"contactName"}}),o("el-table-column",{attrs:{label:e.$t("phoneBook.phoneNumber"),prop:"phoneNumber"}}),o("el-table-column",{attrs:{label:e.$t("phoneBook.callStatus"),prop:"callStatus",formatter:e.filterCallStatus}}),o("el-table-column",{attrs:{label:e.$t("phoneBook.isSend"),prop:"isSend",formatter:e.filterSendStatus}}),o("el-table-column",{attrs:{label:"操作",prop:"operation","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("cv-span",{attrs:{type:"primary"},nativeOn:{click:function(o){return e.modify(t)}}},[e._v("修改")]),o("cv-span",{attrs:{type:"danger"},nativeOn:{click:function(o){return e.remove(t)}}},[e._v("删除")])]}}])})],1)],1),o("el-dialog",{attrs:{visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[o(e.dialog.name,{tag:"component",attrs:{options:e.dialog,isLoading:e.tableLoading,loadTable:e.tableFlag},on:{confirm:function(t){return e.load(!0)},"update:isLoading":function(t){e.tableLoading=t},"update:is-loading":function(t){e.tableLoading=t},"update:loadTable":function(t){e.tableFlag=t},"update:load-table":function(t){e.tableFlag=t}}})],1)],1)},[],!1,null,null,null).exports);t.default=u},"6e18":function(e,t,o){},b0ad:function(e,t,o){"use strict";(function(e){o("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var o=this,a=e||this.$t("action.confirmIsRemove");return new Promise(function(e,n){o.$confirm(a,o.$t("action.tip"),{confirmButtonText:o.$t("action.confirm"),cancelButtonText:o.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,o){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=o||this.$message.error({message:this.$t("请选择时间范围在"+o+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,o){var a=e.length,n=t.length;return n<a?{name:"add",data:this.$service.isUnique(e,t,o)}:a<n?{name:"remove",data:this.$service.isUnique(t,e,o)}:a==n?{name:"equal",data:this.$service.isUnique(e,t,o)}:void 0},showTooltip:function(e,t){var o=e.target,a=this.$refs[t];a.referenceElm=o,a.$refs.popper.style.display="none",a.doDestroy(),a.setExpectedState(!0),a.handleShowPopper()},mouseenterShowTip:function(e,t,o){var a=e.target;if(a.scrollWidth>a.offsetWidth||o)return this.showTooltip(e,t),o?o.startTime+"~"+o.endTime:a.innerText},mouseenterShowToolTip:function(e,t,o){var a=e.target;return this.showTooltip(e,t),!o&&a.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,o){var a=this,n=0<arguments.length&&void 0!==t?t:"Baidu",i=1<arguments.length?o:void 0;return e[n]?e[n]._preloader?e[n]._preloader:Promise.resolve(e[n]):(e[n]={},e[n]._preloader=new Promise(function(t,o){var s=document.createElement("script");s.src=i,e.document.body.appendChild(s),a.$service.isIe()&&a.$service.IE_VERSION<11?s.onreadystatechange=function(){"loaded"!=s.readyState&&"complete"!=s.readyState||(t(e[n]),e[n]._preloader=null)}:s.onload=function(){t(e[n]),e[n]._preloader=null}}),e[n]._preloader)}}}}).call(this,o("c8ba"))}}]);