(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-610c8d1e"],{"1fb8":function(e,t,r){},"2c0c":function(e,t,r){"use strict";r.r(t),r("ac6a");var i=r("cebc"),a=r("8369"),n=r("2f62"),l={inject:["store"],mixins:[a.a],computed:{_table:function(){return this.$refs.table}},data:function(){return{grid:{account:""}}},methods:Object(i.a)({},Object(n.b)(["updateFleetInfoByUsers"]),{search:function(){this._table.tableInitial()},cancel:function(){this.$emit("update:visible",!1)},confirm:function(){var e=this;return this.store.fleetIds?this.store.userIds?void this.updateFleetInfoByUsers({fleetIds:this.store.fleetIds,entIds:this.store.enterpriseIds,userIds:this.store.userIds}).then(function(t){t.flag&&(e.$emit("update:visible",!1),e.$emit("update:searchTable",!0),e.$message.success("授权成功")),t.flag||e.$message.warning({message:e.$t("error."+t.errorCode)})}):(this.$message.warning("请勾选需要授权的账号"),!1):(this.$message.warning("请勾选需要授权的车组"),!1)},selectChange:function(e){var t=[];0<e.length&&e.forEach(function(e){t.push(e.id)}),this.store.userIds=t.join(",")}})},s=r("2877"),o=Object(s.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{},[r("el-input",{staticStyle:{width:"86.9%","vertical-align":"baseline"},attrs:{clearable:"",placeholder:"请输入账号搜索"},model:{value:e.grid.account,callback:function(t){e.$set(e.grid,"account",t)},expression:"grid.account"}}),r("el-button",{staticStyle:{"vertical-align":"baseline",height:"31px","margin-bottom":"15px"},attrs:{type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[e._v("搜索")]),r("cv-grid",{ref:"table",attrs:{params:e.grid,url:"/fleet/findSysUserInfoByList",defaultHeight:300},on:{"selection-change":e.selectChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),r("el-table-column",{attrs:{label:"账号",prop:"account"}}),r("el-table-column",{attrs:{label:"姓名",prop:"username"}}),r("el-table-column",{attrs:{label:"手机号码",prop:"mobilephone"}})],1),r("el-row",{staticStyle:{"text-align":"center","margin-top":"15px"}},[r("el-col",[r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.confirm(t)}}},[e._v("授权")]),r("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.cancel(t)}}},[e._v("取消")])],1)],1)],1)},[],!1,null,null,null).exports,c=r("b0ad"),u=r("e4d3"),f={components:{powerUser:o},computed:{_table:function(){return this.$refs.table}},mixins:[a.a,c.a,u.a],data:function(){return{store:{selectedFleetId:"",selectedEnterpriseId:"",fleetIds:"",enterpriseIds:""},searchFlag:!1,dialog:{flag:!1,size:"dialog-tiny",title:"",name:""},treeFlag:!0,fleetTree:[],filterModel:"",enterpriseId:"",grid:{fleetId:"",accountType:"2",account:""},allChecked:[]}},methods:{empowerUser:function(){if(!this.store.fleetIds)return this.$message.warning("请勾选需要授权的车组"),!1;this.$service.mapParams(this.dialog,{name:"powerUser",title:"用户授权",size:"dialog-middle",flag:!0})},search:function(){this.searchFlag=!0},remove:function(e){var t=this;this.confirmPrompt().then(function(){var r={fleetId:t.store.selectedFleetId,enterpriseId:t.store.selectedEnterpriseId,userIds:e};t.$store.dispatch("deleteFleetUserInfo",r).then(function(e){e.flag?(t.$message.success(t.$t("action.removeSuccess")),t._table.tableInitial()):t.$message.error(t.$t("error."+e.errorCode))})})},nodeClick:function(e){this.store.selectedFleetId=3==e.type?e.id:"",this.store.selectedEnterpriseId=3==e.type?e.enterpriseId:"",3==e.type&&(this.grid.fleetId=e.id,this._table.tableInitial()),3!==e.type&&(this.grid.fleetId="",this._table.tableInitial(),this.$message.warning("请选择车组节点查看"))},checkedBox:function(){var e=this.$refs.vgEmpowerTree.ztreeApi().getCheckedNodes(),t=[],r=[];e.forEach(function(e){switch(e.type){case 1:r.push(e.id);break;case 3:t.push(e.id)}}),this.store.fleetIds=t.join(","),this.store.enterpriseIds=r.join(",")}},beforeMount:function(){var e=this;this.$http({url:"/fleet/findEnterpriseFleetInfoListByEnt",params:{enterpriseId:this.$store.getters.user.enterpriseId}}).then(function(t){t.flag&&(e.fleetTree=t.data,e.treeFlag=!1)})},watch:{searchFlag:function(e){e&&(this._table.tableInitial(),this.searchFlag=!1)},filterModel:function(e){this.$refs.vgEmpowerTree.filterNodes(e)},"dialog.flag":function(e){e||(this.dialog.name="")}}},d=(r("367d"),Object(s.a)(f,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"vgEmpower"},[r("cv-operation",[r("el-form-item",[r("el-input",{attrs:{clearable:"",placeholder:"请输入账号搜索"},model:{value:e.grid.account,callback:function(t){e.$set(e.grid,"account",t)},expression:"grid.account"}})],1),r("el-form-item",[r("cv-tool",{staticClass:"cv-tool",attrs:{name:e.$route.name,data:e.$store.getters.manageMenus,"is-modify":!1,"is-export":!1,"is-remove":!1},on:{search:e.search,add:e.empowerUser}})],1)],1),r("cv-content",[r("div",{attrs:{slot:"aside"},slot:"aside"},[r("el-input",{staticStyle:{width:"100%"},attrs:{placeholder:"搜索",size:"small"},model:{value:e.filterModel,callback:function(t){e.filterModel=t},expression:"filterModel"}}),r("cv-scrollbar",{directives:[{name:"loading",rawName:"v-loading",value:e.treeFlag,expression:"treeFlag"}],class:[e.treeFlag?"scrollW1":"scrollW2"]},[r("cv-tree",{ref:"vgEmpowerTree",attrs:{data:e.fleetTree,"is-check":!0},on:{"current-change":e.checkedBox,"node-click":e.nodeClick}})],1)],1),r("cv-grid",{ref:"table",attrs:{params:e.grid,url:"/fleet/getFleetUserList"}},[r("el-table-column",{attrs:{label:e.$t("vgPower.account"),prop:"account"}}),r("el-table-column",{attrs:{label:e.$t("vgPower.userName"),prop:"username"}}),r("el-table-column",{attrs:{label:e.$t("vgPower.sexy"),prop:"sex",formatter:e.tableSex}}),r("el-table-column",{attrs:{label:e.$t("vgPower.mobilePhone"),prop:"mobilephone"}}),r("el-table-column",{attrs:{label:e.$t("action.operation")},scopedSlots:e._u([{key:"default",fn:function(t){return[r("cv-table-tool",{attrs:{name:e.$route.name,data:e.$store.getters.manageMenus,"is-modify":!1},on:{remove:function(r){return e.remove(t.row.id)}}})]}}])})],1)],1),r("el-dialog",{attrs:{visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[r(e.dialog.name,{tag:"component",attrs:{visible:e.dialog.flag,searchTable:e.searchFlag},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)},"update:searchTable":function(t){e.searchFlag=t},"update:search-table":function(t){e.searchFlag=t}}})],1)],1)},[],!1,null,null,null).exports);t.default=d},"367d":function(e,t,r){"use strict";var i=r("1fb8");r.n(i).a},8369:function(e,t,r){"use strict";var i=r("cebc");t.a={data:function(){return{table:{size:10,total:0,current:1,flag:!1,loading:!1,data:[]}}},methods:{tableLoading:function(e,t,r,a){var n=this;r?(this.table.flag=!0,this.table.current=1):this.table.flag=!1,this.table.loading=!0;var l=Object(i.a)({current:this.table.current,size:this.table.size},t);this.$http(a?{url:e,data:l}:{url:e,params:l}).then(function(e){var t=e.data;e.flag&&0!=t.length?(n.table.data=t.records,n.table.total=t.total,n.table.current=t.current):(n.table.data=[],n.table.total=0),n.table.loading=!1}).catch(function(e){n.table.loading=!1})},tableFilterColor:function(e){return this.$filter.plateCodeColor(e.plateColor)},tableFilterIcType:function(e){return this.$filter.icType(e.state)},tableFilterIcResult:function(e){return this.$filter.icResult(e.readerresult)},tableFilterTiredAlarm:function(e){return this.$filter.tiredAlarmType(e.alarm)},tableFilterTiredAdas:function(e){return this.$filter.tiredAdasType(e.alarm)},tableFilterOrderTypeS:function(e){return this.$filter.orderTypeS(e.sendFlag)},tableFilterFormat:function(e){return this.$filter.format(e.orderTime||e.gpsTime)},tableFilterFormats:function(e){return this.$filter.format(e.backTime)},tableBusLineType:function(e){return this.$filter.lineType(e.lineType)},tableFilterAcc:function(e){return this.$filter.accStatus(e.accStatus)},tableSplitMobile:function(e){return e.mobileCode?e.mobileCode.slice(1,e.mobileCode.length):""},tableConfirm:function(e){return this.$filter.isConfirm(e.isnotarize)},tableUpkeep:function(e){return this.$filter.isConfirm(e.type)},tableRenewal:function(e){return this.$filter.renewal(e.state)},tableReMot:function(e){return this.$filter.reMot(e.state)},tableOil:function(e){return this.$filter.fixNumber(e.total,2)},tableSex:function(e){return this.$filter.sex(e.sex)},plateCodeF:function(e){return e.plateCode?e.plateCode:"--"},plateCodeAndColor:function(e){return e.plateCode+"("+this.$filter.plateCodeColor(e.plateColor)+")"},driverStuas:function(e){return this.$filter.alarmStatus(e.fatigueDrive)},overStuas:function(e){return this.$filter.alarmStatus(e.tOversSpeed)},overHStuas:function(e){return this.$filter.alarmStatus(e.tOverSpeedH)},filterAlStuas:function(e){return this.$filter.alarmStatus(e.overSpeed)},filteralarmStuas:function(e){return this.$filter.alarmStatus(e.overSpeedH)},filterLStuas:function(e){return this.$filter.alarmStatus(e.forbid)},applyFlag:function(e){return this.$filter.applyFlag(e.applyFlag)},SEtime:function(e){return this.$filter.SEtime(e.StartTime,e.EndTime)},channelType:function(e){return this.$filter.channelType(e.Channel)},FileSize:function(e){return this.$filter.FileSize(e.fileSize||e.FileSize||0)},AlarmFilter:function(e){return this.$filter.AlarmFilter(e.Alarm)},MediaTypeFilter:function(e){return this.$filter.MediaTypeFilter(e.MediaType)},StreamTypeFilter:function(e){return this.$filter.StreamTypeFilter(e.StreamType)},StorageTypeFilter:function(e){return this.$filter.StorageTypeFilter(e.StorageType)},statusType:function(e){return this.$filter.statusType(e.Status)},fileSource:function(e){return this.$filter.fileSource(e.fileSource)}}}},b0ad:function(e,t,r){"use strict";(function(e){r("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var r=this,i=e||this.$t("action.confirmIsRemove");return new Promise(function(e,a){r.$confirm(i,r.$t("action.tip"),{confirmButtonText:r.$t("action.confirm"),cancelButtonText:r.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,r){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=r||this.$message.error({message:this.$t("请选择时间范围在"+r+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,r){var i=e.length,a=t.length;return a<i?{name:"add",data:this.$service.isUnique(e,t,r)}:i<a?{name:"remove",data:this.$service.isUnique(t,e,r)}:i==a?{name:"equal",data:this.$service.isUnique(e,t,r)}:void 0},showTooltip:function(e,t){var r=e.target,i=this.$refs[t];i.referenceElm=r,i.$refs.popper.style.display="none",i.doDestroy(),i.setExpectedState(!0),i.handleShowPopper()},mouseenterShowTip:function(e,t,r){var i=e.target;if(i.scrollWidth>i.offsetWidth||r)return this.showTooltip(e,t),r?r.startTime+"~"+r.endTime:i.innerText},mouseenterShowToolTip:function(e,t,r){var i=e.target;return this.showTooltip(e,t),!r&&i.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,r){var i=this,a=0<arguments.length&&void 0!==t?t:"Baidu",n=1<arguments.length?r:void 0;return e[a]?e[a]._preloader?e[a]._preloader:Promise.resolve(e[a]):(e[a]={},e[a]._preloader=new Promise(function(t,r){var l=document.createElement("script");l.src=n,e.document.body.appendChild(l),i.$service.isIe()&&i.$service.IE_VERSION<11?l.onreadystatechange=function(){"loaded"!=l.readyState&&"complete"!=l.readyState||(t(e[a]),e[a]._preloader=null)}:l.onload=function(){t(e[a]),e[a]._preloader=null}}),e[a]._preloader)}}}}).call(this,r("c8ba"))},e4d3:function(e,t,r){"use strict";t.a={data:function(){return{store:{company_tree:[]}}},provide:function(){return{store:this.store}},methods:{staticTree:function(){var e=this;this.$http({url:"/enterprise/findEnterpriseOrganizationTreeList"}).then(function(t){var r=t.data,i=t.flag;e.store.company_tree=i?r:[]})},staticTreeOld:function(){var e=this;this.$http({url:"/enterprise/getEnterpriseTreeList"}).then(function(t){var r=t.data,i=t.flag;e.store.company_tree=i?r:[]})}}}}}]);