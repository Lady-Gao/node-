(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3f346870"],{"5cf5":function(e,t,a){"use strict";a.r(t);var o=a("f7d9"),n={name:"eventManage",mixins:[a("b0ad").a],components:{eventDialog:o.a},data:function(){return{header:{status:"",title:"",submitPersonName:"",dulePersonName:"",submitTime:"",eventLocation:""},dialog:{title:"指派",size:"dialog-small",flag:!1,name:"",id:""}}},computed:{_statusArray:function(){return[{value:"0",label:"全部"},{value:"1",label:"已上报"},{value:"2",label:"待处理"},{value:"3",label:"处理中"},{value:"4",label:"已处理"},{value:"5",label:"已关闭"}]},_table:function(){return this.$refs.table}},methods:{tableLoad:function(){this._table.tableInitial()},search:function(e){this.$router.push({path:"/monitor/eventManage-child",query:{eventId:e.id}})},eventClose:function(e){var t=this;this.confirmPrompt("你确定要执行此操作吗？").then(function(){t.$store.dispatch("updateClose",{eventId:e.id}).then(function(e){e.flag?t.$message.success("关闭成功"):t.$message.error(t.$t("error."+e.errorCode))}).catch(function(){t.$message.error("请求异常")})})},opendDialog:function(e){this.dialog.flag=!0,this.dialog.size="dialog-tiny",this.dialog.name="eventDialog",this.dialog.id=e.id},remove:function(e){var t=this;this.confirmPrompt().then(function(){t.$store.dispatch("deleteEvent",{eventId:e.id}).then(function(e){e.flag?(t.$message.success("删除成功"),t.tableLoad(!0)):t.$message.error(t.$t("error."+e.errorCode))}).catch(function(){t.$message.error("请求异常")})})}}},r=a("2877"),i=Object(r.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("cv-operation",{attrs:{position:"left"}},[a("el-form-item",{attrs:{label:"状态:"}},[a("el-select",{model:{value:e.header.status,callback:function(t){e.$set(e.header,"status",t)},expression:"header.status"}},e._l(e._statusArray,function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"上报人:"}},[a("el-input",{model:{value:e.header.submitPersonName,callback:function(t){e.$set(e.header,"submitPersonName",t)},expression:"header.submitPersonName"}})],1),a("el-form-item",{attrs:{label:"处理人:"}},[a("el-input",{model:{value:e.header.dulePersonName,callback:function(t){e.$set(e.header,"dulePersonName",t)},expression:"header.dulePersonName"}})],1),a("el-form-item",{attrs:{label:"上报时间:"}},[a("el-date-picker",{attrs:{type:"date"},model:{value:e.header.submitTime,callback:function(t){e.$set(e.header,"submitTime",t)},expression:"header.submitTime"}})],1),a("el-form-item",{attrs:{label:"标题:"}},[a("el-input",{model:{value:e.header.title,callback:function(t){e.$set(e.header,"title",t)},expression:"header.title"}})],1),a("el-form-item",{attrs:{label:"地点:"}},[a("el-input",{model:{value:e.header.eventLocation,callback:function(t){e.$set(e.header,"eventLocation",t)},expression:"header.eventLocation"}})],1),a("el-form-item",[a("cv-tool",{attrs:{name:e.$route.name,data:e.$store.getters.monitorMenu,"is-add":!1,"is-modify":!1,"is-remove":!1,"is-export":!1},on:{search:e.tableLoad}})],1)],1),a("cv-content",[a("cv-grid",{ref:"table",attrs:{url:"/event/queryPage",params:e.header}},[a("el-table-column",{attrs:{label:"标题",prop:"title"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cv-span",{attrs:{type:"primary"},nativeOn:{click:function(a){return e.search(t.row)}}},[e._v(e._s(t.row.title))])]}}])}),a("el-table-column",{attrs:{label:"状态",prop:"statusName"}}),a("el-table-column",{attrs:{label:"上报人",prop:"submitPersonName"}}),a("el-table-column",{attrs:{label:"上报时间",prop:"submitTime"}}),a("el-table-column",{attrs:{label:"处理人",prop:"dulePersonName"}}),a("el-table-column",{attrs:{label:"处理时间",prop:"duleTime"}}),a("el-table-column",{attrs:{label:"位置信息",prop:"eventLocation"}}),a("el-table-column",{attrs:{label:"描述",prop:"remark"}}),a("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("cv-table-tool",{attrs:{name:e.$route.name,data:e.$store.getters.monitorMenu,"is-modify":!1},on:{remove:function(a){return e.remove(t.row)}}}),5!=t.row.status?a("div",{staticClass:"cv-table-tool"},[a("cv-span",{attrs:{type:"success"},nativeOn:{click:function(a){return e.opendDialog(t.row)}}},[e._v(e._s(t.row.submitPersonName?"重新指派":"指派"))]),a("cv-span",{attrs:{type:"success"},nativeOn:{click:function(a){return e.eventClose(t.row)}}},[e._v("事件关闭")])],1):e._e()]}}])})],1)],1),a("el-dialog",{attrs:{visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[a(e.dialog.name,{tag:"component",attrs:{options:e.dialog},on:{confirm:function(t){return e.tableLoad(!0)}}})],1)],1)},[],!1,null,null,null).exports;t.default=i},b0ad:function(e,t,a){"use strict";(function(e){a("7f7f"),t.a={methods:{confirmPrompt:function(e,t){var a=this,o=e||this.$t("action.confirmIsRemove");return new Promise(function(e,n){a.$confirm(o,a.$t("action.tip"),{confirmButtonText:a.$t("action.confirm"),cancelButtonText:a.$t("action.cancel"),type:"warning"}).then(function(){e()}).catch(function(){"function"==typeof t&&t()})})},timeLimitFunc:function(e,t,a){if(e&&t)return((new Date(t)-new Date(e))/864e5).toFixed(1)<=a||this.$message.error({message:this.$t("请选择时间范围在"+a+"天内")});this.$message.error({message:this.$t("请选择时间范围")})},addRemoveUnique:function(e,t,a){var o=e.length,n=t.length;return n<o?{name:"add",data:this.$service.isUnique(e,t,a)}:o<n?{name:"remove",data:this.$service.isUnique(t,e,a)}:o==n?{name:"equal",data:this.$service.isUnique(e,t,a)}:void 0},showTooltip:function(e,t){var a=e.target,o=this.$refs[t];o.referenceElm=a,o.$refs.popper.style.display="none",o.doDestroy(),o.setExpectedState(!0),o.handleShowPopper()},mouseenterShowTip:function(e,t,a){var o=e.target;if(o.scrollWidth>o.offsetWidth||a)return this.showTooltip(e,t),a?a.startTime+"~"+a.endTime:o.innerText},mouseenterShowToolTip:function(e,t,a){var o=e.target;return this.showTooltip(e,t),!a&&o.innerText},mouseoverHideTip:function(e){var t=this.$refs[e];t&&(t.setExpectedState(!1),t.handleClosePopper())},asyncDownloadScript:function(t,a){var o=this,n=0<arguments.length&&void 0!==t?t:"Baidu",r=1<arguments.length?a:void 0;return e[n]?e[n]._preloader?e[n]._preloader:Promise.resolve(e[n]):(e[n]={},e[n]._preloader=new Promise(function(t,a){var i=document.createElement("script");i.src=r,e.document.body.appendChild(i),o.$service.isIe()&&o.$service.IE_VERSION<11?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(t(e[n]),e[n]._preloader=null)}:i.onload=function(){t(e[n]),e[n]._preloader=null}}),e[n]._preloader)}}}}).call(this,a("c8ba"))},f7d9:function(e,t,a){"use strict";var o={props:{options:{}},data:function(){return{form:{list:[],dustmanId:"",loading:!1}}},methods:{getList:function(){var e=this;this.$store.dispatch("queryInspection","").then(function(t){t.flag?e.form.list=t.data:e.form.list=[]}).catch(function(){e.$message.error("请求异常")})},submitMan:function(){var e=this;this.form.dustmanId?(this.form.loading=!0,this.$store.dispatch("insertDustman",{dustmanId:this.form.dustmanId,eventId:this.options.id}).then(function(t){t.flag?(e.$emit("confirm"),e.$message.success("指派成功"),e.options.flag=!1):e.$message.error(e.$t("error."+t.errorCode)),e.form.loading=!1})):(this.$message.warning("请选择处理人"),this.form.loading=!1)}},watch:{"options.flag":function(e){e||(this.options.name="")}},mounted:function(){this.getList()}},n=a("2877"),r=Object(n.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{overflow:"auto"}},[a("el-form",{ref:"form",attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"处理人"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:e.form.dustmanId,callback:function(t){e.$set(e.form,"dustmanId",t)},expression:"form.dustmanId"}},e._l(e.form.list,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),a("el-col",{staticClass:"dialog-footer",attrs:{span:24}},[a("el-button",{attrs:{loading:e.form.loading,type:"primary"},on:{click:e.submitMan}},[e._v(e._s(e.$t("action.confirm")))]),a("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)},[],!1,null,"13158c44",null);t.a=r.exports}}]);