(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-13c933da"],{"05c0":function(e,t,i){"use strict";i("7f7f"),i("20d6"),i("ac6a");var n=i("cebc"),o=i("3f4e"),a=i("2f62"),l={name:"CvPublictreeContent",components:{CvContent:o.a},props:{model:String,vehicleMonitor:Function,loading:Boolean,noresize:{default:!1,type:Boolean}},data:function(){return{entryList:[],condition:""}},computed:Object(n.a)({},Object(a.c)(["onlineList","isAttention","socketEnterprise","socketVehicle","vehicle_data","vehicleCondition"]),{isCheck:function(){switch(this.model){case"multi":return!0;case"single":default:return!1}},_treeMethods:function(){return this.$refs.tabs},_contentMethods:function(){return this.$refs.content}}),beforeDestroy:function(){var e=this._treeMethods.getAllNodes;this.setStoreVehicleSearchCondition(this.condition),this.setStoreVehicleData(e())},mounted:function(){var e=this._treeMethods.$refs.tree.reference().ztreeApi;e()&&e().checkAllNodes(!1)},methods:Object(n.a)({},Object(a.b)(["setStoreVehicleData","setStoreVehicleSearchCondition"]),{handlerVehicleSearch:function(e){this.condition=e},vehicle_Monitor:function(e){var t=e.data;if(e.name,"function"==typeof this.vehicleMonitor)switch(this.model){case"multi":return this.vehicle_Monitor_multi(e);case"single":return this.vehicleMonitor(t[0])}},vehicle_Monitor_multi:function(e){var t=this,i=e.data;switch(e.name){case"check":this.entryList=this.entryList.concat(i);break;case"cancel":i.forEach(function(e){var i=t.entryList.findIndex(function(t){return t.id==e.id});0<=i&&t.entryList.splice(i,1)})}this.vehicleMonitor(this.entryList)}})},s=(i("45d7"),i("2877")),r=Object(s.a)(l,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cv-content",{ref:"content",attrs:{loading:e.loading,noresize:e.noresize}},[e.model?i("cv-tabs-tree",{ref:"tabs",staticClass:"vehiclemaster-tree",attrs:{slot:"aside","vehicle-search":e.vehicleCondition,"is-checked":e.isCheck,"tree-data":e.vehicle_data,"online-monitor":e.onlineList,"vehicle-monitor":e.socketVehicle,"attention-monitor":e.isAttention,"enterprise-fleet-monitor":e.socketEnterprise,"node-monitor":e.vehicle_Monitor},on:{"vehicle-choose-search":e.handlerVehicleSearch},slot:"aside"}):e._e(),e._t("default")],2)},[],!1,null,"2dfdf41b",null).exports;r.install=function(e){e.component(r.name,r)},t.a=r},"45d7":function(e,t,i){"use strict";var n=i("6e18");i.n(n).a},"6e18":function(e,t,i){},"891c":function(e,t,i){},9307:function(e,t,i){"use strict";var n=i("891c");i.n(n).a},"93ca":function(e,t,i){"use strict";var n=i("d158");i.n(n).a},d158:function(e,t,i){},fa02:function(e,t,i){"use strict";i.r(t),i("ac6a");var n={props:{options:{}},components:{},mixins:[],data:function(){return{radio:1,upFlag:!1}},methods:{confirm:function(){var e=this,t={vehicleId:this.options.vehicleId,ids:this.options.selectId,delFlag:this.radio};this.upFlag=!0,this.$store.dispatch("sendMediaUploadCmd",t).then(function(t){t.flag?(e.options.flag=!1,e.upFlag=!1,e.$message.success({message:e.$t("指令下发成功"+t.data.success+"条，失败"+t.data.fail+"条")}),e.$emit("confirm")):(e.$message.error({message:e.$t("error."+t.errorCode)}),e.upFlag=!1)})}}},o=(i("93ca"),i("2877")),a={components:{upload:Object(o.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"uploadDia"},[i("i",{staticClass:"el-icon-warning",staticStyle:{"font-size":"30px",color:"#E6A23C"}}),i("cv-span",{staticStyle:{position:"relative",top:"-6px",left:"10px"}},[e._v("选择删除，终端设备将在上传后删除该媒体数据！")]),i("el-radio-group",{staticClass:"radioGroup",model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[i("el-radio",{attrs:{label:0}},[e._v("保留")]),i("el-radio",{attrs:{label:1}},[e._v("删除")])],1),i("el-col",{staticClass:"dialog-footer",attrs:{span:24}},[i("el-button",{attrs:{type:"primary",loading:e.upFlag},on:{click:e.confirm}},[e._v(e._s(e.$t("上传")))]),i("el-button",{on:{click:function(t){e.options.flag=!1}}},[e._v(e._s(e.$t("action.cancel")))])],1)],1)},[],!1,null,null,null).exports,CvPublictreeContent:i("05c0").a},mixins:[],data:function(){return{loadComponents:{monitorTree:"monitorTree"},treeFlag:!1,vehicle:"",vehicleId:"",SId:null,SIds:null,gridL:{vehicleId:"",uploadFlag:1},gridR:{vehicleId:"",uploadFlag:0},dialog:{flag:!1,title:"上传",size:"dialog-tiny",name:"upload",radio:1},formData:{eventid:"",delflag:0},multipleSelection:[]}},computed:{_table1:function(){return this.$refs.gridl},_table2:function(){return this.$refs.gridr}},methods:{single:function(e){this.vehicle=e.plateCode,this.vehicleId=e.id,this.gridLLoad(),this.gridRLoad()},gridLLoad:function(){this.gridL.vehicleId=this.vehicleId,this._table1.tableInitial()},gridRLoad:function(){this.gridR.vehicleId=this.vehicleId,this._table2.tableInitial()},selectIDs:function(e){var t=[];e.forEach(function(e){t.push(e.id)}),1==t.length?this.SId=t[0]:this.SIds=t.join(",")},upload:function(e){if(e&&(this.SId=e),!this.SIds&&!this.SId)return this.$message.warning({message:this.$t("请至少选择一条数据!")}),!1;this.dialog.flag=!0,this.dialog.name="upload",this.dialog.selectId=this.SIds||this.SId,this.dialog.vehicleId=this.vehicleId},mediaType:function(e){return this.$filter.mediaType(e.mediaType)},confirm:function(){this.gridLLoad(),this.gridRLoad()},handlerVehicleMonitor:function(e){this.single(e)}},watch:{"dialog.flag":function(e){e&&(this.SId=null,this.SIds=null)}},beforeDestroy:function(){this.$instruction({}).close()}},l=(i("9307"),Object(o.a)(a,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mediaSingleUpload"},[i("cv-operation",[i("el-form-item",[i("cv-tool",{attrs:{name:e.$route.name,data:e.$store.getters.monitorMenu,"is-add":!1,"is-modify":!1,"is-remove":!1,"is-export":!1,"is-search":!1,"is-upload":!0},on:{upload:e.upload}})],1)],1),i("cv-publictree-content",{attrs:{model:"single","vehicle-monitor":e.handlerVehicleMonitor}},[i("div",{staticClass:"contentL"},[i("el-alert",{staticStyle:{"border-radius":"0"},attrs:{title:"已上传信息"+e.vehicle,type:"info",closable:!1}}),i("cv-grid",{ref:"gridl",attrs:{url:"/mediaUpload/findMediaSelectBackList",params:e.gridL}},[i("el-table-column",{attrs:{label:e.$t("mediaSingleUpload.mediaType"),width:"80",prop:"mediaType",formatter:e.mediaType}}),i("el-table-column",{attrs:{label:e.$t("mediaSingleUpload.channelId"),width:"80",prop:"channel"}}),i("el-table-column",{attrs:{label:e.$t("mediaSingleUpload.gpsTime"),prop:"gpsDate"}})],1)],1),i("div",{staticClass:"contentR"},[i("el-alert",{staticStyle:{"border-radius":"0"},attrs:{title:"选择需要上传的媒体数据"+e.vehicle,type:"info",closable:!1}}),i("cv-grid",{ref:"gridr",attrs:{url:"/mediaUpload/findMediaSelectBackList",params:e.gridR},on:{"selection-change":e.selectIDs}},[i("el-table-column",{attrs:{type:"selection",width:"45"}}),i("el-table-column",{attrs:{label:e.$t("mediaSingleUpload.mediaType"),width:"80",prop:"mediaType",formatter:e.mediaType}}),i("el-table-column",{attrs:{label:e.$t("mediaSingleUpload.channelId"),width:"80",prop:"channel"}}),i("el-table-column",{attrs:{label:e.$t("mediaSingleUpload.gpsTime"),prop:"gpsDate"}}),i("el-table-column",{attrs:{label:e.$t("action.operation")},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){return e.upload(t.row.id)}}},[e._v("上传")])]}}])})],1)],1)]),i("el-dialog",{attrs:{"close-on-click-modal":!1,visible:e.dialog.flag,title:e.dialog.title,"custom-class":e.dialog.size},on:{"update:visible":function(t){return e.$set(e.dialog,"flag",t)}}},[i(e.dialog.name,{tag:"component",attrs:{options:e.dialog},on:{confirm:e.confirm}})],1)],1)},[],!1,null,null,null).exports);t.default=l}}]);