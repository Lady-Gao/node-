(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7753e65a"],{"04f8":function(e,t,n){"use strict";var a=n("cebc"),r=n("2f62"),i={mixins:[n("9add").a],props:{isCheck:{type:Boolean,default:function(){return!0}}},data:function(){return{peopletree:[],selection:[{label:"人员名称",value:"name"}],limit:200}},mounted:function(){this.treeInitialFinish()},methods:Object(a.a)({},Object(r.b)(["queryDustmanListInfoTree"]),{treeInitialFinish:function(){var e=this;this.queryDustmanListInfoTree().then(function(t){var n=t.data;e.peopletree=n})},handlerCheck:function(e){this.$emit("node-click",e)},handlerListsClick:function(e){3==e.type&&this.$emit("node-click",e)},iconsFilter:function(e){switch(e.manType){case"0":case"1":case"2":e.iconSkin="workerMan";break;case"4":case"5":case"6":e.iconSkin="inspectorMan"}},handlerLimitCheck:function(e){if(e.sumCount>this.limit)return this.$message.warning("该公司或车组下车辆超过".concat(this.limit,"辆车，不能一次性勾选!")),!1}})},s=(n("ff7e"),n("2877")),o=Object(s.a)(i,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("cv-tabs",{staticClass:"cv-tabs-tree",attrs:{titles:["人员选择","人员列表"],isScrollbar:"",type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("cv-tree-search",{ref:"tree",attrs:{data:e.peopletree,lazy:"","is-check":e.isCheck,"node-filter":["type","3"],"limit-check":e.handlerLimitCheck},on:{"node-click":e.handlerListsClick}}),n("cv-tree-lists",{ref:"lists",attrs:{"search-api":"/manLocation/queryTdustmanInfoList","is-check":e.isCheck,params:{key:"types",result:"0,1,2,3,4,5"},selection:e.selection},on:{"node-click":e.handlerListsClick},scopedSlots:e._u([{key:"label",fn:function(t){return[n("cv-icon",{attrs:{name:"4"==t.row.manType||"5"==t.row.manType?"yunwei1":"renyuan"}}),n("span",[e._v(e._s(t.row.text))])]}}])},[n("template",{slot:"checkbox"},[n("el-checkbox",{attrs:{label:"0,1,2"}},[e._v("清洁工")]),n("el-checkbox",{attrs:{label:"4,5"}},[e._v("管理员")])],1)],2)],1)},[],!1,null,null,null);t.a=o.exports},"21f9":function(e,t,n){},2659:function(e,t,n){},"56e1":function(e,t,n){},"5ff7":function(e,t,n){"use strict";var a=n("56e1");n.n(a).a},8001:function(e,t,n){"use strict";n.r(t),n("c5f6"),n("ac6a"),n("7f7f");var a=n("cebc"),r=n("2f62"),i={components:{CvMaptool:function(){return n.e("chunk-451aee8a").then(n.bind(null,"e7c5"))}},props:{personList:[]},data:function(){return{personInfo:{line:[],enterpriseIds:[]},markers:[],allInfo:{}}},computed:Object(a.a)({},Object(r.c)(["mapName"]),{_mapMethods:function(){return this.$refs.personlareaMap.mapMethods}}),methods:Object(a.a)({},Object(r.b)(["queryAreaInfoByIds"]),{getPersonLine:function(e){switch(e.name){case"check":return this.getAddLineData(e.data);case"cancel":return this.removeLine(e.data)}},handlerClick:function(e){var t=e.manType,n=e.checked;t&&n&&this.marker_transferCenter(e)},marker_transferCenter:function(e){var t=e.id,n=e.text,a=[];this.allInfo[t]?(this.markers.forEach(function(e){t==e.id&&a.push(e)}),this.mapBaseEvent(a)):this.$message.warning("".concat(n,"暂无位置信息"))},getAddLineData:function(e){var t=this,n=[];e.forEach(function(e){n.push(e.id)}),this.queryAreaInfoByIds({ids:n.join(",")}).then(function(e){var n=e.flag,a=e.data,r=e.errorCode;n?(r&&t.$message.error("查询数据为空"),a&&0<a.length&&t.addLine(a)):t.$message.error(t.$t("error."+r))})},addLine:function(e){var t=this;e.forEach(function(e){if(0<e.detetailsDusts.length){var n=t.getColor(e.enterpriseId),a=t.getLine(e.detetailsDusts,n),r=t.getText(e.detetailsDusts,e.dustmanName);t.personInfo.line.push({uID:e.userId,linedata:e.id,enterpriseId:e.enterpriseId,line:a,text:r}),a.id=e.userId,t.allInfo[e.userId]=a,t.markers.push(a)}}),this.mapBaseEvent()},getText:function(e,t){var n=this._mapMethods.point({longitude:Number(e[0].longitude),latitude:Number(e[0].latitude)}),a=this._mapMethods.setText(n,t);return this._mapMethods.addOverlay(a),a},getLine:function(e,t){var n=[];return e.forEach(function(e){n.push({lng:e.longitude,lat:e.latitude})}),this._mapMethods.mapAddline(n,{strokeColor:t})},rand:function(e,t){return e+parseInt((t-e)*Math.random())},rgbaStr:function(){return"rgba("+this.rand(0,255)+","+this.rand(0,255)+","+this.rand(0,255)+","+this.rand(0,255)+")"},getColor:function(e){var t,n={id:"",color:""};return this.personInfo.enterpriseIds.forEach(function(n){e==n.id&&(t=n.color)}),void 0===t&&(n.id=e,t=n.color=this.rgbaStr(),this.personInfo.enterpriseIds.push(n)),t},removeLine:function(e){var t=this,n=this.personInfo.line;e.forEach(function(e){n.forEach(function(n,a){e.id==n.uID&&(t._mapMethods.removeOverlay(t.personInfo.line[a].line),t._mapMethods.removeOverlay(t.personInfo.line[a].text),delete t.markers[a],delete t.personInfo.line[a])})})},mapBaseEvent:function(e){var t=[],n=this.personInfo.line;0<n.length&&!e?n.forEach(function(e){t.push(e.line)}):t=e,0<t.length?this._mapMethods.getBestView(t):this._mapMethods.moveToCenter("上海市")}})},s=(n("a307"),n("2877")),o={components:{personMap:Object(s.a)(i,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{width:"100%",height:"100%"}},[n(e.mapName,{ref:"personlareaMap",tag:"component",staticStyle:{width:"100%",height:"100%"}}),n("cv-lazy-render",{attrs:{transition:"top"}},[n("cv-maptool",{staticClass:"multicar-monitor-tool",attrs:{"map-target":e.$refs.personlareaMap,layout:["tool","search","bestview","fullscreen"],markers:e.markers}})],1)],1)},[],!1,null,"272da5e0",null).exports,peopleTree:n("04f8").a},data:function(){return{personList:[],enable:!1,isLook:!1,treeActive:!1}},computed:{_mapFun:function(){return this.$refs.personMap}},methods:{mapBaseEvent:function(){this.isLook=!this.isLook,this._mapFun.mapBaseEvent()},handlerMonitor:function(e){0<e.data.length?this._mapFun.getPersonLine(e):this._mapFun.cleanOverLays()},handlerClick:function(e){this._mapFun.handlerClick(e)}}},c=(n("5ff7"),Object(s.a)(o,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"personnelarea"},[n("person-map",{ref:"personMap",staticClass:"personalmonitor-map",attrs:{personList:e.personList}}),n("people-tree",{class:[,"personalmonitor-tabs","multicar-monitor-tabs",e.treeActive?"monitor-tabs__active":""],attrs:{"node-monitor":e.handlerMonitor},on:{"node-click":e.handlerClick}})],1)},[],!1,null,"468697a5",null).exports);t.default=c},a307:function(e,t,n){"use strict";var a=n("2659");n.n(a).a},ff7e:function(e,t,n){"use strict";var a=n("21f9");n.n(a).a}}]);